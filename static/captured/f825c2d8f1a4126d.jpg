"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["24721"],{928367:function(e,t,r){r.d(t,{SamanthaInput:function(){return c}});var n=r(713738),a=r(812650),o=r.n(a),l=r(398025),s={"samantha-input":"samantha-input-WEupWx",samanthaInput:"samantha-input-WEupWx"},i=r(345660);let c=n.forwardRef(function(e,t){let{type:r="primary",size:n="medium",...a}=e;return(0,i.jsx)(l.default,{ref:t,...a,type:"primary",size:"default",className:o()(s["samantha-input"],s[r],s[n],a.className),children:e.children})})},222493:function(e,t,r){r.d(t,{SamanthaModal:function(){return w}});var n=r(474932),a=r(217957),o=r(812650),l=r.n(o),s=r(287419),i=r(954373),c=r(996776),u=r(713738);let d=e=>{let[t,r]=(0,u.useState)(!1);return{loading:t,handler:async t=>{var n,a;try{r(!0);let n=null===(a=e.onTrigger)||void 0===a?void 0:a.call(e,t);(null==n?void 0:n.then)&&await n}finally{r(!1)}null===(n=e.onFinish)||void 0===n||n.call(e)}}};var f=r(559425),p={modal:"modal-UCq7Jh",cancel:"cancel-SQesS_"},m=r(345660);let v=e=>{let{title:t,desc:r,icon:o,closable:u=!0,closeIcon:v,onCancel:y,onOk:_,okText:g,cancelText:h,hasCancel:x=!0,footerFill:S,cancelButtonProps:b,okButtonProps:N,confirmLoading:j,cancelLoading:w}=e,{loading:k,handler:C}=d({onTrigger:_}),{loading:E,handler:A}=d({onTrigger:y}),U=()=>u?(0,m.jsx)(s.default,{"data-testid":"modal_close","aria-label":"close",autoFocus:!1,onClick:A,type:"tertiary",icon:v||(0,m.jsx)(n.default,{className:"text-s-color-text-tertiary"}),theme:"borderless",size:"small",className:"hover:!rounded-s-radius-xxs hover:!bg-s-color-bg-trans"},"close-btn"):null,P={closeIcon:(0,m.jsx)(n.default,{className:"text-s-color-text-tertiary"}),bodyStyle:{color:"var(--s-color-text-secondary)",font:"var(--s-font-small)",padding:t?"20px 0":"8px 0 28px 0"},...t?{header:(()=>{let e=U();return(0,m.jsxs)("div",{"data-testid":"modal_title",children:[(0,m.jsxs)("div",{className:"flex",children:[o?(0,m.jsx)("div",{className:"mr-8 flex items-center",children:o}):null,(0,m.jsx)("div",{className:"grow text-s-color-text-secondary s-font-h3",children:t}),e]}),r?(0,m.jsx)("div",{className:"mt-4 text-s-color-text-secondary s-font-xs",children:r}):null]})})()}:{},footer:(0,m.jsx)(i.default,{componentName:"Modal",children:e=>(0,m.jsxs)("div",{className:l()({"footer-fill grid gap-12":S,"grid-cols-[1fr_1fr]":S&&x}),children:[x?(0,m.jsx)(f.SamanthaButton,{type:"tertiary",size:"medium",onClick:A,loading:(0,a.default)(w)?E:w,"aria-label":"cancel",...b,className:l()("!ml-0",p.cancel,null==b?void 0:b.className),children:h||e.cancel}):null,(0,m.jsx)(f.SamanthaButton,{type:"primary",size:"medium",onClick:C,loading:(0,a.default)(j)?k:j,"aria-label":"confirm",...N,children:g||e.confirm})]})})},R={...P,...e,...e.bodyStyle?{bodyStyle:Object.assign({},P.bodyStyle,e.bodyStyle)}:{}};return(0,m.jsx)(c.default,{...R,className:l()(p.modal,R.className)})},y=[],_=()=>{y=[]};var g=r(749848),h=r(253515),x=r(153228),S=r(610015),b=r(386827);let N=e=>{let[t,r]=(0,u.useState)(!0),{direction:n}=e,{title:a,content:o,icon:s,onCancel:i,onOk:c,className:f,...p}=e,{loading:y,handler:_}=d({onTrigger:c,onFinish:()=>r(!1)}),{loading:g,handler:h}=d({onTrigger:i,onFinish:()=>r(!1)}),x="semi-confirm",S=l()(f,x,{[`${x}-rtl`]:"rtl"===n}),b=null===a?null:(0,m.jsx)("span",{className:`${x}-title-text`,children:a}),N=l()(`${x}-content`,{[`${x}-content-withIcon`]:e.icon});return(0,m.jsx)(v,{confirmLoading:y,cancelLoading:g,className:S,title:b,onOk:_,onCancel:h,icon:s,visible:t,bodyStyle:{paddingTop:"8px",paddingBottom:"16px"},...p,children:(0,m.jsx)("div",{className:N,"x-semi-prop":"content",children:o})})};function j(e){let t=document.createElement("div");document.body.appendChild(t);let r={...e},n=()=>{b.unmountComponentAtNode(t)&&t.parentNode&&t.parentNode.removeChild(t);for(let e=0;e<y.length;e++)if(y[e]===o){y.splice(e,1);break}};function a(r){let{afterClose:a}=r;b.render((0,m.jsx)(N,{...r,afterClose:()=>{null==a||a(),n()},motion:e.motion}),t)}function o(){a(r={...r,visible:!1})}return a(r),y.push(o),{destroy:o,update:function(e){a(r={...r,...e})}}}let w=v;w.info=function(e){return j({type:"info",icon:(0,m.jsx)(S.default,{className:"!text-20 py-2 text-s-color-system-info"}),...e})},w.success=function(e){return j({type:"success",icon:(0,m.jsx)(x.default,{className:"!text-20 py-2 text-s-color-system-success"}),...e})},w.warning=function(e){return j(function(e){let{okButtonProps:t={},...r}=e;return{type:"warning",icon:(0,m.jsx)(h.default,{className:"!text-20 py-2 text-s-color-system-warning"}),okButtonProps:{type:"danger-primary",...t},...r}}(e))},w.error=function(e){return j(function(e){let{okButtonProps:t={},...r}=e;return{type:"error",icon:(0,m.jsx)(g.default,{className:"!text-20 py-2 text-s-color-system-alert"}),okButtonProps:{type:"danger-primary",...t},...r}}(e))},w.confirm=function(e){return j({type:"confirm",icon:(0,m.jsx)(S.default,{className:"!text-20 py-2 text-s-color-system-info"}),...e})},w.destroyAll=function(){for(let e=0,t=y.length;e<t;e++){let t=y[e];t&&t()}_()}},311530:function(e,t,r){r.d(t,{useStateWithGetter:function(){return o}});var n=r(713738),a=r(385093);let o=e=>{let t=(0,n.useRef)(e),[r,o]=(0,n.useState)(e);return[r,(0,n.useCallback)(e=>{t.current=(0,a.default)(e)?e(t.current):e,o(t.current)},[]),(0,n.useCallback)(()=>t.current,[])]}},72516:function(e,t,r){r.d(t,{genUserDefaultProfile:function(){return S},getProfileInfo:function(){return _},resetProfile:function(){return x},resetUserInfos:function(){return h},updateUserInfo:function(){return v},updateUserInfoLoaded:function(){return y},updateUserProfile:function(){return g}});var n=r(4137),a=r(910214),o=r(769783),l=r(177048),s=r(643404),i=r(47563),c=r(856392),u=r(178230),d=r(797840),f=r(369269),p=r(886941),m=r(193907);let v=e=>{var t;return((0,p.updateWorkspaceParams)({type:null!==(t=e.passport_enterprise_user_type)&&void 0!==t?t:m.PassportEnterpriseUserTypeEnum.Normal}),d.useFlowAccountStore.setState({userInfo:e,userInfoLoaded:!0}),null==e?void 0:e.user_id_str)?_(e.user_id_str):Promise.reject(Error("user_id_str is empty"))},y=()=>{d.useFlowAccountStore.setState({userInfoLoaded:!0})},_=async(e,t)=>{if(!e)return Promise.reject(Error("user_id_str is empty"));let r=(0,c.createReportEvent)({eventName:"get_profile_info",meta:{user_id:e}});try{let{data:t}=await a.profileApiService.ProfileInfo({visit_id:e});if(t){var n;return d.useFlowAccountStore.setState({userProfile:{...null==t?void 0:t.profile_brief,loaded:!0,botCount:Number(null==t?void 0:null===(n=t.profile_bot_info)||void 0===n?void 0:n.total)||0}}),r.success(),null==t?void 0:t.profile_brief}r.error({reason:"no data"})}catch(n){if((0,o.isApiError)(n)&&n.errorOption.code===l.ErrorCodes.USER_NOT_EXISTED.toString()){if(u.logger.persist.info({eventName:"gen_user_profile_for_user_stay_on_chat_page",meta:{user_id:e}}),t)throw Error("get profile only get");0!==await g({entity_id:e,avatar_url:"",nickname:"",user_name:""})&&(d.useFlowAccountStore.setState({userProfile:{loaded:!0}}),r.error({reason:"with update fail",error:n}))}else r.error({reason:"unhandle catch",error:n instanceof Error?n:Error(String(n))})}},g=async e=>{let t=(0,c.createReportEvent)({eventName:"update_user_profile",meta:{user_id:e.entity_id}});try{t.addDurationPoint("start");let{code:r,msg:n,data:o}=await a.profileApiService.UpdateProfile(e);if(0===r&&(null==o?void 0:o.entity_id))return t.addDurationPoint("success"),t.success(),await _(null==o?void 0:o.entity_id),0;return n&&i.SamanthaToast.error(n),0===r?-1001:Number(r)}catch(r){if(t.error({reason:"update_user_profile_failed",error:r instanceof Error?r:Error(String(r))}),(0,o.isApiError)(r)&&(e.nickname||!e.entity_id))return r.errorOption.message&&i.SamanthaToast.error(r.errorOption.message),(0,n.default)(r.errorOption.code)?-1002:parseInt(r.errorOption.code,10);try{let r=await (0,s.retryAsync)(()=>_(e.entity_id,!0),3,e=>800*e,(e,r)=>{t.updateMeta({retry:r,[`retry${r}`]:e})});if(null==r?void 0:r.entity_id)return t.updateMeta({retrySuccess:1}),0;throw Error("retry not entity_id")}catch(e){t.updateMeta({retrySuccess:0,retryFail:e})}return -1003}},h=()=>{d.useFlowAccountStore.setState({userInfo:f.defaultFlowAccountStore.userInfo,userProfile:f.defaultFlowAccountStore.userProfile})},x=()=>{d.useFlowAccountStore.setState({userProfile:f.defaultFlowAccountStore.userProfile})},S=async e=>{try{var t,r;let n=await Promise.all([a.profileApiService.UpdateProfile({entity_id:e,avatar_url:"",nickname:"",user_name:""}),a.profileApiService.UserHitProfileRegister()]);return(null==n?void 0:null===(r=n[1])||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.profile_enable)||!1}catch(e){return u.logger.persist.error({eventName:"gen_user_default_profile_error",message:"[genUserDefaultProfile] genUserDefaultProfile failed",error:e instanceof Error?e:Error(String(e))}),!1}}},125417:function(e,t,r){r.d(t,{CodeInputPanel:function(){return w}});var n,a=r(713738),o=r(812650),l=r.n(o),s=r(915299),i=r(761515);let c=(e,t)=>{let r=(0,a.useRef)(),[n,o]=(0,a.useState)(0),[l,s]=(0,a.useState)(!1),c=()=>{r.current&&(clearInterval(r.current),r.current=void 0),s(!1)};return(0,i.default)(()=>{l&&n<=0&&(c(),null==t||t())},[n,t,l]),{count:n,start:()=>{r.current&&clearInterval(r.current),s(!0),o(e),r.current=window.setInterval(()=>{o(e=>Math.max(e-1,0))},1e3)},stop:c}};var u=r(345660);let d=e=>(0,u.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:14,height:15,fill:"none",viewBox:"0 0 14 15",...e,children:[(0,u.jsx)("g",{clipPath:"url(#blue-loading_svg__a)",children:(0,u.jsx)("path",{stroke:"url(#blue-loading_svg__b)",strokeLinecap:"round",strokeWidth:1.778,d:"M13.222 7.5A6.222 6.222 0 0 0 1.396 4.792"})}),(0,u.jsxs)("defs",{children:[(0,u.jsxs)("linearGradient",{id:"blue-loading_svg__b",x1:1.396,x2:13.222,y1:7.5,y2:7.5,gradientUnits:"userSpaceOnUse",children:[(0,u.jsx)("stop",{stopColor:"#0064FA",stopOpacity:0}),(0,u.jsx)("stop",{offset:.399,stopColor:"#0064FA",stopOpacity:.5}),(0,u.jsx)("stop",{offset:1,stopColor:"#0064FA"})]}),(0,u.jsx)("clipPath",{id:"blue-loading_svg__a",children:(0,u.jsx)("path",{fill:"#fff",d:"M0 .5h14v14H0z"})})]})]});var f=r(14390),p=r(311530),m=r(828617),v=r(147899),y=r(398025),_=r(178230);let g=()=>(0,u.jsx)("div",{className:"container-jzDspG"});var h={container:"container-t8Wk8M",inputting:"inputting-zSRaAO",disabled:"disabled-YQ_B5g",text:"text-tSQq4A",error:"error-mOJ0jP"};let x=e=>{let{className:t,style:r,value:n,inputting:a=!1,disabled:o=!1,error:s=!1,onClick:i}=e;return(0,u.jsx)("div",{className:l()(h.container,t,{[h.inputting]:!o&&a,[h.error]:s,[h.disabled]:o}),style:r,onClick:i,children:n?(0,u.jsx)("span",{className:h.text,children:n}):a&&!o&&(0,u.jsx)(g,{})})},S=e=>!isNaN(parseInt(e)),b=e=>{let{length:t=6,value:r="",disabled:n=!1,error:o=!1,onChange:s,onFinish:i,className:c,style:d,inputClassName:g}=e,[h,b,N]=(0,p.useStateWithGetter)(r.slice(0,t)),j=(0,a.useRef)(null),w=(0,m.useLatestFunction)(()=>{var e;null===(e=j.current)||void 0===e||e.blur()}),k=(0,m.useLatestFunction)(()=>{var e;null===(e=j.current)||void 0===e||e.focus()}),C=(0,m.useLatestFunction)(()=>!!(document.activeElement&&document.activeElement===j.current));(0,v.default)("keydown",e=>{let{key:r}=e;_.logger.persist.info({eventName:"code_input_global_key_down",meta:{val:h,key:r}}),!C()&&(S(r)||"Backspace"===r)&&h.length<t&&(_.logger.persist.info({eventName:"code_input_global_key_down_and_focus",meta:{val:h,key:r}}),k())}),(0,a.useEffect)(()=>{k()},[]),(0,a.useEffect)(()=>{_.logger.persist.info({eventName:"code_input_innervalue_effect",meta:{val:h}}),null==s||s(h),h.length>=t&&(null==i||i(h.slice(0,t)),w())},[h,t]),(0,a.useEffect)(()=>{_.logger.persist.info({eventName:"code_input_value_effect",meta:{all_val:r,val:r.slice(0,t)}}),b(r.slice(0,t))},[r]);let E=()=>{var e,r;h.length!==t&&(null===(e=j.current)||void 0===e||e.blur(),null===(r=j.current)||void 0===r||r.focus())};return(0,u.jsxs)("div",{className:l()("container-u9_Ag1","code-input",c),style:d,"data-testid":"code_input",children:[(0,f.default)(0,t).map(e=>(0,u.jsx)(x,{className:l()("item-L1XVRG","char-input",g),value:N()[e],disabled:n,error:o,inputting:e===h.length,onClick:E},e)),(0,u.jsx)(y.default,{className:"input-D3qOXd",ref:j,inputMode:"decimal",value:h,disabled:n,onChange:e=>{if(_.logger.persist.info({eventName:"code_input_onchange",meta:{val:e}}),e&&!S(e)){_.logger.persist.info({eventName:"code_input_onchange_break",meta:{val:e,new_value:e,reason:"not_number_v1"}});return}b(e.toLocaleUpperCase())}})]})};var N={"code-input-panel":"code-input-panel-xIvbo4",desc:"desc-ysWbww",blue:"blue-iCE_u1","nearly-black":"nearly-black-jmZrBp",link:"link-Uu18xD",disabled:"disabled-K24j8p","vertical-align-center":"vertical-align-center-twKMmr",icon:"icon-hBdLZT",rotate:"rotate-z6vHXV"},j=((n=j||{}).WaitToRetry="wait_to_retry",n.CanRetry="can_retry",n.VerifyFinished="verify_finished",n);let w=e=>{let{retryTime:t,length:r,onFinish:n,onResend:o,autoSend:i=!1,className:f,style:p,inputClassName:m}=e,[v,y]=(0,a.useState)(),[_,g]=(0,a.useState)(!1),[h,x]=(0,a.useState)(!1),[S,w]=(0,a.useState)(!1),[k,C]=(0,a.useState)(i),[E,A]=(0,a.useState)(i?j.CanRetry:j.WaitToRetry),{count:U,start:P}=c(t,()=>{E===j.WaitToRetry&&A(j.CanRetry)}),R=async e=>{if(e){g(!1);try{x(!0),await n(e),A(j.VerifyFinished)}catch(e){y(void 0),g(!0)}finally{x(!1)}}},F=async()=>{if(E===j.CanRetry){w(!0);try{await o(),A(j.WaitToRetry)}catch(e){A(j.CanRetry)}finally{w(!1),C(!1)}}},W=(0,a.useRef)(t);(0,a.useEffect)(()=>{W.current=t},[t]),(0,a.useEffect)(()=>{E===j.WaitToRetry&&P(W.current)},[E,W]),(0,a.useEffect)(()=>{v&&g(!1)},[v]),(0,a.useEffect)(()=>{i&&F()},[i]);let I=h?(0,u.jsx)("div",{className:l()(N.desc,N["nearly-black"]),children:(0,s.getUnreactiveTranslate)("delete_account_verifying","Verifying")}):(0,u.jsxs)(u.Fragment,{children:[E===j.WaitToRetry?(0,u.jsx)("div",{className:N.desc,children:(0,s.getUnreactiveTranslate)("resend_code_countdown","Resend Code %ds").replace("%d",String(U))}):null,E===j.CanRetry?(0,u.jsxs)("div",{className:l()(N.desc,N.blue,S?N.disabled:N.link,N["vertical-align-center"]),onClick:F,children:[S?(0,u.jsx)(d,{className:l()(N.icon,N.rotate)}):null,(0,s.getUnreactiveTranslate)("resend_code","Resend Code")]}):null]});return(0,u.jsxs)("div",{className:l()(f,N["code-input-panel"]),style:p,children:[(0,u.jsx)(b,{length:r,value:v,onChange:y,onFinish:R,disabled:h,error:_,inputClassName:m}),k?null:I]})}},358033:function(e,t,r){var n,a;r.d(t,{WorkspaceUserRole:function(){return o},WorkspaceUserStatus:function(){return l}});let o=((n={})[n.Contributor=0]="Contributor",n[n.Administrator=1]="Administrator",n[n.Owner=2]="Owner",n),l=((a={})[a.WorkspaceUserStatusDefault=0]="WorkspaceUserStatusDefault",a[a.WorkspaceUserStatusNormal=1]="WorkspaceUserStatusNormal",a[a.WorkspaceUserStatusBanned=2]="WorkspaceUserStatusBanned",a)}}]);