"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["58414"],{307803:function(e,t,s){s.d(t,{default:function(){return T}});var i=s(229079),r=s(385093),l=s(913821),o=s(713738),n=s(812650),a=s.n(n),c=s(526675),h=s(362269),d=s.n(h);let u={PREFIX:s(35834).BASE_CLASS_PREFIX+"-overflow-list"},p={COLLAPSE:"collapse",SCROLL:"scroll"},f={START:"start",END:"end"},m={BOUNDARY_SET:Object.values(f),POSITION_SET:["vertical","horizontal"],MODE_SET:Object.values(p),MODE_MAP:p,BOUNDARY_MAP:f,OVERFLOW_DIR:{NONE:0,GROW:1,SHRINK:2}},v={MINIMUM_HTML_ELEMENT_WIDTH:4};var S=s(615853),O=s(214071),g=s(448517);class b extends o.PureComponent{componentDidMount(){let{items:e}=this.props;this.cachedKeys=Object.keys(e);let{root:t,threshold:s,rootMargin:i,option:r,onIntersect:l}=this.props;this.observer=new IntersectionObserver(l,Object.assign({root:t,threshold:s,rootMargin:i},r)),this.observeElement()}componentDidUpdate(){let{items:e}=this.props,t=Object.keys(e);(0,l.default)(this.cachedKeys,t)||(this.observeElement(!0),this.cachedKeys=t)}componentWillUnmount(){this.observer&&(this.observer.disconnect(),this.observer=null)}observeElement(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{items:t}=this.props;if((0,O.default)(t)){this.observer.disconnect();return}e&&this.observer.disconnect(),Object.keys(t).forEach(e=>{let s=t[e];s&&(0,g.default)(s)&&this.observer.observe(s)})}render(){let{children:e}=this.props;return e}}b.propTypes={onIntersect:d().func,option:d().object,root:d().any,threshold:d().number,rootMargin:d().string,items:d().object},b.defaultProps={onIntersect:()=>void 0,threshold:.75,rootMargin:"0px",option:{},items:{}};var E=s(135410),M=s(166106);let I=m.BOUNDARY_MAP;m.OVERFLOW_DIR;class _ extends E.default{constructor(e){super(Object.assign({},e)),this.previousY=void 0,this.isScrollMode=()=>{let{renderMode:e}=this.getProps();return"scroll"===e},this.getReversedItems=()=>{let{items:e}=this.getProps();return(0,M.default)(e).reverse()}}getOverflowItem(){let{items:e}=this.getProps(),{visibleState:t,overflow:s}=this.getStates();if(!this.isScrollMode())return s;let i=e.map(e=>{let{key:s}=e;return!!t.get(s)}),r=i.indexOf(!0),l=i.lastIndexOf(!0),o=[];return o[0]=r>=0?e.slice(0,r):[],o[1]=l>=0?e.slice(l+1,e.length):e,o}handleIntersect(e){let t=(0,M.default)(this.getState("visibleState")),s={};e.forEach(e=>{let r=(0,i.default)(e,"target.dataset.scrollkey"),l=e.isIntersecting;s[r]=e,t.set(r,l)});let r=!1;for(let e of t.values())if(e){r=!0;break}let l=r,[o]=e,n=o.boundingClientRect.y;if(!l&&void 0!==this.previousY&&n!==this.previousY){this.previousY=n;return}this.previousY=n,this._adapter.updateVisibleState(t),this._adapter.notifyIntersect(s)}handleCollapseOverflow(){let{minVisibleItems:e,collapseFrom:t}=this.getProps(),{overflowWidth:s,containerWidth:i,pivot:r,overflowStatus:l}=this.getStates(),{items:o,onOverflow:n}=this.getProps(),a=s,c=0,h=!1;for(let e of this._adapter.getItemSizeMap().values()){if((a+=e)>i){h=!0;break}if(c===o.length-1){this._adapter.updateStates({overflowStatus:"normal",pivot:o.length-1,visible:o,overflow:[]});break}c++}if(h){let s=Math.max(e,c),i=t===I.START,l=i?this.getReversedItems().slice(0,s).reverse():o.slice(0,s),a=i?this.getReversedItems().slice(s).reverse():o.slice(s);this._adapter.updateStates({overflowStatus:"overflowed",pivot:s,visible:l,overflow:a}),r!==s&&n(a);return}}}var R=s(544740);let w=u.PREFIX,y=m.BOUNDARY_MAP,L=m.OVERFLOW_DIR,D=m.MODE_MAP;class N extends c.default{constructor(e){var t;super(e),t=this,this.scroller=null,this.spacer=null,this.isScrollMode=()=>{let{renderMode:e}=this.props;return e===D.SCROLL},this.resize=function(){var e;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=null===(e=s[0])||void 0===e?void 0:e.target.clientWidth;t.setState({containerWidth:i,overflowStatus:"calculating"})},this.reintersect=e=>{this.foundation.handleIntersect(e)},this.mergeRef=(e,t,s)=>{this.itemRefs[s]=t,"function"==typeof e?e(t):"object"==typeof e&&e&&"current"in e&&(e.current=t)},this.renderOverflow=()=>{let e=this.foundation.getOverflowItem();return this.props.overflowRenderer(e)},this.getItemKey=(e,t)=>{let{itemKey:s}=this.props;return(0,r.default)(s)?s(e):(0,i.default)(e,s||"key",t)},this.renderItemList=()=>{let{className:e,wrapperClassName:t,wrapperStyle:s,style:i,visibleItemRenderer:r,renderMode:l,collapseFrom:n}=this.props,{visible:c,overflowStatus:h}=this.state,d=this.renderOverflow();if(!this.isScrollMode()&&(Array.isArray(d)&&(d=o.createElement(o.Fragment,null,d)),o.isValidElement(d))){let e=o.cloneElement(d);d=o.createElement(S.default,{onResize:e=>{let[t]=e;this.setState({overflowWidth:t.target.clientWidth,overflowStatus:"calculating"})}},o.createElement("div",{className:`${w}-overflow`},e))}let u=l===D.SCROLL?[d[0],o.createElement("div",{className:a()(t,`${w}-scroll-wrapper`),ref:e=>{this.scroller=e},style:Object.assign({},s),key:`${w}-scroll-wrapper`},c.map(r).map(e=>{let{forwardRef:t,key:s}=e;return o.cloneElement(e,{ref:e=>this.mergeRef(t,e,s),"data-scrollkey":`${s}`,key:s})})),d[1]]:[n===y.START?d:null,c.map((e,t)=>{let{key:s}=e,i=r(e,t),l=o.cloneElement(i);return o.createElement(S.default,{key:null!=s?s:t,onResize:s=>{let[i]=s;return this.onItemResize(i,e,t)}},o.createElement("div",{key:null!=s?s:t,className:`${w}-item`},l))}),n===y.END?d:null];return o.createElement("div",{className:a()(`${w}`,e),style:Object.assign(Object.assign({},i),l===D.COLLAPSE?{maxWidth:"100%",visibility:"calculating"===h?"hidden":"visible"}:null)},...u)},this.onItemResize=(e,t,s)=>{let i=this.getItemKey(t,s),r=this.itemSizeMap.get(i);r?r!==e.target.clientWidth&&(this.itemSizeMap.set(i,e.target.clientWidth),this.setState({overflowStatus:"calculating"})):this.itemSizeMap.set(i,e.target.clientWidth);let{maxCount:l}=this.state;this.itemSizeMap.size===l&&this.setState({overflowStatus:"calculating"})},this.state={direction:L.GROW,lastOverflowCount:0,overflow:[],visible:[],containerWidth:0,visibleState:new Map,itemSizeMap:new Map,overflowStatus:"calculating",pivot:-1,overflowWidth:0,maxCount:0},this.foundation=new _(this.adapter),this.previousWidths=new Map,this.itemRefs={},this.itemSizeMap=new Map}static getDerivedStateFromProps(e,t){let{prevProps:s}=t,i={};i.prevProps=e;let r=t=>!s&&t in e||s&&!(0,l.default)(s[t],e[t]);if(r("items")||r("style")){if(i.direction=L.GROW,i.lastOverflowCount=0,i.maxCount=0,e.renderMode===D.SCROLL)i.visible=e.items,i.overflow=[];else{let s=e.items.length;0!==Math.floor(t.containerWidth/v.MINIMUM_HTML_ELEMENT_WIDTH)&&(s=Math.min(s,Math.floor(t.containerWidth/v.MINIMUM_HTML_ELEMENT_WIDTH)));let r=e.collapseFrom===y.START,l=r?(0,R.cloneDeep)(e.items).reverse().slice(0,s):e.items.slice(0,s),o=r?(0,R.cloneDeep)(e.items).reverse().slice(s):e.items.slice(s);i.visible=l,i.overflow=o,i.maxCount=s}i.pivot=-1,i.overflowStatus="calculating"}return i}get adapter(){return Object.assign(Object.assign({},super.adapter),{updateVisibleState:e=>{this.setState({visibleState:e})},updateStates:e=>{this.setState(Object.assign({},e))},notifyIntersect:e=>{this.props.onIntersect&&this.props.onIntersect(e)},getItemSizeMap:()=>this.itemSizeMap})}componentDidUpdate(e,t){let s=e.items.map(e=>e.key),i=this.props.items.map(e=>e.key);(0,l.default)(s,i)||(this.itemRefs={},this.setState({visibleState:new Map}));let{overflow:r,containerWidth:o,visible:n,overflowStatus:a}=this.state;!this.isScrollMode()&&"calculating"===a&&this.foundation.handleCollapseOverflow()}render(){let e=this.renderItemList(),{renderMode:t}=this.props;return t===D.SCROLL?o.createElement(b,{onIntersect:this.reintersect,root:this.scroller,threshold:this.props.threshold,items:this.itemRefs},e):o.createElement(S.default,{onResize:this.resize},e)}}N.__SemiComponentName__="OverflowList",N.defaultProps=(0,R.getDefaultPropsFromGlobalConfig)(N.__SemiComponentName__,{collapseFrom:"end",minVisibleItems:0,overflowRenderer:()=>null,renderMode:"collapse",threshold:.75,visibleItemRenderer:()=>null,onOverflow:()=>null}),N.propTypes={className:d().string,collapseFrom:d().oneOf(m.BOUNDARY_SET),direction:d().oneOf(m.POSITION_SET),items:d().array,minVisibleItems:d().number,onIntersect:d().func,onOverflow:d().func,overflowRenderer:d().func,renderMode:d().oneOf(m.MODE_SET),style:d().object,threshold:d().number,visibleItemRenderer:d().func,wrapperClassName:d().string,wrapperStyle:d().object};var T=N},14390:function(e,t,s){s.d(t,{default:function(){return a}});var i=Math.ceil,r=Math.max,l=function(e,t,s,l){for(var o=-1,n=r(i((t-e)/(s||1)),0),a=Array(n);n--;)a[l?n:++o]=e,e+=s;return a},o=s(14993),n=s(38009),a=function(e,t,s){return s&&"number"!=typeof s&&(0,o.default)(e,t,s)&&(t=s=void 0),e=(0,n.default)(e),void 0===t?(t=e,e=0):t=(0,n.default)(t),s=void 0===s?e<t?1:-1:(0,n.default)(s),l(e,t,s,void 0)}}}]);