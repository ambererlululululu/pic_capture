"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["1779"],{74798:function(e,t){t.Z={"samantha-tooltip":"samantha-tooltip-pqo8bm",samanthaTooltip:"samantha-tooltip-pqo8bm"}},471549:function(e,t,r){r.d(t,{Z:function(){return a}}),r(429996);var n=r(339512),i=r(627394),a=(0,n.G)((0,i.jsx)(e=>(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor",viewBox:"0 0 28 28",...e,children:(0,i.jsx)("path",{d:"M14.007 28q-2.881 0-5.418-1.11a14.3 14.3 0 0 1-4.453-3.026 14.5 14.5 0 0 1-3.04-4.453Q0 16.875 0 13.993q0-2.868 1.095-5.404Q2.191 6.053 4.121 4.12A14.5 14.5 0 0 1 8.59 1.095Q11.124 0 13.993 0t5.404 1.095q2.536 1.096 4.467 3.026A14.2 14.2 0 0 1 26.89 8.59Q28 11.124 28 13.993q0 2.881-1.095 5.418a14.3 14.3 0 0 1-3.027 4.453 14.2 14.2 0 0 1-4.467 3.026Q16.876 28 14.007 28m.015-6.917q.518 0 .835-.317.332-.332.332-.836v-6.816l-.13-2.969 1.37 1.672 1.599 1.643q.316.33.807.331.475 0 .792-.303a.99.99 0 0 0 .332-.763q0-.475-.332-.807L14.944 7.22q-.433-.447-.922-.447-.476 0-.908.447L8.43 11.918q-.317.317-.317.807 0 .461.317.763.318.303.778.303.49 0 .807-.331l1.629-1.658 1.326-1.642-.116 2.954v6.816q0 .504.332.836.331.317.836.317"})}),{}))},966015:function(e,t,r){r.d(t,{s:function(){return c}});var n=r(429996),i=r(669160),a=r.n(i),o=r(387834),l=r(74798),s=r(627394);let u=()=>(0,s.jsx)("svg",{width:"6",height:"16",viewBox:"0 0 6 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"semi-tooltip-icon-arrow",children:(0,s.jsx)("path",{d:"M1.99309 11.5617L5.15916 8.74741C5.60668 8.34962 5.60668 7.65038 5.15916 7.25259L1.99309 4.4383C0.725344 3.31142 -6.25239e-07 1.69619 -6.99382e-07 0L-3.49691e-07 8L0 16C-7.41428e-08 14.3038 0.725345 12.6886 1.99309 11.5617Z",fill:"currentColor"})}),d=()=>(0,s.jsx)("svg",{width:"17",height:"6",viewBox:"0 0 17 6",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"semi-tooltip-icon-arrow",children:(0,s.jsx)("path",{d:"M4.9383 1.99309L7.75259 5.15916C8.15038 5.60668 8.84962 5.60668 9.24741 5.15916L12.0617 1.99309C13.1886 0.725344 14.8038 0 16.5 0L8.5 0L0.5 0C2.19619 0 3.81142 0.725345 4.9383 1.99309Z",fill:"currentColor"})}),c=n.forwardRef(function(e,t){let{position:r="top",showArrow:n=!0}=e;return(0,s.jsx)(o.Z,{ref:t,...e,className:a()(l.Z["samantha-tooltip"],e.className),showArrow:!!n&&(r.includes("left")||r.includes("right")?(0,s.jsx)(u,{}):(0,s.jsx)(d,{})),children:e.children})})},350538:function(e,t,r){r.d(t,{IC:function(){return i},N6:function(){return o},dM:function(){return l},vd:function(){return a}});var n=r(913602);let i="flow_web_has_login",a=()=>{n.yQ.setItem(i,"true")},o=()=>{n.yQ.removeItem(i)},l=()=>"true"===n.yQ.getItem(i)},847758:function(e,t,r){var n,i,a,o,l;r.r(t),r.d(t,{ArtifactMetaStatus:function(){return s},ArtifactResourceType:function(){return u},ArtifactSourceType:function(){return d},ArtifactStatus:function(){return c},ArtifactType:function(){return p}});let s=((n={})[n.Undefined=0]="Undefined",n[n.Normal=1]="Normal",n[n.Deleted=2]="Deleted",n),u=((i={})[i.WriteDoc=1]="WriteDoc",i[i.Pages=2]="Pages",i[i.CanvasPage=3]="CanvasPage",i[i.StepWritingPage=4]="StepWritingPage",i[i.Code=5]="Code",i[i.StepWritingOtterPage=6]="StepWritingOtterPage",i),d=((a={})[a.Conversation=1]="Conversation",a[a.MobileMainConversation=2]="MobileMainConversation",a),c=((o={})[o.Init=0]="Init",o[o.Generating=1]="Generating",o[o.Generated=2]="Generated",o[o.Deleted=3]="Deleted",o[o.Terminal=4]="Terminal",o),p=((l={})[l.Page=1]="Page",l)},182663:function(e,t,r){var n,i,a,o,l,s;r.d(t,{$q:function(){return c},Hb:function(){return u},Hs:function(){return p},VP:function(){return d},X1:function(){return f},_g:function(){return v}});let u=((n={})[n.StatusDefault=0]="StatusDefault",n[n.StatusCompiling=1]="StatusCompiling",n[n.StatusFail=2]="StatusFail",n[n.StatusSuccess=3]="StatusSuccess",n),d=((i={})[i.Init=0]="Init",i[i.Access=1]="Access",i[i.Reject=2]="Reject",i),c=((a={})[a.MultiFileContext=1]="MultiFileContext",a[a.DirectoryContext=2]="DirectoryContext",a[a.Artifacts=3]="Artifacts",a[a.SingleFileContext=4]="SingleFileContext",a),p=((o={})[o.CodeTypeArtifacts=1]="CodeTypeArtifacts",o[o.CodeTypeRaw=2]="CodeTypeRaw",o),f=((l={})[l.Default=0]="Default",l[l.CodeBlock=1]="CodeBlock",l[l.DevelopMode=2]="DevelopMode",l),v=((s={})[s.Repository=1]="Repository",s[s.File=2]="File",s[s.Directory=3]="Directory",s)},57005:function(e,t,r){var n,i,a,o,l,s,u,d,c,p,f,v,m;r.d(t,{$Q:function(){return S},Be:function(){return y},Dh:function(){return I},Jq:function(){return P},Lq:function(){return w},Nz:function(){return C},Pu:function(){return g},Re:function(){return A},Th:function(){return b},ce:function(){return h},cj:function(){return _},e$:function(){return E},p1:function(){return k}});let h=((n={})[n.Processing=0]="Processing",n[n.Enable=1]="Enable",n[n.Disable=2]="Disable",n[n.Init=3]="Init",n),g=((i={})[i.from_upload=0]="from_upload",i[i.from_share=1]="from_share",i[i.from_conversation=2]="from_conversation",i),y=((a={})[a.all=0]="all",a[a.doc=1]="doc",a[a.image=2]="image",a[a.media=3]="media",a[a.chart=4]="chart",a[a.ppt=5]="ppt",a[a.code_project=6]="code_project",a[a.meeting_minutes=7]="meeting_minutes",a[a.archive=8]="archive",a[a.others=100]="others",a),_=((o={})[o.Default=0]="Default",o[o.Desc=1]="Desc",o[o.Asc=2]="Asc",o),S=((l={})[l.Default=0]="Default",l[l.LastUsedTime=1]="LastUsedTime",l[l.Name=2]="Name",l[l.CreateTime=3]="CreateTime",l[l.Size=4]="Size",l[l.Source=5]="Source",l[l.FileType=6]="FileType",l[l.UpdateTime=7]="UpdateTime",l),b=((s={})[s.Default=0]="Default",s[s.Documents=1]="Documents",s[s.ConversationFiles=2]="ConversationFiles",s[s.MeetingMinutes=3]="MeetingMinutes",s[s.CodeArtifact=4]="CodeArtifact",s[s.Creation=5]="Creation",s),k=((u={})[u.AI=1]="AI",u),w=((d={})[d.Default=0]="Default",d[d.CodeIndependentSite=1]="CodeIndependentSite",d),C=((c={})[c.Default=0]="Default",c[c.Otter=1]="Otter",c),E=((p={})[p.Init=0]="Init",p[p.Pass=1]="Pass",p[p.Reject=2]="Reject",p[p.Processing=3]="Processing",p[p.Failed=51]="Failed",p),A=((f={})[f.AICreate=1]="AICreate",f[f.FromConversation=2]="FromConversation",f[f.FromUpload=3]="FromUpload",f[f.FromShare=4]="FromShare",f),P=((v={})[v.UnKnown=0]="UnKnown",v[v.Directory=1]="Directory",v[v.File=2]="File",v[v.Link=3]="Link",v[v.Image=4]="Image",v[v.Pages=5]="Pages",v[v.Video=6]="Video",v[v.Audio=7]="Audio",v[v.MeetingMinutes=8]="MeetingMinutes",v[v.CodeArtifact=9]="CodeArtifact",v[v.CodeProject=10]="CodeProject",v),I=((m={})[m.Unknown=0]="Unknown",m[m.Available=1]="Available",m[m.NoEncodedStream=2]="NoEncodedStream",m[m.ReviewFailed=3]="ReviewFailed",m)},790349:function(e,t,r){r.d(t,{f:function(){return l}});var n=r(429996),i=r(993047),a=r(627394);let o=n.lazy(()=>(0,i.AD)({fn:()=>r.e("88860").then(r.bind(r,869167))})),l=(0,n.forwardRef)(function(e,t){let{fallback:r,...i}=e;return(0,a.jsx)(n.Suspense,{fallback:null!=r?r:(0,a.jsx)(a.Fragment,{}),children:(0,a.jsx)(o,{...i,ref:t})})})},517410:function(e,t,r){r.d(t,{n:function(){return d},f:function(){return c}});var n=r(669160),i=r.n(n),a=r(387834),o=r(124901),l=r(938137),s={"skill-title-container":"skill-title-container-HZyn43",normal:"normal-ZhsIVI",blue:"blue-IlmkQS",gray:"gray-z1QIIt","skill-title-content":"skill-title-content-lETdEG","icon-wrapper":"icon-wrapper-w4veCu",content:"content-Q9TGRc",title:"title-Vwcqlu","after-title":"after-title-AaCd0F",right:"right-FG_P02","close-btn-wrapper":"close-btn-wrapper-drniKD","close-btn-svg":"close-btn-svg-ISN4XS",shortcut:"shortcut-BVeQlq","shortcut-name":"shortcut-name-ZkJy6y","shortcut-key":"shortcut-key-GZFwtq",small:"small-Zkxktz",divider:"divider-AHF9xh"},u=r(627394);let d=e=>{let{icon:t,className:r,title:n,afterTitleNode:d,background:c,expandBtnStatus:p=l.P.Invisible,injectedComponents:f,size:v="default",expandBtnText:m,closeBtnTooltipText:h,beforeCloseBtn:g,onClickExpandBtn:y,onClick:_,onClickCloseBtn:S}=e,{Tooltip:b=a.Z}=f||{};return(0,u.jsx)("div",{className:i()(r,s["skill-title-container"],"skill-title-container",{[s.normal]:"normal"===c,[s.blue]:"blue"===c,[s.gray]:"gray"===c},{[s.small]:"small"===v}),onClick:_,children:(0,u.jsxs)("div",{className:s["skill-title-content"],children:[t&&(0,u.jsx)("div",{className:s["icon-wrapper"],children:t}),(0,u.jsxs)("div",{className:s.content,children:[n&&(0,u.jsx)("div",{className:s.title,"data-testid":"skill_header_title",children:n}),d&&(0,u.jsx)("div",{className:s["after-title"],children:d})]}),(0,u.jsxs)("div",{className:s.right,children:[null!=g?g:(0,u.jsx)(l.V,{status:p,text:m,size:v,onClick:y}),(0,u.jsx)("div",{children:(0,u.jsx)(b,{trigger:"hover",position:"top",content:(0,u.jsxs)("div",{className:s.shortcut,children:[h&&(0,u.jsx)("div",{className:s["shortcut-name"],children:h}),(0,u.jsx)("div",{className:s["shortcut-key"],children:"ESC"})]}),children:(0,u.jsx)("div",{className:i()(s["close-btn-wrapper"]),onClick:e=>{e.stopPropagation(),null==S||S()},"data-testid":"skill_header_close_button",children:(0,u.jsx)(o.Z,{className:s["close-btn-svg"]})})})})]})]})})},c=e=>{let{className:t}=e;return(0,u.jsx)("div",{className:i()(s.divider,t),children:"\xb7"})}},723998:function(e,t,r){r.d(t,{w:function(){return n}}),r(627394);let n=()=>null},286942:function(e,t,r){r.d(t,{t:function(){return l}});var n=r(429996),i=r(966015),a=r(375292),o=r(627394);let l=(0,n.forwardRef)(function(e,t){let{getPopupContainer:r,style:n,...l}=e,{getPopupContainer:s=r}=(0,a.R)({optionalProvider:!0});return(0,o.jsx)(i.s,{ref:t,showArrow:!1,arrowPointAtCenter:!0,spacing:12,style:{borderRadius:"6px",padding:"5px 10px",...n},...l,getPopupContainer:s})})},777078:function(e,t,r){r.d(t,{x$:function(){return l}});var n=r(429996),i=r(627426);let a=(0,n.createContext)(null);a.Provider;let o=(0,n.createContext)({});o.Provider;let l=()=>{let e=(0,n.useContext)(a),t=(0,n.useContext)(o);return(0,i.Z)(t,e)}},557735:function(e,t,r){r.d(t,{C3:function(){return a},Uw:function(){return o},nb:function(){return i}});var n=r(829619);let i=e=>{if(e)return({[n.M.GUIDANCE_PAGE]:"landing",[n.M.GUIDANCE_SUGGESTIONS]:"input_bar_entrance",[n.M.SIDEBAR]:"sidebar_skill",[n.M.DEFAULT]:"direct_enter",[n.M.NEW_USER_TASK]:"new_user_task",[n.M.CHAT_ACTION_BAR]:"chat_action_bar"})[e]},a=e=>{if(e)return({[n.M.GUIDANCE_PAGE]:"landing",[n.M.GUIDANCE_SUGGESTIONS]:"landing",[n.M.SIDEBAR]:"sidebar_skill",[n.M.DEFAULT]:"direct_enter",[n.M.NEW_USER_TASK]:"new_user_task",[n.M.CHAT_ACTION_BAR]:"chat_action_bar"})[e]},o=e=>{if(e)return({[n.M.GUIDANCE_PAGE]:"chat_action_bar_landing",[n.M.GUIDANCE_SUGGESTIONS]:"chat_action_bar_landing",[n.M.SIDEBAR]:"sidebar_skill_click",[n.M.DEFAULT]:"direct_enter",[n.M.NEW_USER_TASK]:"new_user_task",[n.M.CHAT_ACTION_BAR]:"chat_action_bar_click"})[e]}},829619:function(e,t,r){r.d(t,{M:function(){return n}});var n={GUIDANCE_PAGE:"guidance_page",SIDEBAR:"sidebar",DEFAULT:"default",NEW_USER_TASK:"new_user_task",GUIDANCE_SUGGESTIONS:"guidance_suggestions",CHAT_ACTION_BAR:"chat_action_bar"}},652537:function(e,t,r){r.d(t,{l:function(){return n}});var n={ReadAndSummarize:"ReadAndSummarize",WriteAssistant:"WriteAssistant",ImageGeneration:"ImageGeneration",Search:"Search",Translate:"Translate",ReadPDF:"ReadPDF",ReadWebsite:"ReadWebsite",DeepSearch:"DeepSearch",MusicAssistant:"MusicAssistant",AcademicSearch:"AcademicSearch",EduExerciseAssistant:"EduExerciseAssistant",CodeInterpreter:"CodeInterpreter",ReadMultiWebsites:"ReadMultiWebsites",CodeAssistant:"CodeAssistant",VoiceCall:"VoiceCall",VideoGeneration:"VideoGeneration",AiPpt:"AiPpt",DeepResearch:"DeepResearch"}},304043:function(e,t,r){function n(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,{s:function(){return i}});let i=new class{constructor(){n(this,"inputRef",null),n(this,"bindInputRef",e=>{this.inputRef=e}),n(this,"unbindInputRef",()=>{this.inputRef=null}),n(this,"focusOnInput",()=>{this.inputRef&&this.inputRef.focus()})}}},286972:function(e,t,r){r.d(t,{i:function(){return g},m:function(){return h}});var n=r(429996),i=r(344482),a=r(177056),o=r(444614),l=r(67864),s=r(829619),u=r(93708),d=r(557735),c=r(308691),p=r(468494),f=r(234761),v=r(689337),m=r(22714);let h=e=>{var t;let{chatId:r,chatType:a,activeSkill:o,show_scene:l}=e,s=(0,c.Es)(),u=(0,n.useMemo)(()=>{if(s)return{sendMessageSecScene:"input"}},[s]),d={...(0,p.useFeedStore)(e=>{var t;let n=(0,f.IO)(e),i=(0,f.jo)(e,r),a=(0,f.dg)(e,r);return{conversation_id:r,bot_id:n,conversation_type:null!==(t=null==i?void 0:i.conversation_type)&&void 0!==t?t:null==a?void 0:a.conversation_type}},i.X),show_scene:l,chat_type:a,skill_id:null==o?void 0:null===(t=o.skill_type)||void 0===t?void 0:t.toString(),skill_name:(0,v.Nu)(null==o?void 0:o.skill_type),is_deepsearch_show:0,...u};return{trackMeta:u,trackParams:d}},g=e=>{let{chatId:t,chatType:r,activeSkill:n}=e,i=(0,c.Es)(),p=r===l.z.NewThread&&!i,f=(0,u.sQ)("chatGuidanceStore",e=>(0,d.Uw)(e.skillGuidancePageFrom||s.M.DEFAULT)),v=(0,u.sQ)("chatInputStore",e=>e.selectedRecommendSkill),h=(0,u.sQ)("chatInputStore",e=>e.activeSkillFromMap[t]);return{reportParams:(()=>{let e=(0,a.Z)({action_bar_recommended:v&&(null==n?void 0:n.skill_type)===v.skill_type?(0,m.M)(v.tag):void 0,skill_from:(null==n?void 0:n.skill_type)===(null==h?void 0:h.skillType)?null==h?void 0:h.skillFrom:void 0},o.Z);return i?Object.assign(e,{scene:f,send_source:"skill_guidance_page"}):p&&Object.assign(e,{send_source:"guidance_page"}),e})()}}},917057:function(e,t,r){r.d(t,{O:function(){return d}});var n=r(93708),i=r(46793),a=r(107599),o=r(245966),l=r(636674),s=r(393648),u=r(639088);let d=()=>{let{chatId:e,chatType:t}=(0,i.JW)()||{},r=(0,n.sQ)("chatInputStore",t=>e?t.activeSkillTypeMap[e]:void 0),d=(0,a.jw)(e||"",t),{value:c}=(0,o.f)({key:"aispace_revert",defaultValue:"0",isServerAb:!0}),{value:p}=(0,o.f)({key:"input_upload_aispace_enable",defaultValue:!1});return{enableAISpaceUpload:(0,s.nu)()&&"0"!==c&&p&&d&&(!r||r===l.SkillType.ReadPDF)&&!0,showAISpaceUploadModal:()=>{(0,u.xK)()}}}},400955:function(e,t,r){r.d(t,{g:function(){return y}});var n=r(429996),i=r(607278),a=r(669160),o=r.n(a),l=r(145625),s=r(510361),u=r(629738),d=r(723998),c=r(577831),p=r(190412),f=r(436450),v=r(743567),m=r(222334),h={"chat-input":"chat-input-kWIgzK",chatInput:"chat-input-kWIgzK",disabled:"disabled-rnWzM7","right-tools-container":"right-tools-container-vFoD6y",rightToolsContainer:"right-tools-container-vFoD6y","left-area":"left-area-ELhPUk",leftArea:"left-area-ELhPUk",input:"input-A_xeMF",menu:"menu-j3XcQ6","grid-container":"grid-container-vnmw4K",gridContainer:"grid-container-vnmw4K","grid-left-tools":"grid-left-tools-lJkK1e",gridLeftTools:"grid-left-tools-lJkK1e","grid-input-area":"grid-input-area-OLFGBV",gridInputArea:"grid-input-area-OLFGBV","grid-right-tools":"grid-right-tools-EZkK8B",gridRightTools:"grid-right-tools-EZkK8B",sm:"sm-nweEuQ",md:"md-mqB_Mi"},g=r(627394);let y=(0,n.forwardRef)((e,t)=>{var r;let{disabled:a,readonly:y=!1,allowEmptySubmit:_,onSubmit:S,onPaste:b,onAutoTransValue:k,onKeyDown:w,clearInputOnSubmit:C=!0,placeholder:E,sendBtnSmall:A,sendMessageHoverText:P,sendMessageButtonText:I,sendMessageButtonClassName:x,breakBtnHoverText:M,hasAccessoryArea:T=!1,renderInputTop:R,renderRefContent:U,renderLeftTools:j,renderRightTools:N,renderSendBtn:D,unableToSend:O,resetAccessoryArea:V,onEmptyAt:L,disabledWrapperClick:F,onFocus:W,rows:Z=1,responsiveSize:z,sendMessageStatus:B,onClickSendButton:G,onClickDisabledSendButton:K,onClickBreakButton:H,onSendBtnWrapperClick:Q,onInput:X,onValueChange:q}=e,$=(0,n.useCallback)(e=>{if(null==S||S(e),(0,c.KX)()){var t;let e=null===(t=document)||void 0===t?void 0:t.activeElement;e&&"blur"in e&&(0,i.Z)(e.blur)&&e.blur()}},[S]),J=(0,n.useRef)(null),{width:Y}=(0,p.Z)(J)||{},ee=(0,n.useMemo)(()=>Y&&Y<480?"sm":z,[Y,z]),{textAreaRef:et,textAreaProps:er,submit:en,clear:ei}=(0,s.z)({onSubmit:$,allowEmpty:_,clearInputOnSubmit:C,attachmentCanNotSend:!!T&&O,onEmptyAt:L}),{value:ea}=er;(0,n.useImperativeHandle)(t,()=>({focus:()=>{var e;null===(e=et.current)||void 0===e||e.focus()},clear:()=>{null==V||V(),ei()},autoTransValue:(e,t)=>{var r;null===(r=et.current)||void 0===r||r.focus(),er.onChange(e),null==k||k(e,t)},getText:()=>{var e;return(null===(e=et.current)||void 0===e?void 0:e.value)||""},setText:e=>{er.onChange(e),null==q||q(e)},getTextareaWidth:()=>{var e;return null===(e=et.current)||void 0===e?void 0:e.offsetWidth},blur:()=>{var e;null===(e=et.current)||void 0===e||e.blur()}}),[]);let eo=(0,n.useMemo)(()=>{var e;return!!a||(T?O:!_&&(null===(e=er.value)||void 0===e?void 0:e.trim())==="")},[a,B,T,O,_,er.value]),el=(0,f.Vr)(ea,!0),es=B===l.M.Receiving;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{onClick:()=>{if(a)null==F||F();else{var e;null===(e=et.current)||void 0===e||e.focus()}},children:[null==R?void 0:R(),null==U?void 0:U(),(0,g.jsxs)("div",{ref:J,className:o()(h["chat-input"],h["grid-container"],a&&h.disabled,ee&&h[ee]),children:[j&&(0,g.jsx)("div",{className:o()(h.menu,h["grid-left-tools"]),children:j()}),(0,g.jsx)("div",{className:o()(h["grid-input-area"]),children:(0,g.jsx)(m.N,{dir:(0,v.d)()?el:"ltr",readOnly:y,ref:et,disabled:a,...er,onChange:e=>{null==q||q(e),er.onChange(e)},onKeyDown:e=>{null==w||w(e),er.onKeyDown(e)},className:h.input,rows:Z,autosize:!0,placeholder:E,onPaste:b,autoComplete:"off","data-testid":"chat_input_input",onFocus:W,onInput:X})}),(0,g.jsx)("div",{className:o()(h["grid-right-tools"],h["right-tools-container"]),children:null!==(r=null==D?void 0:D())&&void 0!==r?r:(0,g.jsx)(u.a,{small:A,sendMessageHoverText:P,sendMessageButtonText:I,sendMessageClassName:x,breakBtnHoverText:M,breakBtnVisible:es,disableToSend:eo,onClickSendButton:()=>{null==G||G(),en()},onClickBreakButton:H,onClickDisabledSendButton:K,onWrapperClick:()=>null==Q?void 0:Q({breakBtnVisible:es,disableToSend:eo}),beforeNodes:(0,g.jsx)("div",{className:o()(h["left-area"]),children:N&&(0,g.jsx)(g.Fragment,{children:N()})})})})]})]}),(0,g.jsx)(d.w,{name:"chat_input_html_loaded"})]})})},920541:function(e,t,r){r.d(t,{o:function(){return c}});var n=r(429996),i=r(210230),a=r(669160),o=r.n(a),l=r(471549),s={"chat-input":"chat-input-cgIC3I","single-line":"single-line-q5_dZN",bottom:"bottom-WH4r7v",placeholder:"placeholder-CvGPiw","box-shadow":"box-shadow-kLVNoV",small:"small-DKZGhJ","chat-input-with-upload":"chat-input-with-upload-a1r_Fz","chat-input-button":"chat-input-button-od14Gx","chat-input-content":"chat-input-content-yo1w8N","chat-input-tool":"chat-input-tool-nRZ3bR","chat-input-button-round":"chat-input-button-round-NLmTa0"},u=r(627394);let d=!1,c=e=>{let{placeholder:t,style:r,className:a,uploadIcon:c,boxShadow:p=!1,singleLine:f=!0}=e,v=(0,n.useRef)(null),[m,h]=(0,n.useState)(d);return(0,n.useEffect)(()=>{var e;let t=null===(e=v.current)||void 0===e?void 0:e.clientWidth,r=(0,i.Z)(t)||0===t?d:t<480;d=r,h(r)},[]),(0,u.jsx)("div",{ref:v,className:o()(s["chat-input"],f&&s["single-line"],p&&s["box-shadow"],m&&s.small,c&&s["chat-input-with-upload"],a),style:r,children:f?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:s["chat-input-content"]}),(0,u.jsx)("div",{className:s["chat-input-tool"]}),(0,u.jsx)("div",{className:s["chat-input-tool"]}),(0,u.jsx)("div",{className:s["chat-input-button-round"]})]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("textarea",{disabled:!0,placeholder:t}),(0,u.jsxs)("div",{className:s.bottom,children:[c,(0,u.jsx)("div",{className:s.placeholder}),(0,u.jsx)(l.Z,{className:s["chat-input-button"]})]})]})})}},744787:function(e,t,r){r.d(t,{Y:function(){return f}});var n=r(669160),i=r.n(n),a=r(67864),o=r(46793),l=r(432626),s=r(393648),u=r(350538),d=r(920541),c={"center-input":"center-input-oFzOro"},p=r(627394);function f(){let{className:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.g1)(),r=(0,o.mC)(),n=(0,s.Dv)(),f=!(0,u.dM)(),v=n||f;return(0,p.jsx)(d.o,{className:i()(e,v&&r===a.z.NewThread&&c["center-input"]),placeholder:t(v?"homepage_centered_input_placeholder":"default_input_placeholder")})}},639088:function(e,t,r){r.d(t,{As:function(){return h},GQ:function(){return f},Kb:function(){return y},WF:function(){return v},oW:function(){return _},pe:function(){return m},xK:function(){return g}});var n=r(633906),i=r(607278),a=r(93708),o=r(126628),l=r(708481),s=r(910157),u=r(967037),d=r(644367);let c=()=>{let{chatId:e,chatType:t,chatKey:r}=(0,a.GX)("chatViewCoreStore").currentChatViewConfig||{},n={activeSkillType:(0,a.GX)("chatGuidanceStore").activeSkillIdentifier},i=e?(0,a.GX)("chatInputStore").activeSkillTypeMap[e]:void 0;return{chatId:e,chatType:t,chatKey:r,guidance:n,skillType:i}},p=function(e){let{needsReport:t=!0,reportReturnedValue:r=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(){for(var a=arguments.length,p=Array(a),f=0;f<a;f++)p[f]=arguments[f];return new Promise((a,f)=>{(async()=>{let v=t?(0,u.zQ)({eventName:"chat_input_event",meta:{event:e}}):null;try{let t=await (0,o.mk)();null==v||v.addDurationPoint("get_matchers_success");let u=c();null==v||v.updateMeta({matcher_params:u});let f=t.map(e=>{let t=e(u);if(t)return t}).filter(n.Z);null==v||v.addDurationPoint("find_matcher_success"),null==v||v.updateMeta({plugin_identifiers:f.map(e=>e?e.toString():"undefined").join(",")});let m=await Promise.all(f.map(e=>(0,l.as)(e))),h=m.filter(e=>!!e);null==v||v.addDurationPoint("get_plugins_success"),null==v||v.updateMeta({plugins_ready:m.map(e=>e?"1":"0").join(",")});let g=p[0];r&&(null==v||v.updateMeta({origin_returned_value:(0,s.B)(g)}));for(let t=0;t<h.length;t++){let n=h[t][e],a=(e,t)=>t,o=(0,i.Z)(n)?n:a;try{g=await o(u,g,...p.slice(1)),null==v||v.addDurationPoint(`run_plugin_${t}_success`),r&&(null==v||v.updateMeta({[`plugin_${t}_returned_value`]:(0,s.B)(g)}))}catch(t){d.k.persist.error({error:t,message:`input lifecycle [${e}] execute failed, reason:${t.message}`})}}r&&(null==v||v.updateMeta({returned_value:(0,s.B)(g)})),null==v||v.success(),a(g)}catch(e){null==v||v.error({reason:"run_event_failed",error:e instanceof Error?e:Error(String(e))}),f(e)}})()})}},f=p("onKeyDown",{needsReport:!1}),v=p("onMessageSendingEnd"),m=p("onMessageSendingBefore",{reportReturnedValue:!1}),h=p("onPaste"),g=p("onEmptySlash"),y=p("onBeforeBreakMessage"),_=p("onBeforeSendMessage")},994258:function(e,t,r){r.d(t,{s:function(){return n}});let n=Symbol("voiceCallBtnPlugin")},362318:function(e,t,r){r.d(t,{W:function(){return i}});var n=r(338212);let i=e=>(0,n.U)(e.trim()).some(e=>{var t;return e.type===n.y.link&&(null===(t=e.url)||void 0===t?void 0:t.startsWith("https://"))})},35397:function(e,t,r){r.d(t,{X:function(){return s}});var n=r(429996),i=r(669160),a=r.n(i),o={"chat-input-container":"chat-input-container-fxijw1","chat-input-container-disabled":"chat-input-container-disabled-dqOUxA","chat-input-float":"chat-input-float-UBr6s2"},l=r(627394);let s=(0,n.forwardRef)(function(e,t){let{className:r,hasBoxShadow:n=!0,disabled:i,children:s}=e;return(0,l.jsx)("div",{className:a()(o["chat-input-container"],n&&o["chat-input-float"],r,i&&o["chat-input-container-disabled"]),tabIndex:0,ref:t,children:s})})},567134:function(e,t,r){r.d(t,{P:function(){return n},T:function(){return i}});let n=e=>13===e.keyCode&&!e.shiftKey&&!e.altKey,i=e=>("Backspace"===e.key||8===e.keyCode)&&!e.altKey&&!e.shiftKey},141675:function(e,t,r){r.d(t,{H:function(){return s},_:function(){return l}});var n=r(429996),i=r(93708),a=r(46793),o=r(574367);let l=()=>{let e=(0,n.useRef)(!1);return(0,n.useEffect)(()=>{let t=()=>{e.current=!0},r=()=>{e.current=!1};return document.addEventListener("compositionstart",t),document.addEventListener("compositionend",r),()=>{document.removeEventListener("compositionstart",t),document.removeEventListener("compositionend",r)}},[]),e},s=e=>{let{onCloseSkillEvent:t}=e,r=l(),s=(0,n.useRef)(!1),u=(0,o.Z)(t),d=(0,a.ae)(),c=()=>{var e;(0,i.GX)("chatInputStore").closeSkillPanel(d||""),null===(e=u.current)||void 0===e||e.call(u)},p=e=>{"Escape"!==e.key||e.shiftKey||e.altKey||s.current||c(),s.current=!1},f=e=>{"Escape"!==e.key||e.shiftKey||e.altKey||!r.current||(s.current=!0)};return(0,n.useEffect)(()=>(document.addEventListener("keydown",f),document.addEventListener("keyup",p,!0),()=>{document.removeEventListener("keydown",f),document.removeEventListener("keyup",p,!0)}),[]),{onKeyDownExitSkill:e=>{"Escape"!==e.key||e.shiftKey||e.altKey||r.current||c()}}}},323015:function(e,t,r){r.r(t),r.d(t,{SkillHeader:function(){return v}});var n=r(429996),i=r(93708),a=r(15348),o=r(286942),l=r(777078),s=r(276971),u=r(938137),d=r(517410),c=r(432626),p=r(141675),f=r(627394);let v=e=>{let{skill:t,icon:r,background:v,closeEvent:m,expandBtnStatus:h=u.P.Invisible,afterTitle:g,expandBtnText:y,beforeCloseBtn:_,onClickCollapseBtn:S,onClickExpandBtn:b,onClick:k}=e,{Tooltip:w=o.t}=(0,l.x$)(),C=(0,c.g1)(),E=(0,i.sQ)("chatViewCoreStore",e=>{var t;return null===(t=e.currentChatViewConfig)||void 0===t?void 0:t.chatId}),A=(0,n.useRef)(m);A.current=m;let P="sm"===(0,s.y)();(0,p.H)({onCloseSkillEvent:m}),(0,n.useEffect)(()=>{let e=null==t?void 0:t.skill_type;e&&(0,a.D)("chatInputStoreService").then(t=>{var r;null==t||null===(r=t.getSkillReportEvent({skillType:e,eventName:"skill_input_panel"}))||void 0===r||r.success()})},[t]);let I=(P?null==t?void 0:t.show_name_short:null==t?void 0:t.show_name)||(null==t?void 0:t.show_name);return(0,f.jsx)(d.n,{icon:r,title:I,afterTitleNode:g,background:v,expandBtnStatus:h,injectedComponents:{Tooltip:w},size:P?"small":"default",closeBtnTooltipText:C("exit_skill_tooltip"),onClickExpandBtn:e=>{e===u.P.Expand?null==S||S():e===u.P.Collapse&&(null==b||b())},expandBtnText:y,onClick:k,onClickCloseBtn:()=>{var e;(0,i.GX)("chatInputStore").closeSkillPanel(E||""),null===(e=A.current)||void 0===e||e.call(A)},beforeCloseBtn:_})}},127243:function(e,t,r){r.d(t,{R:function(){return h}});var n=r(429996),i=r(986091),a=r(721557),o=r(377940),l=r(724391),s=r(200235),u=r(308691),d=r(17135),c=r(636674),p=r(115866),f=r(727499),v=r(126473),m=r(627394);let h=e=>{let{chatId:t,activeSkill:r,getAttachmentCanSend:h,showPresetPrompt:g=!0,disableGridLayout:y,onSubmit:_}=e,S=(0,p.Z)(h),b=(0,p.Z)(_),k=(0,u.Es)(),w=(0,s.Rs)({chatId:t,skillType:null==r?void 0:r.skill_type}),C=(0,s.vQ)({chatId:t,skillType:null==r?void 0:r.skill_type}),E=(0,s.LA)({chatId:t,skillType:null==r?void 0:r.skill_type}),{updatePreGeneratedLocalMessageId:A,addAttachment:P,addLink:I,addGitHubLink:x,deleteAttachment:M,clearAllAttachments:T,reuploadAttachment:R,getPreGeneratedLocalMessageId:U}=(0,s.hx)({chatId:t,skillType:null==r?void 0:r.skill_type}),j=async()=>{await T({}),await A()};(0,f.Z)(()=>{j()},[t]);let N=async()=>{await A(),await T({})},D=!(0,i.Z)(E),O=(0,n.useRef)(null),V={showPresetPrompt:(null==r?void 0:r.skill_type)!==c.SkillType.CodeInterpreter&&g,attachmentStates:E,renderArea:e=>e.attachmentStates.every(e=>"image"===e.type)?(0,m.jsx)(l.N6,{...e}):(0,m.jsx)(l.dr,{...e,disableGridLayout:y}),onDeleteAttachment:e=>{M({index:e})},onRetryAttachment:e=>{R({index:e})},onClickPresetPrompt:async(e,t)=>{var r;if(!(null===(r=null==S?void 0:S())||void 0===r||r))return;let n=a.vQ[t]||e;(0,d.trackEvent)("input_bar_edit",{upload_id:await U(),upload_file_size:String(E.reduce((e,t)=>e+(t.size||0),0)),upload_collection_way:(0,i.Z)(E)?"":1===E.length?"single":"multi",upload_from:(0,i.Z)(E)?void 0:k?o.Ux.UPLOAD_FROM_READ_SUMMARIZE_MODULE:o.Ux.UPLOAD_FROM_UPLOAD_PINBUTTON,prompt_content:n,prompt_from:"quick_actions",file_type:E.map(e=>(0,v.lm)(e.fileName)).join(",")}),null==b||b(e,t)}};return{attachments:w,attachmentKeys:C,attachmentStates:E,clearAllAttachments:T,clearAttachments:j,getPreGeneratedLocalMessageId:U,addAttachment:P,updatePreGeneratedLocalMessageId:A,onAfterSubmit:N,onResetAccessoryArea:()=>{j()},addLink:I,addGitHubLink:x,enableAttachmentArea:D,attachmentAreaRef:O,attachmentAreaScrollToBottom:()=>{var e,t;null===(t=O.current)||void 0===t||null===(e=t.scrollToBottom)||void 0===e||e.call(t)},attachmentAreaProps:V}}},117604:function(e,t,r){r.d(t,{T:function(){return u}});var n=r(986091),i=r(377940),a=r(851510),o=r(308691),l=r(17135),s=r(432626);let u=e=>{let{attachmentStates:t=[],getPreGeneratedLocalMessageId:r,attachmentCanSend:u=!0}=e,d=(0,s.g1)(),c=(0,o.Es)()?i.Ux.UPLOAD_FROM_READ_SUMMARIZE_MODULE:i.Ux.UPLOAD_FROM_UPLOAD_PINBUTTON;return{sendMessageBtnProps:{sendMessageHoverText:d("send_button_hover_text"),unableToSend:!u,onClickSendButton:async()=>{if((0,n.Z)(t)){(0,l.trackEvent)("click_send_button_status",{status:"1",upload_id:await (null==r?void 0:r()),upload_collection_way:(0,n.Z)(t)?"":1===t.length?"single":"multi",upload_type:"",upload_file_size:"0",upload_from:c});return}let e=t.some(e=>(0,a.Bx)(e.status))?"cannot_read_more_files":t.some(e=>(0,a.Ln)(e.status))?"wait_files_to_upload":void 0;(0,l.trackEvent)("click_send_button_status",{status:e?"0":"1",error_code:e,upload_id:await (null==r?void 0:r()),upload_way:JSON.stringify(t.map(e=>e.uploadWay||"")),upload_collection_way:(0,n.Z)(t)?"":1===t.length?"single":"multi",upload_type:JSON.stringify(t.map(e=>"image"===e.type?"pic":"pdf")),upload_file_size:String(t.reduce((e,t)=>e+(t.size||0),0)),upload_from:c})}}}}},496918:function(e,t,r){r.d(t,{y:function(){return d}});var n=r(429996),i=r(145625),a=r(721557),o=r(93708),l=r(432626),s=r(636674),u=r(126473);let d=e=>{let{chatId:t,activeSkill:r,refContents:d,attachmentStates:c}=e,p=(0,l.g1)(),f=(0,n.useMemo)(()=>(null==c?void 0:c.length)?c.every(e=>(0,u.dB)(e.fileName)):!!((null==d?void 0:d.length)&&d.every(e=>"attachment"===e.type&&(0,u.dB)(e.fileName))),[c,d]);return{getPlaceholder:()=>{if((null==r?void 0:r.skill_type)===s.SkillType.CodeInterpreter||f)return p("skill_dataAnalysis_input_placeholder")},getPresetPrompts:()=>{if(f)return[a.KP.SummarizeData,a.KP.GenerateCharts]},onAfterSubmit:()=>{((null==r?void 0:r.skill_type)===s.SkillType.CodeInterpreter||f)&&(0,o.GX)("chatInputStore").updateActiveSkillTypeMap(t||"",s.SkillType.CodeInterpreter,i.u.AfterSkill)}}}},274957:function(e,t,r){r.d(t,{O:function(){return w}});var n=r(429996),i=r(145625),a=r(477710),o=r(67864),l=r(377940),s=r(156217),u=r(93708),d=r(322828),c=r(851510),p=r(200235),f=r(886421),v=r(792288),m=r(468494),h=r(466298),g=r(287491),y=r(17135),_=r(900789),S=r(636674),b=r(947020),k=r(115866);let w=e=>{let{chatId:t,chatType:r,activeSkill:w,enableAutoSelectCodeAfterSubmit:C=!0,getPreGeneratedLocalMessageId:E,onAddGitHubUrl:A,skillSceneHook:P}=e,I=(0,k.Z)(E),x=(0,k.Z)(A),M=(0,p.Rs)({chatId:t}),T=(0,p.LA)({chatId:t}),R=(0,d.n)({chatId:t,chatType:r,skillType:null==w?void 0:w.skill_type}),U=(0,n.useMemo)(()=>"function"==typeof(null==P?void 0:P.onCodeSkillRelate)?P.onCodeSkillRelate(M,R):R,[M,R,P]),j=(0,h.d)(),N=(0,s.GL)("chatViewService"),D=async e=>{var n;let{trimText:i,event:a}=e;if((null==P?void 0:null===(n=P.onPasteParse)||void 0===n?void 0:n.call(P))===!1)return;let s=(0,b.zq)(i),u={from:"click",conversationId:r===o.z.NewThread?"":t,uploadFrom:l.Ux.UPLOAD_FROM_UPLOAD_PINBUTTON,botId:(0,f.SR)(t)||"",conversation_type:(0,v.QW)(m.useFeedStore.getState(),t)||1,skill_name:null,skill_id:"",chat_type:(r===o.z.NewThread?"default_new":(0,f.yT)("",t))||"other_default",upload_way:"add_link",upload_collection_way:"single",upload_type:"github",upload_from:l.Ux.UPLOAD_FROM_UPLOAD_PINBUTTON,upload_file_type:l.ol.UPLOAD_FILE_TYPE_LINK,collection_name:"",collection_id:""};if((0,b.wq)(i)&&(0,y.trackEvent)("upload_status",{...u,success:"false",error_code:"unsupport_repotype"}),(0,b.gz)(i)&&(0,y.trackEvent)("upload_status",{...u,success:"false",error_code:"unsupport_repourl"}),s&&0===T.length&&U){let{valid:e,metaInfo:n}=await j(i,!1);e?(a.preventDefault(),null==x||x({url:i,ctx:{from:"click",conversationId:r===o.z.NewThread?"":t,chatType:(r===o.z.NewThread?"default_new":(0,f.yT)("",t))||"other_default",skillType:0,skillId:"",uploadFrom:l.Ux.UPLOAD_FROM_UPLOAD_PINBUTTON,botId:(0,f.SR)(t)||"",uploadWay:"add_link",uploadCollectionWay:"single",uploadId:await (null==I?void 0:I())||"",metaInfo:JSON.stringify(n)}})):(0,y.trackEvent)("upload_status",{...u,meta_info:JSON.stringify(n),success:"false",error_code:"unsupport_repoprivate"})}};return{enableCodeSkillRelate:U,onAfterSubmit:()=>{let e=!1,r=!0,n="";if(1===M.length){let t=M[0],i=T[0];n=(null==i?void 0:i.fileKey)||"",r=(null==i?void 0:i.reviewState)!==_.m9.ReviewState_NotCompliant,(0,c.zE)(t)&&(0,g.GX)(null==i?void 0:i.fileName)&&(e=!0),(0,c.u$)(t)&&(null==i?void 0:i.isRepo)&&(e=!0),(0,c.zj)(t)&&(e=!0)}if(M.length>1){var o;e=T.every(e=>"file"===e.type&&(0,g.GX)(e.fileName)),r=T.every(e=>"file"===e.type&&e.reviewState!==_.m9.ReviewState_NotCompliant),n=(null===(o=T[0])||void 0===o?void 0:o.fileKey)||""}let l=!w||w.skill_type===S.SkillType.CodeAssistant;if(e&&l&&U&&C){let e=S.SkillType.CodeAssistant;(0,u.GX)("chatInputStore").updateActiveSkillTypeMap(t,e,i.u.AfterSkill),r&&N.openCanvasPanel({messageId:"",conversationId:t,canvasLayoutState:a.P.CANVAS_ONLY,fileKey:n,attachments:T,isCodeFile:!0,chatId:t,teaCtx:{skillType:e}})}else(0,u.GX)("chatInputStore").closeSkillPanel(t)},onPasteHandler:D}}},125349:function(e,t,r){r.d(t,{W:function(){return u}});var n=r(139503),i=r(160195),a=r(564634),o=r(443682),l=r(432626),s=r(636674);let u=e=>{let{activeSkill:t,disableRefContents:r,refContents:u,attachmentStates:d,scene:c}=e,p=(0,l.g1)(),f=(0,n.j)(),{openReadCanvas:v}=(0,i.j)({attachmentStates:null!=d?d:[],openFrom:c?`send_message_in_${c}`:"send_message"}),{showUltraLongText:m,success:h,tips:g}=(0,a.L)({attachmentStates:null!=d?d:[],scene:"sendMessageButton"}),y=(0,o.u)({showUltraLongText:m});return{getPlaceholder:()=>{var e,n;if((null==t?void 0:t.skill_type)===s.SkillType.ReadPDF||!r&&((null==u?void 0:null===(e=u[0])||void 0===e?void 0:e.type)==="attachment"||(null==u?void 0:null===(n=u[0])||void 0===n?void 0:n.type)==="link"))return p("landing_creation_inputmessage_pdf")},enableSendOcrImage:f,openReadCanvas:v,getSendMessageButtonText:()=>y,getSendReportParams:()=>({is_long_file:+!!m}),getSendMessageHoverText:()=>g,attachmentCanSend:h}}},305396:function(e,t,r){r.d(t,{q:function(){return U}});var n=r(838372),i=r(81307),a=r(721557),o=r(156217),l=r(200235),s=r(190831),u=r(107599),d=r(216179),c=r(115866),p=r(999132),f=r(126473),v=r(164303),m=r(986091),h=r(329666),g=r(377940),y=r(145625),_=r(669384),S=r(15348),b=r(639088),k=r(380815),w=r(122621),C=r(851510),E=r(886421),A=r(287491),P=r(900789),I=r(636674),x=r(910157),M=r(811208);let T=async e=>{var t,r,a,o;let{chatId:l,text:s,attachments:u,attachmentKeys:d,attachmentStates:c,source:p,templateSource:f={prompt:"",templateId:"",source:i.iz.Original},activeSkill:T,isSamantha:U,originalSendMessage:j,preGeneratedLocalMessageId:N,refContents:D,refContentSource:O,refContentInputSkill:V,trackMeta:L,presetPrompt:F,presetPromptType:W,presetPromptExt:Z,reportParams:z,enableSendOcrImage:B,enableImageVlm:G,openReadCanvas:K,enableCodeSkillRelate:H}=e,Q=async e=>{await j(await (0,b.pe)(e))},X=(0,E.SR)(l),q=l;if(!X&&(0,E.nD)(l)&&(X=l,q=void 0),1===u.length&&!U&&!(0,k.LW)(X||"")){await R(e);return}let $=s.trim(),J=g.Ux.UPLOAD_FROM_UPLOAD_PINBUTTON,Y=null==T?void 0:null===(t=T.skill_type)||void 0===t?void 0:t.toString(),ee=!Y||(null==T?void 0:T.skill_type)===I.SkillType.CodeAssistant,et=!Y&&!(0,h.RG)({presetPrompt:F})||(null==T?void 0:T.skill_type)===I.SkillType.ReadPDF,er=T?{input_skill:JSON.stringify({skill_id:Y,skill_type:T.skill_type})}:V?{input_skill:V}:(0,n.A)({presetPrompt:F})?{input_skill:JSON.stringify({skill_id:I.SkillType.ReadPDF.toString(),skill_type:I.SkillType.ReadPDF})}:(0,h.RG)({presetPrompt:F})?{input_skill:JSON.stringify({skill_id:I.SkillType.SkillAiPodcast.toString(),skill_type:I.SkillType.SkillAiPodcast})}:void 0;if(1===u.length){let e=u[0];if((0,C.Or)(e)){let t=B?(0,w.m0)({text:$,attachments:u,attachmentKeys:d,attachmentStates:c,enableImageVlm:G},{preset_prompt_type:W,upload_from:J,...z}):(0,w.A_)($,e,{preset_prompt_type:W,upload_from:J,...z});t&&await Q([{...t,conversationId:null!==(r=t.conversationId)&&void 0!==r?r:q,preGeneratedLocalMessageId:N,extraExt:{...await (0,w.eg)(N),...er,...Z}}])}else if((0,C.zE)(e)||(0,C.Q1)(e)){if((0,C.zE)(e)&&(0,A.GX)(c[0].fileName)&&ee&&H){let e=u.map((e,t)=>{let r=c[t],{file:n}=e,{parseState:i,reviewState:a,fileName:o,md5:l,fileKey:s}=r,u=d[t]||s;return{type:"file",key:u,localKey:"localKey"in e&&e.localKey||"",file_parse_state:i,file_review_state:a,identifier:"localKey"in e?e.localKey||"":u,name:(0,M.G)("name")(n)||o,size:null==n?void 0:n.size,md5:l}});await Q([{text:$,sendAttachments:e,conversationId:q,reportParams:{sec_scene:null==L?void 0:L.sendMessageSecScene,preset_prompt_type:W,upload_from:J,skill_from:y.u.FileUpload,...z},extraExt:{useSamanthaChat:"true",input_skill:JSON.stringify({skill_id:_.W.SkillCodeAssistant,skill_type:_.W.SkillCodeAssistant}),...Z}}]);return}let t=(0,w.m0)({text:$,attachments:u,attachmentKeys:d,attachmentStates:c,enableImageVlm:G},{preset_prompt_type:W,upload_from:J,...z});t&&(await Q([{...t,conversationId:q,preGeneratedLocalMessageId:N,extraExt:{...await (0,w.eg)(N),...er,...Z}}]),et&&await (null==K?void 0:K({skillType:null==T?void 0:T.skill_type})))}else if((0,C.u$)(e)){let t=c[0];if((null==t?void 0:t.isRepo)&&ee&&H){let{id:r,source:n,language:i,ref:a,name:o}=t.repoInfo||{},l={key:r||e.localKey||"",localKey:"localKey"in e&&e.localKey||"",type:"link",identifier:r,file_review_state:P.m9.ReviewState_Access,name:o,url:"url"in e&&e.url||"",extra:{repo_id:r,repo_name:o,source:`${n}`,language:i,ref:a}};await Q([{text:$,sendAttachments:[l],conversationId:q,reportParams:{sec_scene:null==L?void 0:L.sendMessageSecScene,preset_prompt_type:W,upload_from:J,skill_from:y.u.FileUpload,...z},extraExt:{useSamanthaChat:"true",input_skill:JSON.stringify({skill_id:_.W.SkillCodeAssistant,skill_type:_.W.SkillCodeAssistant}),...Z}}])}else await Q([{compositeContent:{text:$,links:[e.url]},conversationId:q,reportParams:{sec_scene:null==L?void 0:L.sendMessageSecScene,preset_prompt_type:W,upload_from:J,...z},extraExt:{...er,...Z}}]),et&&await (null==K?void 0:K({skillType:null==T?void 0:T.skill_type}))}else if((0,C.zj)(e)){let e=u.map((e,t)=>{let{parseState:r,reviewState:n,fileKey:i}=c[t],a=d[t]||i;return{type:"directory",key:a,localKey:"localKey"in e&&e.localKey||"",file_parse_state:r,file_review_state:n,identifier:a,name:e.dirName}});await Q([{text:$,sendAttachments:e,reportParams:{sec_scene:null==L?void 0:L.sendMessageSecScene,preset_prompt_type:W,upload_from:J,...z},extraExt:{useSamanthaChat:"true",input_skill:JSON.stringify({skill_id:_.W.SkillCodeAssistant,skill_type:_.W.SkillCodeAssistant}),...Z}}]);return}else $&&await Q([{...(0,w.tz)($,{content_source:p,content_source_template_id:null==f?void 0:f.templateId,preset_prompt_type:W,...z}),conversationId:q}])}else if(0===u.length){if($){let e={...er},t=await (0,S.D)("refContentStoreService");if(T&&(null==t||t.clearRefContents(l,{retainDisableRef:!0})),!T&&D&&(0,k.DG)(D[0])&&O!==I.SkillType.ReadPDF){if(O===I.SkillType.ReferenceAsk){let r=D[0].text;(0,v.Z)(e,{reference_content:JSON.stringify(D),input_skill:JSON.stringify({skill_id:String(O),skill_type:O,template_key:"query_with_reference",variables:{reference_text:r}})}),null==t||t.clearRefContents(l,{retainDisableRef:!0})}}else D&&!(0,m.Z)(D)&&(0,v.Z)(e,{reference_content:JSON.stringify(D)});let r=null==D?void 0:null===(a=D.filter(e=>"attachment"===e.type))||void 0===a?void 0:a.map(e=>e.fileKey),n=null==D?void 0:null===(o=D.filter(e=>"attachment"===e.type))||void 0===o?void 0:o.map(e=>e.fileName||"");await Q([{...(0,w.tz)($,{sec_scene:null==L?void 0:L.sendMessageSecScene,content_source:p,content_source_template_id:null==f?void 0:f.templateId,preset_prompt_type:W,...(null==r?void 0:r.length)>0&&(null==n?void 0:n.length)>0?{collection_id:(null==r?void 0:r.length)===1?r[0]:(0,x.B)(r),collection_name:(null==n?void 0:n.length)===1?n[0]:(0,x.B)(n)}:{},...z}),conversationId:q,extraExt:e}])}}else{if(c.every(e=>"file"===e.type&&(0,A.GX)(e.fileName))&&ee&&H){let e=u.map((e,t)=>{let r=c[t],{file:n}=e,{parseState:i,reviewState:a,fileName:o,md5:l}=r,s=d[t]||"";return{type:"file",key:s,localKey:"localKey"in e&&e.localKey||"",file_parse_state:i,file_review_state:a,identifier:"localKey"in e?e.localKey||"":s,name:(0,M.G)("name")(n)||o,size:null==n?void 0:n.size,md5:l}});await Q([{text:$,sendAttachments:e,conversationId:q,reportParams:{sec_scene:null==L?void 0:L.sendMessageSecScene,preset_prompt_type:W,upload_from:J,skill_from:y.u.FileUpload,...z},extraExt:{useSamanthaChat:"true",input_skill:JSON.stringify({skill_id:_.W.SkillCodeAssistant,skill_type:_.W.SkillCodeAssistant}),...Z}}]);return}let e=(0,w.m0)({text:$,attachments:u,attachmentKeys:d,attachmentStates:c,enableImageVlm:G},{preset_prompt_type:W,upload_from:J,...z});e?(await Q([{...e,conversationId:q,preGeneratedLocalMessageId:N,extraExt:{...await (0,w.eg)(N),...er,...Z}}]),et&&await (null==K?void 0:K({skillType:null==T?void 0:T.skill_type}))):$&&await Q([{...(0,w.tz)($,{sec_scene:null==L?void 0:L.sendMessageSecScene,content_source:p,content_source_template_id:null==f?void 0:f.templateId,preset_prompt_type:W,...z}),conversationId:q,extraExt:{...er}}])}},R=async e=>{let{text:t,chatId:r,attachments:n,source:a,templateSource:o={prompt:"",templateId:"",source:i.iz.Original},originalSendMessage:l,preGeneratedLocalMessageId:s,presetPromptType:u,reportParams:d}=e;t=t.trim();let c=g.Ux.UPLOAD_FROM_UPLOAD_PINBUTTON,p=n[0];if(!p)return;let f=null;(0,C.Or)(p)?f=(0,w.xz)(p,{preset_prompt_type:u,upload_from:c,...d,from:""}):(0,C.Q1)(p)?f=(0,w.Tt)(p,{preset_prompt_type:u,upload_from:c,...d,from:""}):(0,C.zE)(p)&&(f=(0,w.Z8)(p,{preset_prompt_type:u,upload_from:c,...d,from:""})),f&&(t?await l([{...f,conversationId:r,preGeneratedLocalMessageId:s,extraExt:{...await (0,w.eg)(s)}},{...(0,w.tz)(t,{content_source:a,content_source_template_id:null==o?void 0:o.templateId,preset_prompt_type:u,upload_from:c,...d}),conversationId:r}]):await l([{...f,conversationId:r,preGeneratedLocalMessageId:s,extraExt:{...await (0,w.eg)(s)}}]))},U=e=>{var t;let{chatId:r,chatType:v,activeSkill:m,getTemplateSource:h,getPreGeneratedLocalMessageId:g,trackMeta:y,reportParams:_,sendReportParams:S,enableCodeSkillRelate:b,enableImageVlm:k,enableSendOcrImage:w,openReadCanvas:C,onResetValue:E,onAfterSubmit:A,onBeforeSubmit:P}=e,I=(0,c.Z)(h),x=(0,c.Z)(g),M=(0,c.Z)(C),R=(0,c.Z)(E),U=(0,c.Z)(A),j=(0,c.Z)(P),N=(0,l.Rs)({chatId:r,skillType:null==m?void 0:m.skill_type}),D=(0,l.vQ)({chatId:r,skillType:null==m?void 0:m.skill_type}),O=(0,l.LA)({chatId:r,skillType:null==m?void 0:m.skill_type}),V=(0,u.jw)(r,v),{sendMessage:L}=null!==(t=(0,o.GL)("chatMessageService"))&&void 0!==t?t:{},F=(0,s.ZO)(r),W=(0,d.g)(),Z=(0,p.Z)(e=>{if(e)return{...(0,n.G)(e)}});return{submit:async(e,t)=>{var n,o;if(!await j())return;let l=null==I?void 0:I(),{source:s}=null!=l?l:{source:i.iz.Original};(null==l?void 0:l.source)===i.iz.UseTemplate&&(null==l?void 0:l.prompt)!==e&&(s=i.iz.ChangeTemplate),null==R||R();let u=t&&Z(t),d=t&&(a.vQ[t]||e);await T({chatId:r,text:e,attachments:N,attachmentKeys:D,attachmentStates:O,source:s,templateSource:l,activeSkill:m,originalSendMessage:L,isSamantha:V,preGeneratedLocalMessageId:null!==(n=await (null==x?void 0:x()))&&void 0!==n?n:"",refContents:null!==(o=null==F?void 0:F.refContents)&&void 0!==o?o:[],refContentSource:null==F?void 0:F.source,refContentInputSkill:null==F?void 0:F.inputSkill,trackMeta:y,presetPrompt:t,presetPromptType:d,presetPromptExt:u,reportParams:{..._,scene:(null==_?void 0:_.scene)?_.scene:t?"input_sug_prompts":(null==F?void 0:F.scene)?null==F?void 0:F.scene:"keyboard",upload_collection_way:(null==O?void 0:O.length)?O.length>1?"multi":"single":void 0,upload_file_type:(null==O?void 0:O.length)>0?(0,f.JB)((0,f.lm)(O[0].fileName)):void 0,...null==F?void 0:F.reportParams,...W,...S},enableSendOcrImage:w,enableImageVlm:k,openReadCanvas:M,enableCodeSkillRelate:b}),await (null==U?void 0:U({presetPrompt:t,attachments:N}))}}}},219969:function(e,t,r){r.d(t,{B:function(){return d}});var n=r(429996),i=r(162063),a=r(986091),o=r(377940),l=r(200235),s=r(308691),u=r(17135);let d=e=>{let{chatId:t,attachmentStates:r=[],trackParams:d}=e,c=(0,s.Es)()?o.Ux.UPLOAD_FROM_READ_SUMMARIZE_MODULE:o.Ux.UPLOAD_FROM_UPLOAD_PINBUTTON,p=(0,n.useRef)(!1);(0,n.useEffect)(()=>{p.current=!1},[t]);let f=(0,l.GJ)({chatId:t}),v=(0,n.useCallback)((0,i.Z)(()=>{(0,u.trackEvent)("input_bar_edit",{upload_id:f,upload_file_size:String(r.reduce((e,t)=>e+(t.size||0),0)),upload_collection_way:(0,a.Z)(r)?"":1===r.length?"single":"multi",upload_from:(0,a.Z)(r)?void 0:c,prompt_from:"keyboard"})},3e3),[r.length,f]),m=(0,i.Z)(()=>{(0,u.trackEvent)("input_bar_enter",{click_scene:"skills_search_bar",...d,is_quote:+!(0,a.Z)(r),quote_type:(0,a.Z)(r)?null:JSON.stringify(r.map(e=>"link"===e.type?"url":"file")),collection_id:(0,a.Z)(r)?void 0:JSON.stringify(r.map(e=>e.localKey||e.url||""))})},1e3);return{onKeyDown:()=>{p.current||((0,u.trackEvent)("message_editing",{edit_method:"text"}),p.current=!0)},onInput:()=>{v()},onFocus:()=>{m()}}}},337726:function(e,t,r){r.d(t,{s:function(){return l}});var n=r(429996),i=r(529537),a=r(572231);let o=(0,i.Z)(()=>{a.Z.getState().addDurationPoint("chat_input_first_render")}),l=()=>{o(),(0,n.useEffect)(()=>{a.Z.getState().addDurationPoint("chat_input_mount")},[])}},432197:function(e,t,r){r.d(t,{x:function(){return o}});var n=r(429996),i=r(81307),a=r(107599);let o=e=>{let{chatId:t,chatType:r,attachmentStates:o=[]}=e,l=(0,n.useRef)({prompt:"",templateId:"",source:i.iz.Original}),s=(0,a.jw)(t,r);return{getTemplateSource:()=>l.current,onPasteHandler:e=>{let{text:t,isValidLink:r}=e;(!s||!r||0!==o.length)&&t&&t.length>20&&(l.current.source=i.iz.Paste,l.current.templateId="")},onAutoTransValue:(e,t)=>{l.current={prompt:e,templateId:t,source:i.iz.UseTemplate}},onAfterSubmit:()=>{l.current={prompt:"",templateId:"",source:i.iz.Original}}}}},461130:function(e,t,r){r.d(t,{d:function(){return c}});var n=r(429996),i=r(156217),a=r(544888),o=r(46793),l=r(475879),s=r(393648),u=r(350538),d=r(577831);function c(e){let t=(0,i.GL)("chatInputService"),{needFocus:r=!1}=e||{},{chatInputRef:c}=(0,l.E)(),p=(0,s.Dv)(),f=(0,s.gF)(),v=!(0,u.dM)(),m=f?v:p,h=()=>{var e;r&&(null===(e=c.current)||void 0===e||e.focus())};(0,a.ku)(()=>{h()}),(0,a.Hf)(()=>{!((0,d.W7)()||!m&&(0,d.mk)())&&h()}),function(e){let t=(0,o.ae)(),r=(0,n.useRef)("");(0,n.useEffect)(()=>{t&&(""===r.current&&e(),r.current=t)},[t])}(()=>{!((0,d.W7)()||!m&&(0,d.mk)())&&h()}),(0,n.useEffect)(()=>{let e=()=>{var e;null===(e=t.getCurrentService())||void 0===e||e.then(e=>{var t;null==e||null===(t=e.focusOnEditor)||void 0===t||t.call(e)})};return window.addEventListener("visibilitychange",e),()=>{window.removeEventListener("visibilitychange",e)}},[])}},174398:function(e,t,r){r.r(t),r.d(t,{GenericChatInputPlugin:function(){return eh}});var n=r(87222),i=r(429996),a=r(814986),o=r(828652),l=r(477041),s=r(986091),u=r(444614),d=r(813296),c=r(151840),p=r(67864),f=r(145625),v=r(156217),m=r(492284),h=r(35397),g=r(744947),y=r(530836),_=r(844108),S=r(93708),b=r(15348),k=r(994258),w=r(383906),C=r(199627),E=r(994185),A=r(380041),P=r(286972),I=r(304043),x=r(920485),M=r(917057),T=r(305919),R=r(400955),U=r(736026),j=r(724391),N=r(147333),D=r(851510),O=r(190831),V=r(200235),L=r(308691),F=r(886421),W=r(107599),Z=r(475879),z=r(729813),B=r(689337),G=r(17135),K=r(432626),H=r(338212),Q=r(393648),X=r(190412),q=r(514447),$=r(644367);let J=e=>{let{uploadButtonPluginList:t,screenshotBtnPluginIdentifier:r,voiceCallBtnPluginIdentifier:n,asrBtnPluginIdentifier:a,isNewChatInputInChat:o,uploadButtonShowRight:l,enableScreenshotBtn:s,isSamantha:u,isInGuidance:d}=e;return(0,i.useMemo)(()=>{let e=[];return l&&!o&&e.push(...t),s&&e.push(r),u&&!d&&e.push(n),e.push(a),e.filter(Boolean)},[a,l,o,s,t])};var Y=r(337726),ee=r(821192),et=r(322639),er=r(350538);let en=e=>{let{chatId:t,chatType:r,reportParams:n}=e,i=(0,Q.Dv)(),a=(0,Q.gF)(),o=(0,er.dM)(),l=a?!o:i,s=(0,L.Es)(),u=r===p.z.NewThread&&!s,d=(0,W.sX)(t||"")||{},c=(0,et.jx)(d),f=(0,W.jw)(t,r),v={source:s?"pdf_send_message":"send_message",eventName:"chat_input_guest_login",meta:{...n,is_samantha:f},chatId:t,chatType:r},{chatGuestLogin:m}=(0,ee.oQ)(v),{onClickGuestDisabled:h}=(0,ee.ri)(v);return{uploadButtonShowRight:(!l||!u)&&void 0,rows:l&&u?2:void 0,responsiveSize:l&&u?"sm":void 0,enableScreenshotBtn:(!l||!u)&&!c,handleDisabledSubmit:()=>!!(0,Q.M7)()||!s&&!!f||(m(),!1),handleDisabledWrapperClick:h}};var ei=r(461130),ea=r(127243),eo=r(432197),el=r(219969),es=r(274957),eu=r(496918),ed=r(125349),ec=r(305396),ep=r(117604),ef=r(627394);let ev=(0,i.lazy)(()=>r.e("23512").then(r.bind(r,537802)).then(e=>({default:e.SkillHeader}))),em=e=>{let{chatId:t="",chatType:r,disabled:n,className:ee,isToolButtonSmall:et,reportParams:er,trackParams:em,skill:eh,enableArouseMoreSkill:eg,placeholder:ey,enableUpload:e_,enableUserUpload:eS,showHeader:eb,onAfterSendMessage:ek,onBeforeSendMessage:ew,onKeyDown:eC,onPaste:eE,onEmptyAt:eA,onDisabledWrapperClick:eP}=e;(0,Y.s)();let eI=eh.skill_type?eh:void 0,ex=(0,L.Es)(),eM=null!=eb?eb:!ex,eT=(0,m.x)(),eR=(0,F.SR)(t),eU=(0,K.g1)(),ej=(0,S.sQ)("chatViewCoreStore",e=>{var t;return null===(t=e.currentChatViewConfig)||void 0===t?void 0:t.isImmersiveMode}),eN=(0,W.jw)(t,r),eD=(0,S.sQ)("deepThinkingControlStore",e=>e.enableDeepThinkingSwitch&&!eI&&!ej&&eN),eO=(0,Q.nu)(),eV=(0,v.GL)("chatInputService"),eL=(0,v.GL)("chatViewService"),{trackMeta:eF}=(0,P.m)({chatId:t,chatType:r,activeSkill:eI}),eW=(0,i.useRef)({focus:a.Z,getText:()=>"",clear:a.Z,autoTransValue:a.Z,blur:a.Z,setText:a.Z,getTextareaWidth:()=>0}),eZ=(0,i.useCallback)(e=>{eW.current=e},[]),{chatInputRef:ez}=(0,Z.E)();(0,i.useImperativeHandle)(ez,()=>{let e={...eW.current,setSkillMoreVisible:eX,attachmentAreaScrollToBottom:()=>{null==tl||tl()}};return I.s.bindInputRef(e),e});let eB=(0,i.useRef)(null),eG=(0,X.Z)(eB),{selectSkill:eK,reportSelectSkill:eH}=(0,x.f)({trackParams:em}),{enabled:eQ,setMoreVis:eX,popoverProps:eq}=(0,x.c)({width:null==eG?void 0:eG.width,scene:"input_dropdown",trackParams:em,selectSkill:eK,reportSelectSkill:eH}),{enableAISpaceUpload:e$,showAISpaceUploadModal:eJ}=(0,M.O)(),{uploadButtonShowRight:eY,rows:e0,responsiveSize:e1,enableScreenshotBtn:e6,handleDisabledSubmit:e3,handleDisabledWrapperClick:e4}=en({chatId:t,chatType:r,reportParams:er});(0,ei.d)({needFocus:!n});let e7=!(0,o.Z)(eY)||eY||eD,e9=(0,i.useRef)(!1),[e2,e5]=(0,i.useState)(!1),e8=e=>{e9.current=e,e5(e)},te=(0,i.useRef)(400),tt=(0,l.Z)(e1)?e1:eD?"md":e2?"sm":"md",{enableAttachmentArea:tr,attachmentAreaProps:tn,attachmentStates:ti,addGitHubLink:ta,getPreGeneratedLocalMessageId:to,attachmentAreaScrollToBottom:tl,attachmentAreaRef:ts,...tu}=(0,ea.R)({chatId:t,activeSkill:eI,getAttachmentCanSend:()=>tb,onSubmit:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return tA(...t)}}),td=(0,O.UC)(t),tc=(null==td?void 0:td.refContents)||[],tp=eI&&!ex||!(0,s.Z)(ti)||(0,s.Z)(tc)||n,{getTemplateSource:tf,...tv}=(0,eo.x)({chatId:t,chatType:r,attachmentStates:ti}),{...tm}=(0,el.B)({chatId:t,attachmentStates:ti,trackParams:em}),{enableCodeSkillRelate:th,...tg}=(0,es.O)({chatId:t,chatType:r,activeSkill:eI,getPreGeneratedLocalMessageId:to,onAddGitHubUrl:ta}),{...ty}=(0,eu.y)({chatId:t,activeSkill:eI,refContents:tc,attachmentStates:ti}),{enableSendOcrImage:t_,openReadCanvas:tS,attachmentCanSend:tb,...tk}=(0,ed.W)({activeSkill:eI,disableRefContents:tp,refContents:tc,attachmentStates:ti,scene:"generic_chat_input"}),tw=async()=>{await (null==ek?void 0:ek()),tv.onAfterSubmit(),await tu.onAfterSubmit()},tC=ti.some(e=>"screenshot"===e.uploadWay),{enableImageVlm:tE}=(0,V.E5)(),{submit:tA}=(0,ec.q)({chatId:t,chatType:r,activeSkill:eI,getTemplateSource:tf,getPreGeneratedLocalMessageId:to,trackMeta:eF,reportParams:er,sendReportParams:{...tk.getSendReportParams(),is_from_screen_shot:+!!tC},enableImageVlm:tE,enableSendOcrImage:t_,enableCodeSkillRelate:th,openReadCanvas:tS,onResetValue:()=>{var e;return null===(e=eW.current)||void 0===e?void 0:e.setText("")},onBeforeSubmit:async()=>!!(await (null==ew?void 0:ew({clearRefContent:!1}))!==!1&&e3()),onAfterSubmit:async()=>{await tw(),tg.onAfterSubmit(),ty.onAfterSubmit()}}),{sendMessageBtnProps:tP}=(0,ep.T)({attachmentStates:ti,attachmentCanSend:tb,getPreGeneratedLocalMessageId:to}),{isNewChatInputInChat:tI}=(0,T.F)({chatId:t,chatType:r}),tx={type:"textarea",getValue:()=>{var e,t;return null===(t=eW.current)||void 0===t?void 0:null===(e=t.getText)||void 0===e?void 0:e.call(t)},onUpdateValue:e=>{var t;null===(t=eW.current)||void 0===t||t.setText(e)},disabled:n,enableUpload:e_,onAfterSendMessage:tw,isToolButtonSmall:et,activeSkillType:null==eI?void 0:eI.skill_type},tM=(0,i.useMemo)(()=>e_&&eS?eD?[w.N]:tI||et?[C.q]:[C.q,w.N]:[],[e_,eS,tI,eD,et]),tT=(0,i.useMemo)(()=>{if(!e7)return tM;let e=tI?tM:[];return eD&&e.push(C.q,c.C),e.filter((e,t,r)=>r.findIndex(t=>e===t)===t)},[eD,e7,tI,tM]),tR=J({isSamantha:eN,isInGuidance:ex,isNewChatInputInChat:tI,enableScreenshotBtn:e6,uploadButtonShowRight:e7,asrBtnPluginIdentifier:E.V,voiceCallBtnPluginIdentifier:k.s,uploadButtonPluginList:tM,screenshotBtnPluginIdentifier:d.l}),tU=async e=>{let{files:t}=e.clipboardData,r=e.clipboardData.getData("text"),n=r.trim(),i=(0,H.U)(n),a={event:e,trimText:n,text:r,files:t,isValidLink:1===i.length&&i[0].type===H.y.link};await tg.onPasteHandler(a),tv.onPasteHandler(a),await (null==eE?void 0:eE(e))},tj=async e=>{await (null==eC?void 0:eC(e)),tm.onKeyDown()};return(0,ef.jsxs)(ef.Fragment,{children:[eQ&&!eI&&(0,ef.jsx)(q.r,{...eq,spacing:1,children:(0,ef.jsx)("div",{ref:eB,className:"w-full h-0","aria-label":"skill-at-anchor"})}),(0,ef.jsx)(h.X,{className:ee,disabled:n,children:(0,ef.jsx)(R.g,{sendMessageStatus:eT,ref:eZ,responsiveSize:tt,rows:e0,readonly:n,disabled:n,renderRightTools:()=>(0,ef.jsx)(A.mD,{...tx,list:tR}),renderLeftTools:()=>(0,ef.jsx)(A.kb,{small:et,toolButtonProps:tx,list:tT}),onSubmit:tA,onPaste:tU,onAutoTransValue:(e,t)=>{tv.onAutoTransValue(e,t)},onKeyDown:tj,onInput:()=>{tm.onInput()},placeholder:(()=>{if(ey)return ey;if(eN){if(!eO&&n)return eU("homepage_chatbox_diabled_desc");if(ty.getPlaceholder())return ty.getPlaceholder();if(tk.getPlaceholder())return tk.getPlaceholder();else if(!eg)return eU("homepage_centered_input_placeholder");else return e$?eU("default_input_placeholder1"):eU("default_input_placeholder")}return eO||r!==p.z.Bot?eN?eU("default_input_placeholder"):eU("send_message"):eU("homepage_chatbox_diabled_desc")})(),breakBtnHoverText:eU("input_box_stop_generating_tooltip"),renderInputTop:()=>(0,ef.jsxs)(ef.Fragment,{children:[!!eI&&eM&&(0,ef.jsx)("div",{className:"w-full",children:(0,ef.jsx)(ev,{background:"normal",skill:eI,icon:(0,ef.jsx)(U.y,{skill_type:null==eI?void 0:eI.skill_type}),closeEvent:()=>(0,G.trackEvent)("skill_module_close",{...em,upload_collection_way:"",collection_name:"",upload_file_type:"",upload_token_length:""})})}),tr&&(0,ef.jsx)(j.og,{ref:ts,customPresetPrompts:ty.getPresetPrompts(),trackParams:em,...tn})]}),renderRefContent:()=>tp?null:(0,ef.jsx)(N.Mr,{refContents:tc}),allowEmptySubmit:!(0,s.Z)(ti)&&ti.every(e=>(0,D.CR)(e.status)),hasAccessoryArea:!(0,s.Z)(ti),resetAccessoryArea:()=>{tu.onResetAccessoryArea()},onEmptyAt:(e,t)=>{if(eA)return eA();e$&&"/"===t?eJ():eg&&eX(e)},activeSkill:eI,disabledWrapperClick:()=>{if(eP)return eP();e4()},onFocus:()=>{tm.onFocus()},onValueChange:e=>{if(e.length>0){var t;let r=eV.measureTextWidthInTextarea(e),n=null===(t=eW.current)||void 0===t?void 0:t.getTextareaWidth();(0,u.Z)(r)||(0,u.Z)(n)||(e9.current||(te.current=n),e8(r>te.current-10))}else 0===e.length&&e8(!1);z.v.emit("chat.chatInput.valueChanged",e)},...tP,sendBtnSmall:et,sendMessageButtonText:tk.getSendMessageButtonText(),sendMessageHoverText:tk.getSendMessageHoverText()||tP.sendMessageHoverText,onClickBreakButton:()=>{var e;$.k.persist.info({eventName:"local_break_button_click"});let r=(0,g.Sv)(y.useMessageStore.getState(),t);(0,G.trackEvent)("break_message",{...eL.getCanvasTeaParams(),message_id:(null==r?void 0:r.message_id)||"",reply_id:(null==r?void 0:r.reply_id)||"",conversation_id:t||"",section_id:(null==r?void 0:r.section_id)||"",bot_id:eR||"",skill_id:(null==eI?void 0:null===(e=eI.skill_type)||void 0===e?void 0:e.toString())||null,skill_name:(0,B.Nu)(null==eI?void 0:eI.skill_type)||null,click_from:"click_break_message",scene:"chat_enter_bar"}),(0,_.D)(y.useMessageStore,t),(0,b.D)("chatInputStoreService").then(e=>{null==e||e.updateSendMessageStatus(t,f.M.Default)})},clearInputOnSubmit:"dependOnSubmit",onClickDisabledSendButton:()=>{$.k.persist.warning({eventName:"send_button_disabled_click"})},onClickSendButton:()=>{var e;$.k.persist.info({eventName:"send_button_click"}),null===(e=tP.onClickSendButton)||void 0===e||e.call(tP)},onSendBtnWrapperClick:e=>{let{disableToSend:r,breakBtnVisible:n}=e;$.k.persist.info({eventName:"send_and_break_button_click",meta:{is_chat_input:"1",break_btn_visible:n,send_message_status:eT,disable_to_send:r,chat_id:t,skill_type:(null==eI?void 0:eI.skill_type)||"generic"}})}})})]})};class eh extends n.H{focus(){}render(e){return(0,ef.jsx)(em,{...e})}}},212740:function(e,t,r){r.r(t),r.d(t,{CIChatInputPlugin:function(){return g}});var n=r(429996),i=r(87222),a=r(652537),o=r(744787),l=r(636674),s=r(993047);function u(){return Promise.all([r.e("77672"),r.e("58773"),r.e("99590")]).then(r.bind(r,378488))}let d=n.lazy(()=>(0,s.AD)({fn:()=>u()}));var c=r(477041),p=r(12107),f=r(79824);class v{focusOnEditor(){f.f.getState().updateCIEditorFocusedState(!0)}updateEditorValue(e){(0,c.Z)(e)?f.f.getState().updatePromptEditorValue(e):(0,p.dz)(e.data[0])&&f.f.getState().updatePromptEditorValue(e.data[0].text)}clearEditorValue(){this.updateEditorValue("")}}var m=r(627394);function h(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class g extends i.H{focus(){var e;null===(e=this.ref.current)||void 0===e||e.focus()}render(e){return(0,m.jsx)(n.Suspense,{fallback:(0,m.jsx)(o.Y,{}),children:(0,m.jsx)(d,{ref:this.ref,...e,onBeforeSendMessage:async()=>{var t,r;return null===(r=null===(t=e.onBeforeSendMessage)||void 0===t?void 0:t.call(e,{clearRefContent:!1}))||void 0===r||r}})})}preloadChunks(){u()}constructor(...e){super(...e),h(this,"skillType",l.SkillType.CodeInterpreter),h(this,"ref",(0,n.createRef)()),h(this,"service",new v)}}h(g,"pluginName",a.l.CodeInterpreter)},79824:function(e,t,r){r.d(t,{f:function(){return l}});var n=r(613993),i=r(231462),a=r(561200);let o={promptEditorValue:"",guidanceEditorValue:{data:[]},ciEditorFocused:!1},l=(0,i.Ue)()((0,n.XR)(e=>({...o,updatePromptEditorValue:t=>{e((0,a.Uy)(e=>{e.promptEditorValue=t}))},updateGuidanceEditorValue:t=>{e((0,a.Uy)(e=>{e.guidanceEditorValue=t}))},updateCIEditorFocusedState:t=>{e((0,a.Uy)(e=>{e.ciEditorFocused=t}))}})))},947380:function(e,t,r){r.d(t,{e:function(){return o}});var n=r(477041),i=r(106307),a=r(357921);class o{focusOnEditor(){a.mr.getState().updateFocusedState(!0)}updateEditorValue(e){(0,n.Z)(e)?a.mr.getState().updateEditorValue({data:[{type:i.f.Text,text:e}]}):a.mr.getState().updateEditorValue(e)}clearEditorValue(){this.updateEditorValue("")}}},606508:function(e,t,r){r.r(t),r.d(t,{CodingAssistantChatInputPlugin:function(){return v}});var n=r(429996),i=r(87222),a=r(652537),o=r(744787),l=r(636674),s=r(993047);function u(){return Promise.all([r.e("62357"),r.e("92313"),r.e("86466"),r.e("55359"),r.e("62126"),r.e("18383")]).then(r.bind(r,738475))}let d=n.lazy(()=>(0,s.AD)({fn:async()=>{let{CodingAssistantChatInput:e}=await u();return{default:e}}}));var c=r(947380),p=r(627394);function f(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class v extends i.H{focus(){var e;null===(e=this.ref.current)||void 0===e||e.focus()}render(e){return(0,p.jsx)(n.Suspense,{fallback:(0,p.jsx)(o.Y,{}),children:(0,p.jsx)(d,{ref:this.ref,...e})})}preloadChunks(){u()}constructor(...e){super(...e),f(this,"skillType",l.SkillType.CodeAssistant),f(this,"ref",(0,n.createRef)()),f(this,"service",new c.e)}}f(v,"pluginName",a.l.CodeAssistant)},800642:function(e,t,r){r.d(t,{_:function(){return n}});let n="code_agent_mode"},357921:function(e,t,r){r.d(t,{Db:function(){return I},mr:function(){return P}});var n=r(98490),i=r(293067),a=r(869024),o=r(344649),l=r(136389),s=r(901027),u=r(51679),d=r(636674),c=r(644367),p=r(346760);let f=(e,t)=>({previewedCount:0,incrAllowTryPreviewCount:()=>{e({previewedCount:t().previewedCount+1})},checkAllowTryPreview:()=>t().previewedCount<4});var v=r(81192),m=r(910157),h=r(953739);let g=()=>({blockIdToProcess:{},hasOpenCanvasViewInAsyncStreaming:!1,isProcessDataLoading:!1,blockIdToProcessHasInited:{},blockArtifactMetaMap:{},processBlockMetaMap:{},blockArtifactAutoOpenCanvasMap:{}}),y=(e,t)=>(0,l.Z)(g(),{fetchAgentProcessData:async r=>{var n;let{blockId:i,resourceId:a}=r;if(null===(n=t().blockIdToProcessHasInited)||void 0===n?void 0:n[i])return null;try{e((0,s.Uy)(e=>{e.isProcessDataLoading=!0}));let{data:t}=await u.mH.GetDeepResearchResource({resource_id:a}),{blocks:r=[]}=null!=t?t:{},n=r.map(e=>{var t;return{...e,content_obj:(0,m.R)(e.content,{}),id:null!==(t=null==e?void 0:e.block_id)&&void 0!==t?t:"",parent_id:e.parent_block_id}});return e((0,s.Uy)(e=>{e.blockIdToProcess[i]||(e.blockIdToProcess[i]=[]),e.blockIdToProcess[i]=n,e.isProcessDataLoading=!1,e.blockIdToProcessHasInited[i]=!0})),n}catch(t){return e((0,s.Uy)(e=>{e.isProcessDataLoading=!1,e.blockIdToProcessHasInited[i]=!0})),c.k.persist.warning({eventName:"fetch_DeepResearch_process_data_error"}),null}},updateAgentProcessData(t){let{blockId:r,value:n}=t;e((0,s.Uy)(e=>{e.blockIdToProcess[r]||(e.blockIdToProcess[r]=[]),e.blockIdToProcess[r]=n}))},setHasOpenCanvasViewInAsyncStreaming:t=>{e((0,s.Uy)(e=>{e.hasOpenCanvasViewInAsyncStreaming=t}))},updateBlockArtifactMeta:t=>{let{blockId:r,codeFileBlockList:n,isStreaming:i,activeCodeFileBlockId:a}=t;e((0,s.Uy)(e=>{let{blockArtifactMetaMap:t}=e;t[r]={...t[r],codeFileBlockList:n,isStreaming:i,activeCodeFileBlockId:a}}))},updateCodeFileBlockContent:(t,r,n)=>{e((0,s.Uy)(e=>{let{blockArtifactMetaMap:i}=e;if(!t||!i[t])return;let a=i[t].codeFileBlockList.find(e=>{var t;return(null===(t=e.artifactMeta.code)||void 0===t?void 0:t.path)===r});a&&(a.artifactMeta.code.content=n)}))},getBlockArtifactMetaMap:()=>t().blockArtifactMetaMap,setEndBlockArtifactMeta:t=>{e((0,s.Uy)(e=>{let{blockArtifactMetaMap:r}=e;if(!r[t])return;r[t].isStreaming=!1;let{codeFileBlockList:n}=r[t],i=n.map(e=>{let t=(0,v.Z)(e.artifactMeta);return h.$A.endStreaming([t]),{...e,artifactMeta:t}});r[t]={...r[t],codeFileBlockList:i}}))},updateBlockArtifactAutoOpenCanvas:(t,r)=>{e((0,s.Uy)(e=>{e.blockArtifactAutoOpenCanvasMap={...e.blockArtifactAutoOpenCanvasMap,[t]:r}}))},updateProcessBlockMeta:(t,r)=>{e((0,s.Uy)(e=>{e.processBlockMetaMap[t]=r}))},clearBlockArtifactRecord:t=>{e((0,s.Uy)(e=>{delete e.blockArtifactMetaMap[t]}))}});var _=r(913602),S=r(800642);let b=_.yQ.getItem(S._),k={editorValue:{data:[]},focused:!1,supportedCodeFileTypes:[],recommendCodeBasePrompts:[],recommendItems:[],recommendOtherPrompts:[],recommendArtifactsItems:[],recommendArtifactsCategoryItems:[],recommendCodePromptsTemplates:[],githubModalVisible:!1,loading:!1,refKey:"",refInfoMap:{},abResults:{},blockArtifactMap:{},retainedEditorValue:void 0,agentMode:b&&[p.KR.ChatMode,p.KR.DevMode].includes(b)?b:p.KR.DevMode,blockIdMapForClarify:{}},w=e=>({...k,updateEditorValue:t=>{e((0,s.Uy)(e=>{e.editorValue=t}))},updateCurrentPromptTemplate:(t,r)=>{e((0,s.Uy)(e=>{e.currentPromptTemplate=t,e.currentPromptTemplateSource=r}))},updateFocusedState:t=>{e((0,s.Uy)(e=>{e.focused=t}))},fetchRecommendList:async()=>{try{e((0,s.Uy)(e=>{e.loading=!0,e.recommendArtifactsItems=[],e.recommendArtifactsCategoryItems=[],e.recommendCodeBasePrompts=[],e.recommendOtherPrompts=[]}));let{data:t}=await u.mH.SkillPack({skill_type:d.SkillType.CodeAssistant,condition:{code_assistant_condition:{}}});e((0,s.Uy)(e=>{var r,n,i,a,o,l;if(t&&(e.loading=!1),(null==t?void 0:null===(r=t.code_assistant)||void 0===r?void 0:r.codebase_items)&&(e.recommendCodeBasePrompts=null==t?void 0:null===(o=t.code_assistant)||void 0===o?void 0:o.codebase_items),(null==t?void 0:null===(n=t.code_assistant)||void 0===n?void 0:n.query_items)&&(e.recommendOtherPrompts=null==t?void 0:null===(l=t.code_assistant)||void 0===l?void 0:l.query_items),null==t?void 0:null===(i=t.code_assistant)||void 0===i?void 0:i.data)try{let r=JSON.parse(t.code_assistant.data);e.recommendCodeBasePrompts=r.codebase_templates.codebase_items,e.recommendItems=r.recommendations.recommendation_items,e.recommendArtifactsCategoryItems=r.artifacts_category_templates.artifacts_category_items,e.recommendOtherPrompts=[]}catch(e){}if(null==t?void 0:null===(a=t.code_assistant)||void 0===a?void 0:a.template)try{let r=JSON.parse(t.code_assistant.template);e.recommendCodePromptsTemplates=r.prompt_list}catch(e){}}))}catch(e){c.k.persist.warning({eventName:"init_code_recommend_error",error:e})}},toggleGithubModalVisible:function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;e((0,s.Uy)(e=>{e.githubModalVisible=t,r&&(e.githubModalEnterMethod=r)}))},updateRefRangeInfo:(t,r)=>{e((0,s.Uy)(e=>{e.refKey=t,e.refInfoMap={[t]:{...e.refInfoMap[t],...r}}}))},clearRefRangeInfo:()=>{e((0,s.Uy)(e=>{e.refInfoMap={[e.refKey]:{...e.refInfoMap[e.refKey],rangeStart:void 0,rangeEnd:void 0}}}))},updateAbResults:t=>{e((0,s.Uy)(e=>{e.abResults={...e.abResults,...t}}))},updateBlockArtifact:t=>{let{type:r,blockId:n,value:i}=t;e((0,s.Uy)(e=>{let{blockArtifactMap:t}=e;t||(t={}),r===p.P$.Status?t[n]={...t[n],status:i}:t[n]={...t[n],data:i}}))},setRetainedData:t=>{e((0,s.Uy)(e=>{(null==t?void 0:t.retainedEditorValue)&&(e.retainedEditorValue=null==t?void 0:t.retainedEditorValue)}))},updateAgentMode:t=>{e((0,s.Uy)(e=>{e.agentMode=t})),o.Z.setMode(t)},addBlockIdMapForClarify:(t,r)=>{e((0,s.Uy)(e=>{e.blockIdMapForClarify[t]=r}))}}),C=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,l.Z)(w(...t),f(...t),y(...t))},E=e=>{try{return{previewedCount:e.previewedCount,retainedEditorValue:e.retainedEditorValue}}catch(e){return c.k.persist.error({message:"[@Coding-skill-store] persist state limit error",error:e instanceof Error?e:Error(String(e))}),{}}},A=e=>{let{prefix:t,isEnableDebug:r,reduxDevToolsSnapshot:o,merge:l,partialize:s,storage:u}=e,d=(0,a.C1)({name:"coding-skill-store",prefix:t||"default",version:1.5,storage:u,partialize:null!=s?s:E,merge:l}),c=(0,n.tJ)((0,n.XR)(C),d);return r&&o?(0,i.Ue)()((0,n.mW)(c,{name:`${t}-chat-input-store`})):(0,i.Ue)()(c)},P=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let{_useCodingSkillStore:n}=P.prototype;if(n)return n(...t);throw Error("useCodingSkillStore is not initialized")};function I(e){let{_useCodingSkillStore:t}=P.prototype||{};if(!t){let t=A({...e});Object.setPrototypeOf(P.prototype,t),Object.defineProperties(P,{...Object.getOwnPropertyDescriptors(t)}),P.prototype._useCodingSkillStore=t}o.Z.initialize()}},346760:function(e,t,r){var n,i,a;r.d(t,{KR:function(){return s},P$:function(){return l},Wu:function(){return o}});let o=((n={})[n.None=0]="None",n[n.CodeGenerate=1]="CodeGenerate",n[n.CodeDebug=2]="CodeDebug",n[n.CodeKnowledge=3]="CodeKnowledge",n[n.CodeBase=4]="CodeBase",n[n.CodeArtifacts=5]="CodeArtifacts",n[n.DocLink=7]="DocLink",n),l=((i={}).Status="status",i.Artifact="artifact",i.ArtifactMeta="artifact_meta",i.ArtifactCodeFile="artifact_code_file",i),s=((a={}).DevMode="dev_mode",a.ChatMode="chat_mode",a.InstructionOpt="instruction_opt",a)},173249:function(e,t,r){var n,i;r.d(t,{d:function(){return o},p:function(){return a}});let a=((n={}).FILE="FILE",n.DIR="DIR",n.REPO="REPO",n.DATA_ANALYSIS="DATA_ANALYSIS",n.IMAGE="IMAGE",n),o=((i={})[i.Start=1]="Start",i[i.Finish=2]="Finish",i[i.Updated=3]="Updated",i[i.Rollbacked=4]="Rollbacked",i)},344649:function(e,t,r){var n=r(637224),i=r(913602),a=r(346760),o=r(800642);function l(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class s{get(e){return a.KR.ChatMode}set(e,t){}initialize(e){arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.KR.ChatMode}}class u{get(e){return i.Ie.getItem(e)||i.yQ.getItem(e)}set(e,t){i.yQ.setItem(e,t),i.Ie.setItem(e,t)}initialize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.KR.DevMode,r=i.Ie.getItem(e),n=i.yQ.getItem(e);if(!r){let r=n||t;i.Ie.setItem(e,r),n||i.yQ.setItem(e,r)}}}let d=()=>(0,n.fH)()?new u:new s,c=new class{getDefaultMode(){return(0,n.fH)()?a.KR.DevMode:a.KR.ChatMode}isValidMode(e){return[a.KR.ChatMode,a.KR.DevMode].includes(e)}setMode(e){this.isValidMode(e)&&this.strategy.set(this.key,e)}getCurrentMode(){let e=this.strategy.get(this.key);return this.isValidMode(e)?e:null}initialize(){let e=this.getDefaultMode();this.strategy.initialize(this.key,e)}constructor(){l(this,"strategy",void 0),l(this,"key",o._),this.strategy=d()}};t.Z=c},953739:function(e,t,r){r.d(t,{$A:function(){return p},NZ:function(){return d},a$:function(){return f},qR:function(){return c}});var n=r(148824),i=r(228535),a=r(414817),o=r(205379),l=r(182663),s=r(644367),u=r(173249);let d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{isFinished:r,isSourceShare:n,isLocal:i}=t,{offset:a,title:o="",intention:l,identifier:s,artifact_id:d,artifact_key:c,artifact_type:p,version:f,create_time:v,resource_id:m,resource_type:h,resource_version:g,status:y,code:_,is_entry:S}=null!=e?e:{};return{title:o,code:_,language:null==_?void 0:_.language,version:f,status:y,isStreaming:y===u.d.Start&&!r,isSourceShare:n,isLocal:i,offset:a,intention:l,identifier:s,isEntry:S,artifactId:d,artifactKey:c,createTime:v,resourceId:m,resourceType:h,resourceVersion:g,artifactType:p}},c=e=>{var t,r,l,u,c,p,f;let v=[];(null==e?void 0:null===(t=e.content_obj)||void 0===t?void 0:t.artifact_meta)&&(v=Array.isArray(null==e?void 0:null===(u=e.content_obj)||void 0===u?void 0:u.artifact_meta)?null==e?void 0:null===(c=e.content_obj)||void 0===c?void 0:c.artifact_meta:[null==e?void 0:null===(p=e.content_obj)||void 0===p?void 0:p.artifact_meta]),(null==e?void 0:null===(r=e.ext)||void 0===r?void 0:r.samantha_artifact_meta_list)&&(v=JSON.parse(null==e?void 0:null===(f=e.ext)||void 0===f?void 0:f.samantha_artifact_meta_list));let m=(0,n.zu)(e),h=(0,i.F3w)(e),g=(0,a.H)(e)||!!((null==e?void 0:e.conversation_id)&&(0,o.zU)(e.conversation_id));return Array.isArray(v)?null==v?void 0:null===(l=v.map)||void 0===l?void 0:l.call(v,e=>d(e,{isFinished:m,isSourceShare:h,isLocal:g})):(s.k.persist.error({eventName:"artifactMetaList is not array",error:Error(JSON.stringify(e))}),[])},p={startStreaming(e){let t=e.find(e=>{var t;return(null===(t=e.code)||void 0===t?void 0:t.node_id)==="root"});t&&(t.isStreaming=!0)},beforeCreateArtifactMeta(e){e.forEach(e=>{var t;(null===(t=e.code)||void 0===t?void 0:t.node_id)!=="root"&&(e.isStreaming=!1)})},endStreaming(e){e.forEach(e=>{e.isStreaming=!1,e.isFetched=!0})}};function f(e){return e.some(e=>(null==e?void 0:e.review_status)===l.VP.Reject)}},43037:function(e,t,r){r.r(t),r.d(t,{ExerciseChatInputPlugin:function(){return y}});var n=r(429996),i=r(87222),a=r(652537),o=r(744787),l=r(636674),s=r(993047);function u(){return Promise.all([r.e("40588"),r.e("49651")]).then(r.bind(r,761143))}let d=n.lazy(()=>(0,s.AD)({fn:()=>u()}));var c=r(477041),p=r(106307),f=r(12107),v=r(126905);class m{focusOnEditor(){v.h.getState().updateFocusedState(!0)}updateEditorValue(e){(0,c.Z)(e)?v.h.getState().updateEditorValue({data:[{type:p.f.Text,text:e}]}):(0,f.dz)(e.data[0])&&v.h.getState().updateEditorValue(e)}clearEditorValue(){this.updateEditorValue("")}}var h=r(627394);function g(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class y extends i.H{focus(){}render(e){return(0,h.jsx)(n.Suspense,{fallback:(0,h.jsx)(o.Y,{}),children:(0,h.jsx)(d,{ref:this.ref,...e})})}preloadChunks(){u()}constructor(...e){super(...e),g(this,"skillType",l.SkillType.ExerciseAssistant),g(this,"ref",(0,n.createRef)()),g(this,"service",new m)}}g(y,"pluginName",a.l.EduExerciseAssistant)},126905:function(e,t,r){r.d(t,{h:function(){return l}});var n=r(613993),i=r(231462),a=r(561200);let o={editorValue:{data:[]},focused:!1},l=(0,i.Ue)()((0,n.XR)(e=>({...o,updateEditorValue:t=>{e((0,a.Uy)(e=>{e.editorValue=t}))},updateFocusedState:t=>{e((0,a.Uy)(e=>{e.focused=t}))}})))},486456:function(e,t,r){r.d(t,{y:function(){return o}});var n=r(537065);function i(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class a extends n.v{constructor(...e){super(...e),i(this,"editorRef",null),i(this,"bindImageEditorRef",e=>{this.editorRef=e}),i(this,"unbindImageEditorRef",()=>{this.editorRef=null}),i(this,"focusOnImageEditor",()=>{this.editorRef&&this.editorRef.focus()}),i(this,"getEditorValue",()=>{var e,t;if(this.editorRef)return null===(t=this.editorRef)||void 0===t?void 0:null===(e=t.getValue)||void 0===e?void 0:e.call(t)}),i(this,"setEditorValue",e=>{var t,r;null===(r=this.editorRef)||void 0===r||null===(t=r.setValue)||void 0===t||t.call(r,e)}),i(this,"getImageEditorValue",()=>{if(this.editorRef)return this.editorRef.getValue()}),i(this,"getImageEditorRefIsReady",()=>+!!this.editorRef)}}let o=new a},570287:function(e,t,r){r.r(t),r.d(t,{ImageCreationChatInputPlugin:function(){return y}});var n=r(429996),i=r(87222),a=r(652537),o=r(744787),l=r(636674),s=r(993047);function u(){return Promise.all([r.e("86466"),r.e("83942"),r.e("45281")]).then(r.bind(r,774165))}let d=n.lazy(()=>(0,s.AD)({fn:()=>u()}));var c=r(477041),p=r(106307),f=r(103462),v=r(486456);class m{focusOnEditor(){v.y.focusOnImageEditor()}updateEditorValue(e){(0,c.Z)(e)?(0,f.W5)().getState().updateEditorValue({data:[{type:p.f.Text,text:e}]}):(0,f.W5)().getState().updateEditorValue(e)}clearEditorValue(){this.updateEditorValue("")}getInputOptionsMap(){let{inputOptionsMap:e}=(0,f.W5)().getState();return e}initImageList(){let{initImageList:e}=(0,f.W5)().getState();e()}}var h=r(627394);function g(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class y extends i.H{focus(){var e;null===(e=this.ref.current)||void 0===e||e.focus()}render(e){return(0,h.jsx)(n.Suspense,{fallback:(0,h.jsx)(o.Y,{}),children:(0,h.jsx)(d,{ref:this.ref,...e})})}preloadChunks(){u()}constructor(...e){super(...e),g(this,"skillType",l.SkillType.ImageGeneration),g(this,"ref",(0,n.createRef)()),g(this,"service",new m)}}g(y,"pluginName",a.l.ImageGeneration)},103462:function(e,t,r){r.d(t,{W5:function(){return h},f3:function(){return g}});var n=r(613993),i=r(231462),a=r(869024),o=r(447269),l=r(81192),s=r(561200),u=r(51679),d=r(636674),c=r(644367);let p={editorValue:{data:[]},categoryName:"",hasSelectedCategory:!1,loading:!1,templateArr:[],inputOptionsMap:{},paginator:{has_more:!0,total:0,next_cursor:""},imageList:[],mockImageList:[...[,,,,].fill([{default_image:{height:580,width:386}},{default_image:{height:580,width:580}},{default_image:{height:768,width:1024}}]).flat()],simpleImageList:[]},f=(e,t)=>({...p,updateEditorValue:t=>{e((0,s.Uy)(e=>{e.editorValue=t}))},updateCategoryName:t=>{e((0,s.Uy)(e=>{e.categoryName=t}))},updateHasSelectedCategory:t=>{e((0,s.Uy)(e=>{e.hasSelectedCategory=t}))},initImageList:()=>{t().fetchImageList(!0,0)},fetchImageList:async(r,n,i,a)=>{var p;if((r||(null===(p=t().paginator)||void 0===p?void 0:p.has_more)!==!1)&&!t().loading)try{e((0,s.Uy)(e=>{e.loading=!0,r&&(e.paginator={has_more:!0,total:0,next_cursor:""},e.imageList=[],e.simpleImageList=[])}));let{data:t}=await u.mH.SkillPack({skill_type:d.SkillType.ImageGeneration,condition:{cursor:a,image_condition:{category_id:n,seed:i}}});e((0,s.Uy)(e=>{var n,i,a,s,u,d,c,p,f,v,m,h,g,y,_,S,b,k,w;if(t&&(e.loading=!1),(null==t?void 0:null===(i=t.image)||void 0===i?void 0:null===(n=i.meta)||void 0===n?void 0:n.category_list)&&(e.templateArr=null==t?void 0:null===(g=t.image)||void 0===g?void 0:null===(h=g.meta)||void 0===h?void 0:h.category_list),null==t?void 0:null===(s=t.image)||void 0===s?void 0:null===(a=s.meta)||void 0===a?void 0:a.option_list){let r=(0,o.Z)(null==t?void 0:null===(_=t.image)||void 0===_?void 0:null===(y=_.meta)||void 0===y?void 0:y.option_list,(e,t)=>({...e,[String(t.value)]:{...t}}),{});e.inputOptionsMap=r}let C=(r?[]:(0,l.Z)(e.imageList)).concat(null!==(S=null==t?void 0:null===(d=t.image)||void 0===d?void 0:null===(u=d.template)||void 0===u?void 0:u.image_list)&&void 0!==S?S:[]);e.imageList=C,b={...null==t?void 0:null===(p=t.image)||void 0===p?void 0:null===(c=p.template)||void 0===c?void 0:c.paginator},e.paginator=void 0!==b?b:{},e.seed=null!==(k=null==t?void 0:null===(v=t.image)||void 0===v?void 0:null===(f=v.template)||void 0===f?void 0:f.seed)&&void 0!==k?k:"",e.simpleImageList=null!==(w=null==t?void 0:null===(m=t.image)||void 0===m?void 0:m.simple_template)&&void 0!==w?w:[]}))}catch(e){c.k.persist.warning({eventName:"init_image_list_error"})}}}),v=e=>{try{return{templateArr:e.templateArr,inputOptionsMap:e.inputOptionsMap,imageList:e.imageList}}catch(e){return c.k.persist.error({message:"[@image-skill-store] persist state limit error",error:e instanceof Error?e:Error(String(e))}),{}}},m=e=>{let{isEnableDebug:t,reduxDevToolsSnapshot:r,merge:o,partialize:l,storage:s}=e,u=(0,a.C1)({name:"image-skill-store",prefix:"samantha-web",storage:s,partialize:null!=l?l:v,version:1.5,merge:o}),d=(0,n.tJ)((0,n.XR)(f),u);return t&&r?(0,i.Ue)()((0,n.mW)(d,{name:"samantha-web-image-skill-store"})):(0,i.Ue)()(d)},h=()=>(y(),g),g=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];y();let{_useImageSkillStore:n}=g.prototype;if(n)return n(...t);throw Error("useImageSkillStore is not initialized")};function y(){let{_useImageSkillStore:e}=g.prototype||{};if(!e){let e=m({});Object.setPrototypeOf(g.prototype,e),Object.defineProperties(g,{...Object.getOwnPropertyDescriptors(e)}),g.prototype._useImageSkillStore=e}}},971330:function(e,t,r){r.r(t),r.d(t,{MusicAssistantChatInputPlugin:function(){return g}});var n=r(429996),i=r(87222),a=r(652537),o=r(744787),l=r(636674),s=r(993047);function u(){return r.e("87052").then(r.bind(r,769405))}let d=n.lazy(()=>(0,s.AD)({fn:()=>u()}));var c=r(477041),p=r(106307),f=r(813490);class v{focusOnEditor(){f.t.getState().updateFocusedState(!0)}updateEditorValue(e){(0,c.Z)(e)?f.t.getState().updateEditorValue({data:[{type:p.f.Text,text:e}]}):f.t.getState().updateEditorValue(e)}clearEditorValue(){this.updateEditorValue("")}}var m=r(627394);function h(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class g extends i.H{focus(){var e;null===(e=this.ref.current)||void 0===e||e.focus()}render(e){return(0,m.jsx)(n.Suspense,{fallback:(0,m.jsx)(o.Y,{}),children:(0,m.jsx)(d,{ref:this.ref,...e})})}preloadChunks(){u()}constructor(...e){super(...e),h(this,"skillType",l.SkillType.MusicAssistant),h(this,"ref",(0,n.createRef)()),h(this,"service",new v)}}h(g,"pluginName",a.l.MusicAssistant)},813490:function(e,t,r){r.d(t,{t:function(){return d}});var n=r(613993),i=r(231462),a=r(561200),o=r(636674),l=r(51679);let s={loading:!1},u={packInputConfig:{cursor:0,limit:100,inputConfig:null},editorValue:{data:[]},mood:"",lyric:"",genre:"",focused:!1},d=(0,i.Ue)()((0,n.XR)((e,t)=>({...u,resetStoreEditorValue:()=>{e((0,a.Uy)(e=>{e.editorValue=u.editorValue,e.focused=u.focused,e.genre=u.genre,e.lyric=u.lyric,e.mood=u.mood}))},initPackInputConfig(){let{packInputConfig:e,loadMorePackInputConfig:r}=t();e.inputConfig||r()},loadMorePackInputConfig:()=>{if(s.loading)return;s.loading=!0;let{packInputConfig:r}=t();l.mH.SkillPack({skill_type:o.SkillType.MusicAssistant,condition:{cursor:String(r.cursor),limit:r.limit}}).then(t=>{var r,n,i;(null===(r=t.data)||void 0===r?void 0:r.music)&&(null===(i=t.data)||void 0===i?void 0:null===(n=i.music)||void 0===n?void 0:n.meta)&&e((0,a.Uy)(e=>{var r,n,i,a,o,l,s,u,d;e.packInputConfig.inputConfig={input_options:((null===(i=t.data)||void 0===i?void 0:null===(n=i.music)||void 0===n?void 0:null===(r=n.meta)||void 0===r?void 0:r.option_list)||[]).reduce((e,t)=>{let{value:r,...n}=t;return r&&(e[r]=n),e},{}),template:{music_list:(null===(l=t.data)||void 0===l?void 0:null===(o=l.music)||void 0===o?void 0:null===(a=o.template)||void 0===a?void 0:a.music_list)||[]},value:(null===(d=t.data)||void 0===d?void 0:null===(u=d.music)||void 0===u?void 0:null===(s=u.meta)||void 0===s?void 0:s.prompt)||""}}))}).finally(()=>{s.loading=!1})},updateEditorValue:t=>{e((0,a.Uy)(e=>{e.editorValue=t}))},updateMusicMood:t=>{e((0,a.Uy)(e=>{e.mood=t}))},updateMusicGenre:t=>{e((0,a.Uy)(e=>{e.genre=t}))},updateMusicLyric:t=>{e((0,a.Uy)(e=>{e.lyric=t}))},updateFocusedState:t=>{e((0,a.Uy)(e=>{e.focused=t}))}})))},297555:function(e,t,r){r.d(t,{y:function(){return i}});var n=r(754502);class i{focusOnEditor(){n.zm.getState().updateFocusedState(!0)}updateEditorValue(){}clearEditorValue(){}}},302073:function(e,t,r){r.r(t),r.d(t,{PptCreationChatInputPlugin:function(){return v}});var n=r(429996),i=r(87222),a=r(652537),o=r(744787),l=r(636674),s=r(993047);function u(){return r.e("59486").then(r.bind(r,772938))}let d=n.lazy(()=>(0,s.AD)({fn:()=>u()}));var c=r(297555),p=r(627394);function f(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class v extends i.H{focus(){var e;null===(e=this.ref.current)||void 0===e||e.focus()}render(e){return(0,p.jsx)(n.Suspense,{fallback:(0,p.jsx)(o.Y,{}),children:(0,p.jsx)(d,{ref:this.ref,...e})})}preloadChunks(){u()}constructor(...e){super(...e),f(this,"skillType",l.SkillType.AiPPT),f(this,"ref",(0,n.createRef)()),f(this,"service",new c.y)}}f(v,"pluginName",a.l.AiPpt)},754502:function(e,t,r){r.d(t,{zm:function(){return d}});var n=r(613993),i=r(231462),a=r(561200),o=r(51679),l=r(636674),s=r(644367);let u={editorValue:"",focused:!1,cardList:[],isWriteConfigInited:!1,isWriteConfigLoading:!1,writeConfig:{},tagList:[],styleList:[],templatePage:1,templateList:[],hasMore:!0,loading:!1,showSkeleton:!0},d=(0,i.Ue)()((0,n.XR)((e,t)=>({...u,updateFocusedState:t=>{e((0,a.Uy)(e=>{e.focused=t}))},fetchCardList:async()=>{try{let{data:t}=await o.mH.SkillPack({skill_type:l.SkillType.AiPPT});e((0,a.Uy)(e=>{if(t){var r;e.cardList=(null===(r=t.ai_ppt)||void 0===r?void 0:r.items)||[]}}))}catch(e){s.k.persist.warning({eventName:"init_ppt_list_error"})}},fetchWriteConfig:async()=>{if(!t().isWriteConfigLoading&&!t().isWriteConfigInited)try{e((0,a.Uy)(e=>{e.isWriteConfigLoading=!0,e.isWriteConfigInited=!1}));let{data:t}=await o.mH.SkillPack({skill_type:l.SkillType.WriteAssistant,condition:{}});e((0,a.Uy)(e=>{(null==t?void 0:t.write)?(e.isWriteConfigLoading=!1,e.isWriteConfigInited=!0,e.writeConfig=t.write):e.isWriteConfigLoading=!1}))}catch(e){s.k.persist.warning({eventName:"init_ppt_config_error"})}},fetchTemplateList:async(r,n,i,l)=>{if((n||t().hasMore)&&!t().loading)try{e((0,a.Uy)(e=>{e.loading=!0,n&&(e.templatePage=1,e.templateList=[],e.hasMore=!0,e.showSkeleton=!0)}));let{data:s}=await o.mH.GetAiPPTTemplateList({selected_tag_id:i,selected_style_id:l,page:n?1:t().templatePage,size:10,is_doubao_exclusive:r});e((0,a.Uy)(e=>{if(s){var r,n,i;e.loading=!1,e.showSkeleton=!1,e.hasMore=null===(i=s.has_more)||void 0===i||i,e.templatePage=t().templatePage+1,s.tags&&(null===(r=s.tags)||void 0===r?void 0:r.length)>0&&(e.tagList=s.tags),s.styles&&(null===(n=s.styles)||void 0===n?void 0:n.length)>0&&(e.styleList=s.styles),s.detail_list&&(e.templateList=[...e.templateList,...s.detail_list])}}))}catch(t){e((0,a.Uy)(e=>{e.loading=!1,e.showSkeleton=!1})),s.k.persist.warning({eventName:"fetch_ppt_template_error"})}}})))},720396:function(e,t,r){r.d(t,{D:function(){return o}});var n=r(477041),i=r(12107),a=r(826953);class o{focusOnEditor(){a.X.getState().updateReadDocEditorFocusedState(!0)}updateEditorValue(e){(0,n.Z)(e)?a.X.getState().updatePromptEditorValue(e):(0,i.dz)(e.data[0])&&a.X.getState().updatePromptEditorValue(e.data[0].text)}clearEditorValue(){this.updateEditorValue("")}}},330710:function(e,t,r){r.r(t),r.d(t,{ReadUrlChatInput:function(){return W},default:function(){return Z}});var n=r(429996),i=r(475666),a=r(474227),o=r(669160),l=r.n(o),s=r(156217),u=r(35397),d=r(323015),c=r(567134),p=r(568218),f=r(93708),v=r(15348),m=r(994185),h=r(380041),g=r(362318),y=r(736026),_=r(147333),S=r(190831),b=r(308691),k=r(276971),w=r(689337),C=r(685955),E=r(517410),A=r(12107),P=r(790349),I=r(432626),x=r(636674),M=r(436450),T=r(577831),R=r(743567),U=r(222334),j=r(627394);let N=e=>{let{textAreaProps:t,onFocus:r,onBlur:i,onBindEditorContainer:a,onUnmount:o}=e,s=(0,I.g1)(),u=(0,n.useRef)(null);return(0,n.useEffect)(()=>(u.current&&(null==a||a(u.current)),()=>{null==o||o()}),[]),(0,j.jsx)(U.N,{style:{position:"relative",padding:0,alignSelf:"center"},ref:u,...t,className:l()("border-0 px-0","text-area-ny1xIk"),autosize:!0,placeholder:s("landing_creation_inputmessage_url"),autoComplete:"off",rows:1,onFocus:r,onBlur:i})};var D=r(505315),O=r(826953),V=r(180967),L={"read-inner":"read-inner-kSFzvx","read-content":"read-content-DvN3S9",footer:"footer-jepDVl",small:"small-KhEqnq",input:"input-Dn6c6N",editor:"editor-pqs4D2"};let F="read-url-send-msg-button",W=(0,n.forwardRef)(function(e,t){var r;let{skill:o,disabled:U,trackParams:W,reportParams:Z,isToolButtonSmall:z,className:B,showHeader:G,onKeyDown:K,onBeforeSendMessage:H,onAfterSendMessage:Q,debouncedReportFocus:X,removeRefContentEvent:q}=e,$=(0,b.Es)(),J=(0,I.g1)(),{sendMessage:Y}=(0,s.GL)("chatMessageService"),ee=(0,f.sQ)("chatViewCoreStore",e=>{var t;return null===(t=e.currentChatViewConfig)||void 0===t?void 0:t.chatId}),et=null==o?void 0:null===(r=o.skill_type)||void 0===r?void 0:r.toString(),er=(0,k.y)({sm:419,md:899}),en=(0,V.hk)(),ei=O.X.getState().updateUrlEditorValue,ea=(0,A.Z6)(en.data).trim(),eo=(0,s.GL)("chatTeaService"),el=(0,n.useRef)(null),[es,eu]=(0,n.useState)(""),ed=(0,S.UC)(ee||""),ec=((null==ed?void 0:ed.channel)===`skill_${et}`?ed.refContents:[])[0],ep=(0,V.h2)();(0,n.useEffect)(()=>{var e,t;ep?null===(e=el.current)||void 0===e||e.focus():null===(t=el.current)||void 0===t||t.blur()},[ep]);let ef=(0,n.useCallback)(e=>{el.current=e,e&&O.X.getState().updateReadUrlEditorFocusedState(!0)},[]),ev=()=>{let e={data:en.data.map(e=>(0,i.Z)(e,e=>void 0!==e))};if((0,a.Z)(e,(0,D.n)(J))){var t,r;null===(r=el.current)||void 0===r||r.focus({toIndex:(null===(t=(0,D.n)(J).data[0])||void 0===t?void 0:t.text.length)+1||0})}},em=e=>{eu(""),ei((0,D.vQ)()),null==eo||eo.trackEvent("skill_module_click_arrow",{...W,prompts_content:e,upload_way:"input link",collection_id:(0,D.rw)(e),upload_collection_way:"",collection_name:"",upload_file_type:"",upload_token_length:""})},eh=e=>{let t=(0,D.rw)(e);if(ee&&et){if(t){let e=[{type:"link",link:t}];(0,v.D)("refContentStoreService").then(t=>{null==t||t.setRefContents({refContents:e,channel:`skill_${et}`},ee)})}else ei((0,D.n)(J)),ev()}},eg=async e=>{var t;if(await (null==H?void 0:H())!==!1)return await Y([{text:e,reportParams:{scene:"chat_action_bar",sec_scene:(0,w.lx)(null==o?void 0:o.skill_type),...Z},extraExt:{input_skill:JSON.stringify({skill_id:null==o?void 0:null===(t=o.skill_type)||void 0===t?void 0:t.toString(),skill_type:null==o?void 0:o.skill_type})}}]),em(e),eh(e),null==Q||Q(),!0},ey=async e=>{var t;await (null==H?void 0:H())!==!1&&(await Y([{text:e,reportParams:{scene:"chat_action_bar",sec_scene:(0,w.lx)(null==o?void 0:o.skill_type),...(0,C.N)(ec),...Z},extraExt:{input_skill:JSON.stringify({skill_id:null==o?void 0:null===(t=o.skill_type)||void 0===t?void 0:t.toString(),skill_type:null==o?void 0:o.skill_type})}}]),em(e),null==Q||Q())};(0,n.useImperativeHandle)(t,()=>({focus:()=>{var e,t;return null===(t=el.current)||void 0===t?void 0:null===(e=t.focus)||void 0===e?void 0:e.call(t)}}),[]),(0,n.useEffect)(()=>{ei((0,D.n)(J)),null==eo||eo.trackEvent("skill_module_show",{...W,origin_content_type:"message"})},[]),(0,n.useEffect)(()=>{document.querySelector(`.${F}`)&&(0,v.D)("chatInputStoreService").then(e=>{var t;null==e||null===(t=e.getSkillReportEvent({skillType:x.SkillType.ReadWebsite,eventName:"skill_bar_open_input"}))||void 0===t||t.success()})},[]),(0,n.useEffect)(()=>{ev()},[el.current]);let e_=()=>{null==eo||eo.trackEvent("skill_module_close",{...W,prompts_content:ea||es,upload_way:"input link",collection_id:(null==ec?void 0:ec.type)==="link"?ec.link:void 0,upload_collection_way:"",collection_name:"",upload_file_type:"",upload_token_length:""})},eS=!U&&!!ea&&(0,g.W)(ea),eb=!U&&!!es.trim(),ek=(0,M.Vr)(ec&&ea||"",!0);return(0,j.jsx)(u.X,{className:B,disabled:U,children:(0,j.jsxs)("div",{className:l()(L["read-inner"]),children:[(null!=G?G:!$)&&(0,j.jsx)(d.SkillHeader,{background:"gray",skill:o,icon:(0,j.jsx)(y.y,{skill_type:x.SkillType.ReadWebsite}),closeEvent:e_,afterTitle:ec&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(E.f,{}),(0,j.jsx)(_.Mr,{inline:!0,refContents:[ec],removeRefContentEvent:q,onClickCloseButton:()=>{eu(""),ei((0,D.n)(J))}})]})}),(0,j.jsx)("div",{className:L["read-content"],children:(0,j.jsxs)("div",{className:l()(L.footer,"sm"===er&&L.small),children:[ec?(0,j.jsx)(N,{onFocus:()=>null==X?void 0:X(ec),textAreaProps:{value:es,onChange:e=>{eu(e)},onKeyDown:e=>{(0,c.P)(e)&&((0,T.KX)()||e.preventDefault(),eb&&ey(es.trim()))}}}):(0,j.jsx)("div",{className:L.input,onKeyDown:e=>{"Escape"!==e.key||e.shiftKey||e.altKey||e_()},children:(0,j.jsx)(P.f,{ref:ef,className:L.editor,dir:(0,R.d)()?ek:"ltr",disabled:U,value:en,onChange:e=>ei(e),onKeyDown:async e=>{await (null==K?void 0:K(e)),(0,c.P)(e)&&((0,T.KX)()||e.preventDefault(),eS&&eg(ea))},placeholder:J("landing_emptymessage_url"),autoComplete:"off",onFocus:()=>{null==X||X(ec),O.X.getState().updateReadDocEditorFocusedState(!0)},onBlur:()=>{O.X.getState().updateReadDocEditorFocusedState(!1)}})}),(0,j.jsx)(p.b,{small:z,sendMessageClassName:F,disableToSend:!eS&&!eb,onClickSendButton:()=>{eS?eg(ea):eb&&ey(es.trim())},beforeNodes:(0,j.jsx)(h.mD,{list:[m.V],type:"editor",isToolButtonSmall:z,getValue:()=>en,onUpdateValue:e=>{ei(e)}})})]})})]})})});var Z=W},180967:function(e,t,r){r.d(t,{Bw:function(){return u},h2:function(){return d},hk:function(){return o},Zd:function(){return c},gT:function(){return p},Ft:function(){return s},zO:function(){return l}});var n=r(344482),i=r(826953);let a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.X,r=function(){for(var r=arguments.length,n=Array(r),a=0;a<r;a++)n[a]=arguments[a];return(0,i.X)(t=>e(t,...n),t)};return r.raw=e,r},o=a(e=>e.urlEditorValue);a(e=>e.linkEditorValue);let l=a(e=>e.promptEditorValue),s=a(e=>e.guidanceEditorValue),u=a(e=>e.readDocEditorFocused),d=a(e=>e.readUrlEditorFocused),c=a(e=>e.latestRead),p=a(e=>e.latestReadInitiated)},737480:function(e,t,r){r.r(t),r.d(t,{ReadDocChatInputPlugin:function(){return v}});var n=r(429996),i=r(87222),a=r(652537),o=r(744787),l=r(636674),s=r(720396),u=r(993047);function d(){return Promise.all([r.e("77672"),r.e("58773"),r.e("99590")]).then(r.bind(r,302324))}let c=n.lazy(()=>(0,u.AD)({fn:()=>d()}));var p=r(627394);function f(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class v extends i.H{focus(){var e;null===(e=this.ref.current)||void 0===e||e.focus()}render(e){return(0,p.jsx)(n.Suspense,{fallback:(0,p.jsx)(o.Y,{}),children:(0,p.jsx)(c,{ref:this.ref,...e,onBeforeSendMessage:async()=>{var t,r;return null===(r=null===(t=e.onBeforeSendMessage)||void 0===t?void 0:t.call(e,{clearRefContent:!1}))||void 0===r||r}})})}preloadChunks(){d()}constructor(...e){super(...e),f(this,"skillType",l.SkillType.ReadPDF),f(this,"ref",(0,n.createRef)()),f(this,"service",new s.D)}}f(v,"pluginName",a.l.ReadPDF)},34696:function(e,t,r){r.r(t),r.d(t,{ReadUrlChatInputPlugin:function(){return m}});var n=r(429996),i=r(87222),a=r(652537),o=r(744787),l=r(636674),s=r(477041),u=r(106307),d=r(826953);class c{focusOnEditor(){d.X.getState().updateReadUrlEditorFocusedState(!0)}updateEditorValue(e){(0,s.Z)(e)?d.X.getState().updateUrlEditorValue({data:[{type:u.f.Text,text:e}]}):d.X.getState().updateUrlEditorValue(e)}clearEditorValue(){this.updateEditorValue("")}}var p=r(330710),f=r(627394);function v(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class m extends i.H{focus(){var e;null===(e=this.ref.current)||void 0===e||e.focus()}render(e){return(0,f.jsx)(n.Suspense,{fallback:(0,f.jsx)(o.Y,{}),children:(0,f.jsx)(p.default,{ref:this.ref,...e})})}preloadChunks(){Promise.resolve().then(r.bind(r,330710))}constructor(...e){super(...e),v(this,"skillType",l.SkillType.ReadWebsite),v(this,"ref",(0,n.createRef)()),v(this,"service",new c)}}v(m,"pluginName",a.l.ReadWebsite)},826953:function(e,t,r){r.d(t,{X:function(){return s},o:function(){return u}});var n=r(613993),i=r(231462),a=r(561200);let o={urlEditorValue:{data:[]},linkEditorValue:"",promptEditorValue:"",readDocEditorFocused:!1,readUrlEditorFocused:!1,latestRead:[],latestReadInitiated:!1,guidanceEditorValue:{data:[]},canvasOpenStatusMap:{}},l={guidanceEditorValue:{data:[]},guidanceEditorFocused:!1},s=(0,i.Ue)()((0,n.XR)(e=>({...o,updateUrlEditorValue:t=>{e((0,a.Uy)(e=>{e.urlEditorValue=t}))},updateLinkEditorValue:t=>{e((0,a.Uy)(e=>{e.linkEditorValue=t}))},updatePromptEditorValue:t=>{e((0,a.Uy)(e=>{e.promptEditorValue=t}))},updateGuidanceEditorValue:t=>{e((0,a.Uy)(e=>{e.guidanceEditorValue=t}))},updateReadDocEditorFocusedState:t=>{e((0,a.Uy)(e=>{e.readDocEditorFocused=t}))},updateReadUrlEditorFocusedState:t=>{e((0,a.Uy)(e=>{e.readUrlEditorFocused=t}))},updateLatestRead:function(t){let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1];e((0,a.Uy)(e=>{e.latestReadInitiated=!0,t&&(e.latestRead=r?[...e.latestRead,...t]:t)}))},saveCanvasOpenState:t=>{e((0,a.Uy)(e=>{let{conversationId:r}=t;e.canvasOpenStatusMap[r]=t}))},removeCanvasOpenState:t=>{e((0,a.Uy)(e=>{delete e.canvasOpenStatusMap[t]}))}}))),u=(0,i.Ue)()((0,n.XR)(e=>({...l,updateGuidanceEditorValue:t=>{e((0,a.Uy)(e=>{e.guidanceEditorValue=t}))},updateGuidanceEditorFocusedState:t=>{e((0,a.Uy)(e=>{e.guidanceEditorFocused=t}))}})))},505315:function(e,t,r){r.d(t,{n:function(){return o},rw:function(){return a},vQ:function(){return l}});var n=r(228535),i=r(106307);let a=e=>{let t=e.match(/https:\/\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]*[-A-Za-z0-9+&@#/%=~_|]/g);if(t)return t.map(e=>e.trim()).filter(e=>(0,n.KZS)(e)).shift()},o=e=>({data:[{type:i.f.Text,text:`${e("landing_creation_title")} `},{type:i.f.Placeholder,placeholder:e("landing_inputmessage_enterURL"),text:""}]}),l=()=>({data:[]})},327134:function(e,t,r){r.r(t),r.d(t,{AcademicSearchChatInputPlugin:function(){return v}});var n=r(429996),i=r(87222),a=r(652537),o=r(744787),l=r(636674),s=r(993047);function u(){return r.e("38369").then(r.bind(r,176824))}let d=n.lazy(()=>(0,s.AD)({fn:()=>u()}));class c{focusOnEditor(){var e,t;null===(t=this.editorRef)||void 0===t||null===(e=t.current)||void 0===e||e.focus()}updateEditorValue(e){}clearEditorValue(){}constructor({editorRef:e}){var t,r,n;r=void 0,(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t="editorRef","string"))?n:n+"")in this?Object.defineProperty(this,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[t]=r,this.editorRef=e}}var p=r(627394);function f(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class v extends i.H{focus(){var e;null===(e=this.ref.current)||void 0===e||e.focus()}render(e){return(0,p.jsx)(n.Suspense,{fallback:(0,p.jsx)(o.Y,{}),children:(0,p.jsx)(d,{ref:this.ref,...e})})}preloadChunks(){u()}constructor(...e){super(...e),f(this,"skillType",l.SkillType.AcademicSearch),f(this,"ref",(0,n.createRef)()),f(this,"service",new c({editorRef:this.ref}))}}f(v,"pluginName",a.l.AcademicSearch)},3618:function(e,t,r){r.r(t),r.d(t,{DeepSearchChatInputPlugin:function(){return v}});var n=r(429996),i=r(87222),a=r(652537),o=r(744787),l=r(636674),s=r(993047);function u(){return r.e("20853").then(r.bind(r,396539))}let d=n.lazy(()=>(0,s.AD)({fn:()=>u()}));class c{focusOnEditor(){var e,t;null===(t=this.editorRef)||void 0===t||null===(e=t.current)||void 0===e||e.focus()}updateEditorValue(){}clearEditorValue(){}constructor({editorRef:e}){var t,r,n;r=void 0,(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t="editorRef","string"))?n:n+"")in this?Object.defineProperty(this,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[t]=r,this.editorRef=e}}var p=r(627394);function f(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class v extends i.H{focus(){var e;null===(e=this.ref.current)||void 0===e||e.focus()}render(e){return(0,p.jsx)(n.Suspense,{fallback:(0,p.jsx)(o.Y,{}),children:(0,p.jsx)(d,{ref:this.ref,...e})})}preloadChunks(){u()}constructor(...e){super(...e),f(this,"skillType",l.SkillType.DeepSearch),f(this,"ref",(0,n.createRef)()),f(this,"service",new c({editorRef:this.ref}))}}f(v,"pluginName",a.l.DeepSearch)},975767:function(e,t,r){r.r(t),r.d(t,{AISearchChatInputPlugin:function(){return v}});var n=r(429996),i=r(87222),a=r(652537),o=r(744787),l=r(636674),s=r(993047);function u(){return r.e("591").then(r.bind(r,824065))}let d=n.lazy(()=>(0,s.AD)({fn:()=>u()}));class c{focusOnEditor(){var e,t;null===(t=this.editorRef)||void 0===t||null===(e=t.current)||void 0===e||e.focus()}updateEditorValue(){}clearEditorValue(){}constructor({editorRef:e}){var t,r,n;r=void 0,(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t="editorRef","string"))?n:n+"")in this?Object.defineProperty(this,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[t]=r,this.editorRef=e}}var p=r(627394);function f(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class v extends i.H{focus(){var e;null===(e=this.ref.current)||void 0===e||e.focus()}render(e){return(0,p.jsx)(n.Suspense,{fallback:(0,p.jsx)(o.Y,{}),children:(0,p.jsx)(d,{ref:this.ref,...e})})}preloadChunks(){u()}constructor(...e){super(...e),f(this,"skillType",l.SkillType.Search),f(this,"ref",(0,n.createRef)()),f(this,"service",new c({editorRef:this.ref}))}}f(v,"pluginName",a.l.Search)},406976:function(e,t,r){r.r(t),r.d(t,{TranslateChatInputPlugin:function(){return y}});var n=r(429996),i=r(87222),a=r(652537),o=r(744787),l=r(636674),s=r(477041),u=r(106307),d=r(12107),c=r(203330);class p{focusOnEditor(){c.jW.getState().updateFocusedState(!0)}updateEditorValue(e){(0,s.Z)(e)?(c.jW.getState().updateEditorValue(e),c.jW.getState().updateGuidanceEditorValue({data:[{text:e,type:u.f.Text}]})):(0,d.dz)(e.data[0])&&(c.jW.getState().updateEditorValue(e.data[0].text),c.jW.getState().updateGuidanceEditorValue(e))}clearEditorValue(){this.updateEditorValue("")}}var f=r(993047);function v(){return Promise.all([r.e("54033"),r.e("62212")]).then(r.bind(r,939650))}let m=n.lazy(()=>(0,f.AD)({fn:()=>v()}));var h=r(627394);function g(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class y extends i.H{focus(){var e;null===(e=this.ref.current)||void 0===e||e.focus()}render(e){return(0,h.jsx)(n.Suspense,{fallback:(0,h.jsx)(o.Y,{}),children:(0,h.jsx)(m,{ref:this.ref,...e})})}preloadChunks(){v()}constructor(...e){super(...e),g(this,"skillType",l.SkillType.Translate),g(this,"ref",(0,n.createRef)()),g(this,"service",new p)}}g(y,"pluginName",a.l.Translate)},203330:function(e,t,r){r.d(t,{ki:function(){return p},jW:function(){return c}});var n=r(344482),i=r(613993),a=r(231462),o=r(561200),l=r(51679),s=r(636674),u=r(698570);let d={editorValue:"",focused:!1,guidanceEditorValue:{data:[]},guidanceEditorFocused:!1,guidanceConfigLoading:!1},c=(0,a.Ue)()((0,i.XR)(e=>({...d,updateEditorValue:t=>{e((0,o.Uy)(e=>{e.editorValue=t}))},updateFocusedState:t=>{e((0,o.Uy)(e=>{e.focused=t}))},updateGuidanceEditorValue(t){e((0,o.Uy)(e=>{e.guidanceEditorValue=t}))},updateGuidanceEditorFocused(t){e((0,o.Uy)(e=>{e.guidanceEditorFocused=t}))},fetchGuidanceConfig:()=>{let{data:t,loading:r}=(0,u.Z)(async()=>{try{return await l.mH.SkillPack({skill_type:s.SkillType.Translate,condition:{}})}catch(e){return}},{cacheKey:"translate_skill_pack",staleTime:1/0});e((0,o.Uy)(e=>{var n;e.guidanceConfig=null==t?void 0:null===(n=t.data)||void 0===n?void 0:n.translate,e.guidanceConfigLoading=r}))}}))),p=()=>{let[e,t,r]=c(e=>[e.guidanceConfigLoading,e.guidanceConfig,e.fetchGuidanceConfig],n.Z);return r(),{loading:e,config:t}}},857631:function(e,t,r){r.d(t,{w:function(){return o}});var n=r(477041),i=r(82485),a=r(106307);class o{focusOnEditor(){(0,i.NS)().getState().updateFocusedState(!0)}updateEditorValue(e){(0,n.Z)(e)?(0,i.NS)().getState().updateEditorValue({data:[{type:a.f.Text,text:e}]}):(0,i.NS)().getState().updateEditorValue(e)}clearEditorValue(){this.updateEditorValue("")}}},545177:function(e,t,r){r.r(t),r.d(t,{VideoCreationChatInputPlugin:function(){return v}});var n=r(429996),i=r(87222),a=r(652537),o=r(744787),l=r(636674),s=r(993047);function u(){return Promise.all([r.e("68592"),r.e("86466"),r.e("54640")]).then(r.bind(r,142866))}let d=n.lazy(()=>(0,s.AD)({fn:()=>u()}));var c=r(857631),p=r(627394);function f(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class v extends i.H{focus(){var e;null===(e=this.ref.current)||void 0===e||e.focus()}render(e){return(0,p.jsx)(n.Suspense,{fallback:(0,p.jsx)(o.Y,{}),children:(0,p.jsx)(d,{ref:this.ref,...e})})}preloadChunks(){u()}constructor(...e){super(...e),f(this,"skillType",l.SkillType.VideoGeneration),f(this,"ref",(0,n.createRef)()),f(this,"service",new c.w)}}f(v,"pluginName",a.l.VideoGeneration)},649094:function(e,t,r){r.d(t,{D:function(){return a},Q:function(){return o}});var n=r(429996),i=r(993047);function a(){return Promise.all([r.e("58773"),r.e("51793"),r.e("73971")]).then(r.bind(r,265155))}let o=n.lazy(()=>(0,i.AD)({fn:()=>a()}))},919464:function(e,t,r){r.d(t,{T:function(){return l}});var n=r(537065),i=r(476697);function a(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class o extends n.v{constructor(...e){var t;super(...e),t=this,a(this,"editorRef",null),a(this,"writingChatInputController",null),a(this,"bindWritingChatInputController",e=>{this.writingChatInputController=e}),a(this,"unbindWritingChatInputController",()=>{this.writingChatInputController=null}),a(this,"bindWritingEditorRef",e=>{this.editorRef=e}),a(this,"unbindWritingEditorRef",()=>{this.editorRef=null}),a(this,"focusOnWritingEditor",e=>{this.editorRef&&this.editorRef.focus(e)}),a(this,"blurOnWritingEditor",()=>{this.editorRef&&this.editorRef.blur()}),a(this,"updateWritingRichEditorContent",e=>{i.i.getState().updateWritingEditorValue(e)}),a(this,"getWritingRichEditorContent",()=>{if(this.editorRef)return this.editorRef.getValue()}),a(this,"setTemplate",e=>{if(!this.writingChatInputController)throw Error("not bind WritingChatInput controller when set template");this.writingChatInputController.setTemplate(e)}),a(this,"reset",()=>{this.updateWritingRichEditorContent({data:[]})}),a(this,"updateWritingRichEditorSendDisabledState",e=>{i.i.getState().updateSendDisabledState(e)}),a(this,"setLongArticleWriting",e=>{var t;null===(t=this.writingChatInputController)||void 0===t||t.setLongArticleWriting(e)}),a(this,"addNewAttachmentFiles",function(){for(var e,r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];null===(e=t.writingChatInputController)||void 0===e||e.addNewAttachmentFiles(...n)}),a(this,"setAttachmentConfig",e=>{var t;null===(t=this.writingChatInputController)||void 0===t||t.setAttachmentConfig(e)})}}let l=new o},474248:function(e,t,r){r.d(t,{C:function(){return i}});var n=r(919464);let i={updateWritingEditorValue:e=>{n.T.updateWritingRichEditorContent(e)},getWritingEditorValue:()=>n.T.getWritingRichEditorContent(),focusOnWritingEditor:e=>{n.T.focusOnWritingEditor(e)},setTemplate:e=>{n.T.setTemplate(e)},reset:()=>{n.T.reset()},on:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.T.on(...t)},off:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.T.off(...t)},setLongArticleWriting:e=>{n.T.setLongArticleWriting(e)},addNewAttachmentFiles:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];n.T.addNewAttachmentFiles(...t)},setAttachmentConfig:e=>{n.T.setAttachmentConfig(e)},updateWritingRichEditorSendDisabledState:e=>{n.T.updateWritingRichEditorSendDisabledState(e)}}},330754:function(e,t,r){r.r(t),r.d(t,{WritingAssistantChatInputPlugin:function(){return h}});var n=r(429996),i=r(87222),a=r(652537),o=r(744787),l=r(636674),s=r(477041),u=r(106307),d=r(474248),c=r(476697);class p{updateWritingEditorValue(e,t){c.i.getState().updateWritingEditorValue(e,t)}clearWritingEditorValue(e){c.i.getState().clearWritingEditorValue(e)}focusOnEditor(){d.C.focusOnWritingEditor()}updateEditorValue(e,t){(0,s.Z)(e)?this.updateWritingEditorValue({data:[{type:u.f.Text,text:e}]},t):this.updateWritingEditorValue(e,t)}clearEditorValue(){this.clearWritingEditorValue()}}var f=r(649094),v=r(627394);function m(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class h extends i.H{focus(){var e;null===(e=this.ref.current)||void 0===e||e.focus()}render(e){return(0,v.jsx)(n.Suspense,{fallback:(0,v.jsx)(o.Y,{}),children:(0,v.jsx)(f.Q,{ref:this.ref,...e})})}preloadChunks(){(0,f.D)()}constructor(...e){super(...e),m(this,"skillType",l.SkillType.WriteAssistant),m(this,"ref",(0,n.createRef)()),m(this,"service",new p)}}m(h,"pluginName",a.l.WriteAssistant)},476697:function(e,t,r){r.d(t,{z:function(){return Z},i:function(){return W}});var n=r(613993),i=r(231462),a=r(136389),o=r(869024),l=r(474227),s=r(683653),u=r(561200),d=r(120791),c=r(51679),p=r(636674),f=r(644367);let v=()=>({writingEditorValue:{data:[]},sendDisabled:!1,isWriteConfigInitd:!1,isWriteConfigLoading:!1,writeConfig:{},keepValueOnClear:!1,recentDocs:[],docAISpaceNodeId:null,docPageChatLayoutMode:d.y.Avatar}),m=(e,t)=>(0,a.Z)(v(),{updateWritingEditorValue:function(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{keepOnClear:i=!1}=n,{writingEditorValue:a}=t();!(0,l.Z)(a,r)&&e((0,u.Uy)(e=>{e.writingEditorValue=r,e.keepValueOnClear=i}))},clearWritingEditorValue(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{skipOnceWhenKeep:r=!1}=t;e((0,u.Uy)(e=>{if(r&&e.keepValueOnClear){e.keepValueOnClear=!1;return}e.writingEditorValue={data:[]}}))},updateSendDisabledState:t=>{e((0,u.Uy)(e=>{e.sendDisabled=t}))},fetchWriteConfig:async()=>{if(!t().isWriteConfigLoading&&!t().isWriteConfigInitd)try{e((0,u.Uy)(e=>{e.isWriteConfigLoading=!0,e.isWriteConfigInitd=!1}));let{data:t}=await c.mH.SkillPack({skill_type:p.SkillType.WriteAssistant,condition:{}});e((0,u.Uy)(e=>{(null==t?void 0:t.write)?(e.isWriteConfigLoading=!1,e.isWriteConfigInitd=!0,e.writeConfig=t.write):e.isWriteConfigLoading=!1}))}catch(e){f.k.persist.warning({eventName:"init_write_config_error"})}},refreshRecentDocs:async()=>{try{let{data:t}=await c.mH.AISpacePagesSearch({limit:10}),{nodes:r}=null!=t?t:{};e({recentDocs:null!=r?r:[]})}catch(e){f.k.persist.warning({eventName:"refresh_recent_docs_error",error:e})}},getDocAISpaceNodeId:async()=>{let{docAISpaceNodeId:r}=t();if(r)return r;let{data:n}=await c.mH.AISpaceGetSystemDirectory(),{documents_node_id:i}=null!=n?n:{};if(!i)throw Error("Fail to get doc system directory");return e({docAISpaceNodeId:i}),i},updateDocPageChatLayoutMode:t=>{e({docPageChatLayoutMode:t})},closeCopilotChat:()=>{let{docPageChatLayoutMode:e,updateDocPageChatLayoutMode:r}=t();(0,s.Z)([d.y.Sidebar,d.y.Popover],e)&&r(d.y.Avatar)},showCopilotChat:()=>{let{docPageChatLayoutMode:e,updateDocPageChatLayoutMode:r}=t();(0,s.Z)([d.y.Avatar],e)&&r(d.y.Popover)}});var h=r(735393),g=r(93708),y=r(993047),_=r(453093),S=r(847758);let b=async e=>{var t;let{conversationId:r,artifactId:n}=e,{data:i}=await c.mH.SearchArtifact({conversation_id:r,artifact_id:n}),a=null!==(t=null==i?void 0:i.artifacts)&&void 0!==t?t:[];return(0,_.Z)(a,e=>e.version)},k=async e=>{let{docId:t,needHistories:r=!1}=e;try{let{data:e={}}=await c.Mz.AGWGetArtifactMetaByResource({resource_id:t,artifact_type:S.ArtifactType.Page,need_current_version:!0,need_histories:r}),{artifact_meta:n}=e;if(!n)throw Error("Artifact meta is empty");return n}catch(e){throw f.k.persist.error({message:"get_artifact_union_meta_by_doc_id_error",error:e}),e}};var w=r(520280);let C=()=>({artifactMap:{},blockArtifactMap:{},blockArtifactIdToConvId:{},docArtifactMetaMap:{},openedArtifactKey:null}),E=(e,t)=>(0,a.Z)(C(),{fetchArtifactList:async t=>{let{conversationId:r,artifactId:n,hasAbort:i,ifRetry:a}=t;try{let t=await (0,y.aG)({value:()=>b({conversationId:r,artifactId:n}),ifRetry:e=>!e.length||!!(null==a?void 0:a(e)),count:5});if(i)return;return e((0,u.Uy)(e=>{let{artifactMap:i}=e;i[r]||(i[r]={}),i[r][n]=t})),t}catch(e){throw f.k.persist.error({eventName:"search_artifact_error",error:e}),e}},async refreshArtifactList(){let{conversationId:e,canvasContent:r}=(0,g.GX)("chatViewCanvasStore"),n=null==r?void 0:r.artifactId;if(e&&n)return t().fetchArtifactList({conversationId:e,artifactId:n})},loadMobileArtifactList:async t=>{let{resourceId:r,blockId:n}=t;try{var i;let t=await c.mH.GetDeepResearchResource({resource_id:r}),{blocks:a=[]}=null!==(i=null==t?void 0:t.data)&&void 0!==i?i:{},o=(0,h.Hb)(a);e((0,u.Uy)(e=>{let{blockArtifactMap:t}=e;t||(t={}),t[n]={status:w.M.Succeed,data:o}}))}catch(e){throw f.k.persist.error({eventName:"deep_research_resource_error",error:e}),e}},updateBlockArtifact:t=>{let{type:r,blockId:n,value:i}=t;e((0,u.Uy)(e=>{let{blockArtifactMap:t}=e;t||(t={}),r===w.P.Status?t[n]={...t[n],status:i}:t[n]={...t[n],data:i}}))},updateBlockArtifactIdToConvId:t=>{let{blockId:r,convId:n,status:i}=t;e((0,u.Uy)(e=>{let{blockArtifactIdToConvId:t,blockArtifactMap:a}=e;t[r]||(t[r]={}),t[r]={convId:n,status:i};let o=null!=t?t:{};Object.keys(null!=a?a:{}).forEach(e=>{var t,r;(!o[e]||(null===(t=o[e])||void 0===t?void 0:t.convId)!==n&&(null===(r=o[e])||void 0===r?void 0:r.status))&&delete a[e]})}))},fetchDocArtifactMeta(r){let{docId:n,cache:i=!0}=r,{docArtifactMetaMap:a}=t(),o=a[n];if(o&&i)return Promise.resolve(o);let l=(0,y.aG)({value:()=>k({docId:n,needHistories:!0}),count:3,ifRetry:e=>{var t;return!(null===(t=e.version_list)||void 0===t?void 0:t.length)}}).then(t=>(e((0,u.Uy)(e=>{let{docArtifactMetaMap:r}=e;n in r||(r[n]={}),r[n]=t})),t)).catch(t=>{throw e((0,u.Uy)(e=>{let{docArtifactMetaMap:t}=e;delete t[n]})),t});return e((0,u.Uy)(e=>{let{docArtifactMetaMap:t}=e;n in t||(t[n]={}),t[n]=l})),l},resetDocArtifactCache(t){e((0,u.Uy)(e=>{let{docArtifactMetaMap:r}=e;delete r[t]}))},setOpenedArtifactKey(t){e((0,u.Uy)(e=>{e.openedArtifactKey=t}))}});var A=r(598117);let P=()=>({...A.O,isListLoading:!1,uploadFiles:[],fileStatusMap:{},snapshotUploadFiles:[]}),I=(e,t,r)=>{let n=(0,A.L)(e,t,r);return(0,a.Z)(P(),{...n,clearUploadFiles:()=>{e({uploadFiles:[]})},appendUploadFiles:t=>{e((0,u.Uy)(e=>{e.uploadFiles=[...e.uploadFiles,...t],e.snapshotUploadFiles=t}))},deleteUploadFileWithKey:t=>{e((0,u.Uy)(e=>{let r=e.uploadFiles.filter(e=>e.localKey!==t);e.uploadFiles=r}))},updateUploadFileInfoWithKey:(t,r)=>{e((0,u.Uy)(e=>{let n=e.uploadFiles.findIndex(e=>e.localKey===t);if(-1!==n){let t=e.uploadFiles[n];e.uploadFiles[n]={...t,...r}}}))}})},x=()=>({referenceAndQuoteMap:{}}),M=e=>(0,a.Z)(x(),{updateReferenceQuoteList(t,r,n){e((0,u.Uy)(e=>{e.referenceAndQuoteMap[t]=e.referenceAndQuoteMap[t]||{},e.referenceAndQuoteMap[t][r]=e.referenceAndQuoteMap[t][r]||{},(null==n?void 0:n.length)&&(e.referenceAndQuoteMap[t][r].referenceQuoteList=n)}))},updateReferenceList(t,r,n){e((0,u.Uy)(e=>{e.referenceAndQuoteMap[t]=e.referenceAndQuoteMap[t]||{},e.referenceAndQuoteMap[t][r]=e.referenceAndQuoteMap[t][r]||{},(null==n?void 0:n.length)&&(e.referenceAndQuoteMap[t][r].referenceList=n)}))},clearReferenceListAndQuote(t,r){e((0,u.Uy)(e=>{var n,i,a,o;(null===(i=e.referenceAndQuoteMap[t])||void 0===i?void 0:null===(n=i[r])||void 0===n?void 0:n.referenceList)&&(e.referenceAndQuoteMap[t][r].referenceList=[]),(null===(o=e.referenceAndQuoteMap[t])||void 0===o?void 0:null===(a=o[r])||void 0===a?void 0:a.referenceList)&&(e.referenceAndQuoteMap[t][r].referenceQuoteList=[])}))},updateReferenceAndQuote(t,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];e((0,u.Uy)(e=>{e.referenceAndQuoteMap[t]=e.referenceAndQuoteMap[t]||{},e.referenceAndQuoteMap[t][r]=e.referenceAndQuoteMap[t][r]||{},(null==i?void 0:i.length)&&(e.referenceAndQuoteMap[t][r].referenceQuoteList=i),(null==n?void 0:n.length)&&(e.referenceAndQuoteMap[t][r].referenceList=n)}))}}),T=()=>{let e=window.innerWidth,t=e-400;return{rightPartWidth:t,rightPartWidthRatio:t/e,showySectionInView:!0}},R=e=>(0,a.Z)(T(),{updateRightPartWidth:t=>{e(()=>({rightPartWidth:t,rightPartDisplayWidth:t}))},updateShowySectionInView:t=>{e(()=>({showySectionInView:t}))}}),U=()=>({selectionMap:{}}),j=(e,t)=>(0,a.Z)(U(),{addSelection:t=>{let{chatId:r,version:n,selectedContent:i,referenceContent:a,skillType:o,docAction:l,docCursorType:s}=t;e((0,u.Uy)(e=>{e.selectionMap[r]={chatId:r,version:n,selectedContent:i,referenceContent:a,skillType:o,docAction:l,docCursorType:s,timestamp:Date.now()}}))},getSelection:e=>{let{selectionMap:r}=t();return r[e]},removeSelection:t=>{e((0,u.Uy)(e=>{delete e.selectionMap[t]}))},clearAllSelections:()=>{e((0,u.Uy)(e=>{e.selectionMap={}}))}});var N=r(627426);let D=()=>({legacyDocIdMapping:{},openedDocId:null,docMetaMap:{}}),O=e=>(0,a.Z)(D(),{setLegacyDocIdMapping:(t,r)=>{e((0,u.Uy)(e=>{let{legacyDocIdMapping:n}=e;n[t]=r}))},setOpenedDocId:t=>{e((0,u.Uy)(e=>{e.openedDocId=t}))},updateDocMetaMap:(t,r)=>{e((0,u.Uy)(e=>{var n;e.docMetaMap[t]=(0,N.Z)({},r,null!==(n=e.docMetaMap[t])&&void 0!==n?n:{})}))}}),V=e=>{try{return{blockArtifactMap:e.blockArtifactMap}}catch(e){return f.k.persist.error({message:"[@write-skill-store] persist state limit error",error:e instanceof Error?e:Error(String(e))}),{}}},L=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.Z)(m(...t),E(...t),I(...t),M(...t),R(...t),j(...t),O(...t))},F=e=>{let{isEnableDebug:t,reduxDevToolsSnapshot:r,merge:a,partialize:l,storage:s}=e,u=(0,o.C1)({name:"writing-skill-store",prefix:"samantha-web",storage:s,partialize:null!=l?l:V,version:1.5,merge:a}),d=(0,n.tJ)((0,n.XR)(L),u);return t&&r?(0,i.Ue)()((0,n.mW)(d,{name:"samantha-web-writing-skill-store"})):(0,i.Ue)()(d)},W=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let{_useWriteStore:n}=W.prototype;if(n)return n(...t);throw Error("useWriteStore is not initialized")};function Z(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_useWriteStore:t}=W.prototype||{};if(!t){let t=F({...e});Object.setPrototypeOf(W.prototype,t),Object.defineProperties(W,{...Object.getOwnPropertyDescriptors(t)}),W.prototype._useWriteStore=t}}},520280:function(e,t,r){var n,i;r.d(t,{M:function(){return a},P:function(){return o}});let a=((n={}).Processing="processing",n.Succeed="succeed",n.Failed="failed",n.Broken="broken",n),o=((i={}).Status="status",i.Artifact="artifact",i)},598117:function(e,t,r){r.d(t,{L:function(){return o},O:function(){return a}});var n=r(561200),i=r(57005);let a={rootId:"0",systemNodeIds:[],nodeListMap:{},nodeListStatusMap:{},nodeInfoMap:{},currentPathStack:[],selectedNodeIds:[],selectedNodes:[],disbaleNodeInfoMap:{},mediaTransformStatus:{},sortStatus:{sortOrder:i.cj.Desc,sortType:i.$Q.Default},sortConfig:{}},o=e=>({...a,updateRootId:t=>{e(()=>({rootId:t}))},updateSystemNodeIds:t=>{e(()=>({systemNodeIds:t}))},setNodeListMap:(t,r)=>{e((0,n.Uy)(e=>{e.nodeListMap[t]=r}))},deleteNodeListMap:t=>{e((0,n.Uy)(e=>{delete e.nodeListMap[t]}))},clearNodeListMap:()=>{e(()=>({nodeListMap:{}}))},setNodeListStatusMap:(t,r)=>{e((0,n.Uy)(e=>{e.nodeListStatusMap[t]=r}))},deleteNodeListStatusMap:t=>{e((0,n.Uy)(e=>{delete e.nodeListStatusMap[t]}))},clearNodeListStatusMap:()=>{e(()=>({nodeListStatusMap:{}}))},setNodeInfoMap:(t,r)=>{e((0,n.Uy)(e=>{e.nodeInfoMap[t]=r}))},deleteNodeInfoMap:t=>{e((0,n.Uy)(e=>{delete e.nodeInfoMap[t]}))},clearNodeInfoMap:()=>{e(()=>({nodeInfoMap:{}}))},pushCurrentPathStack:t=>{e((0,n.Uy)(e=>{e.currentPathStack.push(t)}))},popCurrentPathStack:()=>{let t;return e((0,n.Uy)(e=>{t=e.currentPathStack.pop()})),t},updateCurrentPathStack:t=>{e((0,n.Uy)(e=>{e.currentPathStack=t}))},updateSelectedNodeIds:t=>{e((0,n.Uy)(e=>{e.selectedNodeIds=t;let r=[];t.forEach(t=>{let n=e.nodeInfoMap[t];n&&r.push(n)}),e.selectedNodes=r}))},deleteNodes:(t,r)=>{e((0,n.Uy)(e=>{let n=e.nodeListMap[t],i=null==n?void 0:n.filter(e=>!r.includes(e));e.nodeListMap[t]=i,r.forEach(t=>{delete e.nodeInfoMap[t]})}))},renameNode:(t,r)=>{e((0,n.Uy)(e=>{let n=e.nodeInfoMap[t];n&&(n.name=r,n.updateTime=String(new Date().getTime()))}))},updateGuestCanCreateThread:t=>{e((0,n.Uy)(e=>{e.guestCanCreateThread=t}))},updateGuestCanSendMessage:t=>{e((0,n.Uy)(e=>{e.guestCanSendMessage=t}))},disableNode:t=>{e((0,n.Uy)(e=>{(Array.isArray(t)?t:[t]).forEach(t=>{e.disbaleNodeInfoMap[t]=!0})}))},batchUpdateMediaTransformStatus:t=>{(null==t?void 0:t.length)&&e((0,n.Uy)(e=>{e.mediaTransformStatus={...e.mediaTransformStatus},t.forEach(t=>{e.mediaTransformStatus[t.nodeId]=t.status})}))},batchUpdateNodeAISkillStatus:t=>{(null==t?void 0:t.length)&&e((0,n.Uy)(e=>{t.forEach(t=>{let r=e.nodeInfoMap[t.nodeId];r&&(e.nodeInfoMap[t.nodeId]={...r,content:{...r.content,aiSkillStatus:t.aiSkillStatus}})})}))},clearAllNodeList:()=>{e(()=>({nodeListMap:{}}))}})},637224:function(e,t,r){r.d(t,{$:function(){return i},G4:function(){return o},HS:function(){return c},Yy:function(){return s},fH:function(){return n},gJ:function(){return d},mQ:function(){return u},vQ:function(){return l}});let n=()=>{if("undefined"==typeof window)return!1;let{pathname:e}=window.location;return!!e&&!!e.startsWith("/code")},i=()=>{let{location:e}=window;return!!e&&/^\/chat\/coding\/?$/.test(e.pathname)},a=e=>/\/code\/chat(\/(local_|main)?\d*)?(\?.*)?$/.test(e),o=()=>{let{location:e}=window;return!!e&&a(e.pathname)},l=()=>{let{location:e}=window;return!!e&&(/\/code\/share(\/\d*)?$/.test(e.pathname)||/\/code\/chat\/new(\/\d*)?$/.test(e.pathname)||/\/code\/chat\/new-thread\/create-by-share\/?$/.test(e.pathname)||/\/code\/chat\/new-doc\/?$/.test(e.pathname))},s=()=>{let{location:e}=window;return!!e&&!a(e.pathname)&&/\/code\/chat\/.*$/.test(e.pathname)},u=()=>{let{location:e}=window;return!!e&&/^\/code\/chat\/?$/.test(e.pathname)},d="/code/chat",c="/chat/coding"},82485:function(e,t,r){r.d(t,{dI:function(){return y},NS:function(){return g}});var n=r(613993),i=r(231462),a=r(869024),o=r(447269),l=r(81192),s=r(561200),u=r(51679),d=r(636674),c=r(644367);let p={editorValue:{data:[]},focused:!1,inputOptionsMap:{},attachment:{},videoList:[],imageRef:"",videoGenInfo:{remain_count:0,has_generating_task:!1,is_beta_user:!1},hasFetched:!1},f={isInit:!1},v=(e,t)=>({...p,updateEditorValue:t=>{e((0,s.Uy)(e=>{e.editorValue=t}))},updateFocusedState:t=>{e((0,s.Uy)(e=>{e.focused=t}))},initVideoList:()=>{if(f.isInit)return;let{fetchVideoList:e}=t();e(!0)},fetchVideoList:async t=>{try{let{data:r}=await u.mH.SkillPack({skill_type:d.SkillType.VideoGeneration}),n=null==r?void 0:r.video_generation;if(!(null==n?void 0:n.meta))return;e((0,s.Uy)(e=>{var r,i,a,s;if(null==n?void 0:null===(r=n.meta)||void 0===r?void 0:r.option_list){let t=(0,o.Z)(null==n?void 0:null===(a=n.meta)||void 0===a?void 0:a.option_list,(e,t)=>({...e,[String(t.value)]:{...t}}),{});e.inputOptionsMap=t}let u=(t?[]:(0,l.Z)(e.videoList)).concat(null!==(s=null==n?void 0:null===(i=n.template)||void 0===i?void 0:i.item_list)&&void 0!==s?s:[]);e.videoList=u,f.isInit=!0}))}catch(e){c.k.persist.warning({eventName:"init_image_list_error"})}},updateVideoGenInfo:async()=>{try{let{data:t}=await u.mH.QueryVideoGenInfo();return e((0,s.Uy)(e=>({...e,hasFetched:!0,videoGenInfo:t}))),t}catch(e){e instanceof Error&&c.k.persist.error({error:e,message:null==e?void 0:e.message})}},decreaseCount:()=>{e((0,s.Uy)(e=>{var t;(null===(t=e.videoGenInfo)||void 0===t?void 0:t.remain_count)&&(e.videoGenInfo={...e.videoGenInfo,remain_count:e.videoGenInfo.remain_count-1,has_generating_task:!0})}))},updateRef:t=>{e((0,s.Uy)(e=>{e.imageRef=t}))}}),m=e=>{try{return{inputOptionsMap:e.inputOptionsMap,videoList:e.videoList}}catch(e){return c.k.persist.error({message:"[@video-skill-store] persist state limit error",error:e instanceof Error?e:Error(String(e))}),{}}},h=e=>{let{isEnableDebug:t,reduxDevToolsSnapshot:r,merge:o,partialize:l,storage:s}=e,u=(0,a.C1)({name:"video-skill-store",prefix:"samantha-web",storage:s,partialize:null!=l?l:m,version:1.5,merge:o}),d=(0,n.tJ)((0,n.XR)(v),u);return t&&r?(0,i.Ue)()((0,n.mW)(d,{name:"samantha-web-video-skill-store"})):(0,i.Ue)()(d)},g=()=>(_(),y),y=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];_();let{_useVideoSkillStore:n}=y.prototype;if(n)return n(...t);throw Error("useVideoSkillStore is not initialized")};function _(){let{_useVideoSkillStore:e}=y.prototype||{};if(!e){let e=h({});Object.setPrototypeOf(y.prototype,e),Object.defineProperties(y,{...Object.getOwnPropertyDescriptors(e)}),y.prototype._useVideoSkillStore=e}}},120791:function(e,t,r){r.d(t,{P:function(){return l},y:function(){return s}});var n,i,a={};r.r(a),r.d(a,{CheckPageUpgradeStatus:function(){return o}});let o=((n={})[n.NotUpgrade=1]="NotUpgrade",n[n.Init=2]="Init",n[n.Upgrading=3]="Upgrading",n[n.Upgraded=4]="Upgraded",n[n.UpgradeFailed=5]="UpgradeFailed",n),{CheckPageUpgradeStatus:l}=a,s=((i={}).Sidebar="sidebar",i.Popover="popover",i.Avatar="avatar",i.Hidden="hidden",i)},735393:function(e,t,r){r.d(t,{Hb:function(){return l},bu:function(){return s},fY:function(){return d},mD:function(){return c},o2:function(){return u}});var n=r(118200),i=r(742470),a=r(432626),o=r(910157);let l=e=>{let t="";for(let a of e)if(a.block_type===i.zc.BLOCK_TEXT&&(t+=(0,o.R)(a.content,{}).text),a.block_type===i.zc.BLOCK_IMAGE){var r,n;let e=(0,o.R)(a.content,{});t+=`![](${null==e?void 0:null===(n=e.images)||void 0===n?void 0:null===(r=n[0])||void 0===r?void 0:r.thumb_url})`}return t},s=e=>{var t,r;return null!==(r=null==e?void 0:null===(t=e.content_blocks)||void 0===t?void 0:t.filter(e=>e.block_type===i.zc.BLOCK_RESEARCH))&&void 0!==r?r:[]},u=e=>{var t,r;return null==e?void 0:null===(r=e.content_blocks)||void 0===r?void 0:null===(t=r.find(e=>e.block_type===i.zc.BLOCK_ARTIFACT))||void 0===t?void 0:t.content_obj},d=e=>{let t=(0,n.Z)(e,["verbose","deep_research","deep_research_id"]),r=(0,n.Z)(e,["ext","deep_research_id"]);return t||r},c=e=>(0,a.X9)("doc_title_duplicate",{docName:e||(0,a.X9)("doc_title_unnamed")})},901027:function(e,t,r){r.d(t,{Uy:function(){return Z}});var n,i=Symbol.for("immer-nothing"),a=Symbol.for("immer-draftable"),o=Symbol.for("immer-state");function l(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var s=Object.getPrototypeOf;function u(e){return!!e&&!!e[o]}function d(e){var t;return!!e&&(p(e)||Array.isArray(e)||!!e[a]||!!(null===(t=e.constructor)||void 0===t?void 0:t[a])||g(e)||y(e))}var c=Object.prototype.constructor.toString();function p(e){if(!e||"object"!=typeof e)return!1;let t=s(e);if(null===t)return!0;let r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===c}function f(e,t){0===v(e)?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function v(e){let t=e[o];return t?t.type_:Array.isArray(e)?1:g(e)?2:3*!!y(e)}function m(e,t){return 2===v(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function h(e,t,r){let n=v(e);2===n?e.set(t,r):3===n?e.add(r):e[t]=r}function g(e){return e instanceof Map}function y(e){return e instanceof Set}function _(e){return e.copy_||e.base_}function S(e,t){if(g(e))return new Map(e);if(y(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);let r=p(e);if(!0!==t&&("class_only"!==t||r)){let t=s(e);return null!==t&&r?{...e}:Object.assign(Object.create(t),e)}{let t=Object.getOwnPropertyDescriptors(e);delete t[o];let r=Reflect.ownKeys(t);for(let n=0;n<r.length;n++){let i=r[n],a=t[i];!1===a.writable&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(t[i]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[i]})}return Object.create(s(e),t)}}function b(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return w(e)||u(e)||!d(e)||(v(e)>1&&Object.defineProperties(e,{set:{value:k},add:{value:k},clear:{value:k},delete:{value:k}}),Object.freeze(e),t&&Object.values(e).forEach(e=>b(e,!0))),e}function k(){l(2)}function w(e){return Object.isFrozen(e)}var C={};function E(e){let t=C[e];return t||l(0,e),t}function A(e,t){t&&(E("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function P(e){I(e),e.drafts_.forEach(M),e.drafts_=null}function I(e){e===n&&(n=e.parent_)}function x(e){return n={drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function M(e){let t=e[o];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function T(e,t){t.unfinalizedDrafts_=t.drafts_.length;let r=t.drafts_[0];return void 0!==e&&e!==r?(r[o].modified_&&(P(t),l(4)),d(e)&&(e=R(t,e),t.parent_||j(t,e)),t.patches_&&E("Patches").generateReplacementPatches_(r[o].base_,e,t.patches_,t.inversePatches_)):e=R(t,r,[]),P(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==i?e:void 0}function R(e,t,r){if(w(t))return t;let n=t[o];if(!n)return f(t,(i,a)=>U(e,n,t,i,a,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return j(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;let t=n.copy_,i=t,a=!1;3===n.type_&&(i=new Set(t),t.clear(),a=!0),f(i,(i,o)=>U(e,n,t,i,o,r,a)),j(e,t,!1),r&&e.patches_&&E("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function U(e,t,r,n,i,a,o){if(u(i)){let o=R(e,i,a&&t&&3!==t.type_&&!m(t.assigned_,n)?a.concat(n):void 0);if(h(r,n,o),!u(o))return;e.canAutoFreeze_=!1}else o&&r.add(i);if(d(i)&&!w(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;R(e,i),(!t||!t.scope_.parent_)&&"symbol"!=typeof n&&(g(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&j(e,i)}}function j(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&b(t,r)}var N={get(e,t){if(t===o)return e;let r=_(e);if(!m(r,t))return function(e,t,r){var n;let i=V(t,r);return i?"value"in i?i.value:null===(n=i.get)||void 0===n?void 0:n.call(e.draft_):void 0}(e,r,t);let n=r[t];return e.finalized_||!d(n)?n:n===O(e.base_,t)?(F(e),e.copy_[t]=W(n,e)):n},has:(e,t)=>t in _(e),ownKeys:e=>Reflect.ownKeys(_(e)),set(e,t,r){let n=V(_(e),t);if(null==n?void 0:n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){let n=O(_(e),t),i=null==n?void 0:n[o];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if((r===n?0!==r||1/r==1/n:r!=r&&n!=n)&&(void 0!==r||m(e.base_,t)))return!0;F(e),L(e)}return!!(e.copy_[t]===r&&(void 0!==r||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t]))||(e.copy_[t]=r,e.assigned_[t]=!0,!0)},deleteProperty:(e,t)=>(void 0!==O(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,F(e),L(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){let r=_(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:n.enumerable,value:r[t]}:n},defineProperty(){l(11)},getPrototypeOf:e=>s(e.base_),setPrototypeOf(){l(12)}},D={};function O(e,t){let r=e[o];return(r?_(r):e)[t]}function V(e,t){if(!(t in e))return;let r=s(e);for(;r;){let e=Object.getOwnPropertyDescriptor(r,t);if(e)return e;r=s(r)}}function L(e){!e.modified_&&(e.modified_=!0,e.parent_&&L(e.parent_))}function F(e){e.copy_||(e.copy_=S(e.base_,e.scope_.immer_.useStrictShallowCopy_))}function W(e,t){let r=g(e)?E("MapSet").proxyMap_(e,t):y(e)?E("MapSet").proxySet_(e,t):function(e,t){let r=Array.isArray(e),i={type_:+!!r,scope_:t?t.scope_:n,modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},a=i,o=N;r&&(a=[i],o=D);let{revoke:l,proxy:s}=Proxy.revocable(a,o);return i.draft_=s,i.revoke_=l,s}(e,t);return(t?t.scope_:n).drafts_.push(r),r}f(N,(e,t)=>{D[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),D.deleteProperty=function(e,t){return D.set.call(this,e,t,void 0)},D.set=function(e,t,r){return N.set.call(this,e[0],t,r,e[0])};var Z=new class{createDraft(e){var t;d(e)||l(8),u(e)&&(u(t=e)||l(10,t),e=function e(t){let r;if(!d(t)||w(t))return t;let n=t[o];if(n){if(!n.modified_)return n.base_;n.finalized_=!0,r=S(t,n.scope_.immer_.useStrictShallowCopy_)}else r=S(t,!0);return f(r,(t,n)=>{h(r,t,e(n))}),n&&(n.finalized_=!1),r}(t));let r=x(this),n=W(e,void 0);return n[o].isManual_=!0,I(r),n}finishDraft(e,t){let r=e&&e[o];r&&r.isManual_||l(9);let{scope_:n}=r;return A(n,t),T(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){let n=t[r];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}r>-1&&(t=t.slice(r+1));let n=E("Patches").applyPatches_;return u(e)?n(e,t):this.produce(e,e=>n(e,t))}constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,r)=>{let n;if("function"==typeof e&&"function"!=typeof t){let r=t;t=e;let n=this;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;for(var i=arguments.length,a=Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];return n.produce(e,e=>t.call(this,e,...a))}}if("function"!=typeof t&&l(6),void 0!==r&&"function"!=typeof r&&l(7),d(e)){let i=x(this),a=W(e,void 0),o=!0;try{n=t(a),o=!1}finally{o?P(i):I(i)}return A(i,r),T(n,i)}if(e&&"object"==typeof e)l(1,e);else{if(void 0===(n=t(e))&&(n=e),n===i&&(n=void 0),this.autoFreeze_&&b(n,!0),r){let t=[],i=[];E("Patches").generateReplacementPatches_(e,n,t,i),r(t,i)}return n}},this.produceWithPatches=(e,t)=>{let r,n;if("function"==typeof e){var i=this;return function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return i.produceWithPatches(t,t=>e(t,...n))}}return[this.produce(e,t,(e,t)=>{r=e,n=t}),r,n]},"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof(null==e?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}}().produce},718025:function(e,t){t.Z=function(e,t,r,n){var i=-1,a=null==e?0:e.length;for(n&&a&&(r=e[++i]);++i<a;)r=t(r,e[i],i,e);return r}},225779:function(e,t,r){r.d(t,{Z:function(){return f}});var n=r(477404),i=r(510722),a=r(348344),o=r(268059),l=function(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e},s=r(836423),u=r(633769),d=function(e,t,r){for(var n=-1,i=e.criteria,a=t.criteria,o=i.length,l=r.length;++n<o;){var s=(0,u.Z)(i[n],a[n]);if(s){if(n>=l)return s;return s*("desc"==r[n]?-1:1)}}return e.index-t.index},c=r(129144),p=r(511451),f=function(e,t,r){t=t.length?(0,n.Z)(t,function(e){return(0,p.Z)(e)?function(t){return(0,i.Z)(t,1===e.length?e[0]:e)}:e}):[c.Z];var u=-1;return t=(0,n.Z)(t,(0,s.Z)(a.Z)),l((0,o.Z)(e,function(e,r,i){return{criteria:(0,n.Z)(t,function(t){return t(e)}),index:++u,value:e}}),function(e,t){return d(e,t,r)})}},633769:function(e,t,r){var n=r(633906);t.Z=function(e,t){if(e!==t){var r=void 0!==e,i=null===e,a=e==e,o=(0,n.Z)(e),l=void 0!==t,s=null===t,u=t==t,d=(0,n.Z)(t);if(!s&&!d&&!o&&e>t||o&&l&&u&&!s&&!d||i&&l&&u||!r&&u||!a)return 1;if(!i&&!o&&!d&&e<t||d&&r&&a&&!i&&!o||s&&r&&a||!l&&a||!u)return -1}return 0}},447269:function(e,t,r){r.d(t,{Z:function(){return s}});var n=r(718025),i=r(824915),a=r(348344),o=function(e,t,r,n,i){return i(e,function(e,i,a){r=n?(n=!1,e):t(r,e,i,a)}),r},l=r(511451),s=function(e,t,r){var s=(0,l.Z)(e)?n.Z:o,u=arguments.length<3;return s(e,(0,a.Z)(t,4),r,u,i.Z)}},453093:function(e,t,r){var n=r(883566),i=r(225779),a=r(219291),o=r(173581),l=(0,a.Z)(function(e,t){if(null==e)return[];var r=t.length;return r>1&&(0,o.Z)(e,t[0],t[1])?t=[]:r>2&&(0,o.Z)(t[0],t[1],t[2])&&(t=[t[0]]),(0,i.Z)(e,(0,n.Z)(t,1),[])});t.Z=l},743741:function(e,t,r){let n;r.d(t,{YD:function(){return f},df:function(){return p}});var i=r(429996);function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}let o=new Map,l=new WeakMap,s=0;function u(e,t,r={},i=n){if(void 0===window.IntersectionObserver&&void 0!==i){let n=e.getBoundingClientRect();return t(i,{isIntersecting:i,target:e,intersectionRatio:"number"==typeof r.threshold?r.threshold:0,time:0,boundingClientRect:n,intersectionRect:n,rootBounds:n}),()=>{}}let{id:a,observer:d,elements:c}=function(e){let t=Object.keys(e).sort().filter(t=>void 0!==e[t]).map(t=>{var r;return`${t}_${"root"===t?(r=e.root)?(l.has(r)||(s+=1,l.set(r,s.toString())),l.get(r)):"0":e[t]}`}).toString(),r=o.get(t);if(!r){let n;let i=new Map,a=new IntersectionObserver(t=>{t.forEach(t=>{var r;let a=t.isIntersecting&&n.some(e=>t.intersectionRatio>=e);e.trackVisibility&&void 0===t.isVisible&&(t.isVisible=a),null==(r=i.get(t.target))||r.forEach(e=>{e(a,t)})})},e);n=a.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),r={id:t,observer:a,elements:i},o.set(t,r)}return r}(r),p=c.get(e)||[];return c.has(e)||c.set(e,p),p.push(t),d.observe(e),function(){p.splice(p.indexOf(t),1),0===p.length&&(c.delete(e),d.unobserve(e)),0===c.size&&(d.disconnect(),o.delete(a))}}let d=["children","as","triggerOnce","threshold","root","rootMargin","onChange","skip","trackVisibility","delay","initialInView","fallbackInView"];function c(e){return"function"!=typeof e.children}class p extends i.Component{constructor(e){super(e),this.node=null,this._unobserveCb=null,this.handleNode=e=>{!this.node||(this.unobserve(),e||this.props.triggerOnce||this.props.skip||this.setState({inView:!!this.props.initialInView,entry:void 0})),this.node=e||null,this.observeNode()},this.handleChange=(e,t)=>{e&&this.props.triggerOnce&&this.unobserve(),c(this.props)||this.setState({inView:e,entry:t}),this.props.onChange&&this.props.onChange(e,t)},this.state={inView:!!e.initialInView,entry:void 0}}componentDidUpdate(e){(e.rootMargin!==this.props.rootMargin||e.root!==this.props.root||e.threshold!==this.props.threshold||e.skip!==this.props.skip||e.trackVisibility!==this.props.trackVisibility||e.delay!==this.props.delay)&&(this.unobserve(),this.observeNode())}componentWillUnmount(){this.unobserve(),this.node=null}observeNode(){if(!this.node||this.props.skip)return;let{threshold:e,root:t,rootMargin:r,trackVisibility:n,delay:i,fallbackInView:a}=this.props;this._unobserveCb=u(this.node,this.handleChange,{threshold:e,root:t,rootMargin:r,trackVisibility:n,delay:i},a)}unobserve(){this._unobserveCb&&(this._unobserveCb(),this._unobserveCb=null)}render(){if(!c(this.props)){let{inView:e,entry:t}=this.state;return this.props.children({inView:e,entry:t,ref:this.handleNode})}let e=this.props,{children:t,as:r}=e,n=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,d);return i.createElement(r||"div",a({ref:this.handleNode},n),t)}}function f({threshold:e,delay:t,trackVisibility:r,rootMargin:n,root:a,triggerOnce:o,skip:l,initialInView:s,fallbackInView:d,onChange:c}={}){var p;let[v,m]=i.useState(null),h=i.useRef(),[g,y]=i.useState({inView:!!s,entry:void 0});h.current=c,i.useEffect(()=>{let i;if(!l&&v)return i=u(v,(e,t)=>{y({inView:e,entry:t}),h.current&&h.current(e,t),t.isIntersecting&&o&&i&&(i(),i=void 0)},{root:a,rootMargin:n,threshold:e,trackVisibility:r,delay:t},d),()=>{i&&i()}},[Array.isArray(e)?e.toString():e,v,a,n,o,l,r,d,t]);let _=null==(p=g.entry)?void 0:p.target,S=i.useRef();v||!_||o||l||S.current===_||(S.current=_,y({inView:!!s,entry:void 0}));let b=[m,g.inView,g.entry];return b.ref=b[0],b.inView=b[1],b.entry=b[2],b}}}]);