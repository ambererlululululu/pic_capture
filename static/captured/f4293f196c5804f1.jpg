/*! For license information please see lib-starling.e9f9be4f.js.LICENSE.txt */
"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["49554"],{395292:function(e,t,n){n.d(t,{runtimeIntl:function(){return s}}),n(345660);var i=n(154922),r=n(335855),o=n(234597),a=new(n(924218)).Intl;new i.EventEmitter;var s={I18n:a,withTranslation:r.withTranslation,useTranslation:o.useTranslation,changeLanguage:function(e){return e.locale,Promise.resolve()},starlingLoadWithLng:function(e){return Promise.resolve()},addResourceToI18n:function(){}}},297076:function(e,t,n){n.d(t,{default:function(){return i}});var i=n(895671).runtimeIntl},895671:function(e,t,n){n.d(t,{runtimeIntl:function(){return Q},intlPlugin:function(){return ee}});var i,r,o,a,s,c,u=n(95907),l=n(151397),h=n(92477),p=n(345660),f=n(212750),d=n(154922),g=n(519428),_=n(335855),m=n(234597),v=n(609280),y=n(473907),b=n(750591),E=n(713738),w=n(539848),S=(0,w.createAsyncHook)(),k=(0,w.createAsyncHook)(),A=n(955888),D=n(344303),T=n(440050);function R(){for(var e,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=console).info.apply(e,["[Staring Info]"].concat((0,T._)(n)))}var O=n(727643),M=(i=(0,u._)(function(e,t){var n,i,r,o,a;return(0,h.__generator)(this,function(s){switch(s.label){case 0:i=(n=e.client).namespace,r=n.debug,o=n.projectName,s.label=1;case 1:return s.trys.push([1,3,,4]),r&&R("Starling Client Params:",e),[4,new O.default(e.client).load()];case 2:if(a=s.sent(),r&&R("Starling Client Result:",a),!a||0===Object.keys(a).length)return[2,null];return[2,(0,A._)({},t?"".concat(o,"_").concat(i):i,a)];case 3:return s.sent(),[2,null];case 4:return[2]}})}),function(e,t){return i.apply(this,arguments)}),C=(r=(0,u._)(function(e){var t;return(0,h.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Promise.all(e)];case 1:if((t=n.sent()).every(function(e){return!e||0===Object.keys(e).length}))return[2,null];return[2,t.reduce(function(e,t){return e=(0,l._)({},e,t)},{})];case 2:return n.sent(),[2,null];case 3:return[2]}})}),function(e){return r.apply(this,arguments)}),I=function(e,t,n,i,r,o,a){var s=e.length>1,c=[];return e.forEach(function(e){var u=e.projectName,h=e.namespace,p=e.apiKey;(h||[]).forEach(function(e){if(n.enableOptimizeResourceHandle&&o.hasResourceBundle(i,e)){var h=o.getResourceBundle(i,e);c.push(Promise.resolve((0,A._)({},e,h)))}else c.push(r({locale:i,client:(0,D._)((0,l._)({},t),{apiKey:p,namespace:e,locale:i,projectName:u,zoneHost:null==t?void 0:t.zoneHost}),node:(0,D._)((0,l._)({},n),{projectName:u,namespace:e})},s,a))})}),c},G=(o=(0,u._)(function(e,t,n,i,r,o){var a,s;return(0,h.__generator)(this,function(c){switch(c.label){case 0:return[4,C(I(e,t,n,i,M,r,o))];case 1:return a=c.sent(),s="string"!=typeof i?i:i.replace(/([a-zA-Z]+)(_[a-zA_Z]+)?/,function(e,t,n){return t.toLowerCase()+(n?n.toUpperCase():"")}),Object.keys(a||{}).forEach(function(e){r.addResourceBundle(s,e,a[e])}),[2,{resources:a,lng:s}]}})}),function(e,t,n,i,r,a){return o.apply(this,arguments)}),x=(a=(0,u._)(function(e){var t,n,i,r,o,a,s,c,u,l=arguments;return(0,h.__generator)(this,function(h){switch(h.label){case 0:if(t=l.length>1&&void 0!==l[1]?l[1]:"en",n=l.length>2?l[2]:void 0,i=l.length>3?l[3]:void 0,r=l.length>4?l[4]:void 0,(o=[]).push(G(e.projects,e.clientOptions,e.nodeOptions,t,i,r)),a=n.enableRequestFallbackLng,s=n.fallbackLangs,a&&("string"==typeof s||Array.isArray(s)))(Array.isArray(s)?s:[s]).forEach(function(t){return o.push(G(e.projects,e.clientOptions,e.nodeOptions,t,i,r))});return[4,Promise.all(o)];case 1:return c=h.sent(),u={},c.forEach(function(e){var t=e.lng,n=e.resources;u[t]=n}),[2,{resources:u}]}})}),function(e){return a.apply(this,arguments)}),N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t?e[t]:e;return!!n&&0!==Object.values(n).filter(Boolean).length};function z(e,t,n,i,r){var o=null!=r?r:{},a=o.reporter,s=o.logger,c=Object.keys(t);null==a||a.reportInfo("[exportServerResourcesToWindow]",{locale:n,i18nLanguage:c.join(",")}),null==s||s.debug("[exportServerResourcesToWindow]",n,c.join(",")),t&&(e.__i18nData__={resources:!i&&N(t,n)?JSON.parse(JSON.stringify(t)):null,lng:n})}var P=(s=(0,u._)(function(e,t,n){var i,r,o,a,s,c=arguments;return(0,h.__generator)(this,function(u){switch(u.label){case 0:return i=c.length>3&&void 0!==c[3]?c[3]:"en",r=c.length>4?c[4]:void 0,o=c.length>5?c[5]:void 0,a=r.fallbackLangs,s=i||t.language||("string"==typeof a?a:"en")||"en",[4,x(n,i,r,{addResourceBundle:t.addResourceBundle,hasResourceBundle:t.hasResourceBundle,getResourceBundle:t.getResourceBundle},o)];case 1:return z(e,u.sent().resources,s,n.disableExportResourceToWindow,o),[2]}})}),function(e,t,n){return s.apply(this,arguments)}),B=E.createContext({lng:"",resources:null,error:null,loading:!1}),L=B.Provider;B.Consumer;var U="__EDENX_LANGUAGE_EVENT",j=new d.EventEmitter,V=new(n(924218)).Intl,K=n(751380),$=n(23597),q={fallbackLng:"en",ns:["translation"],defaultNS:"translation",saveMissing:!0,debug:!1,react:{useSuspense:!1},interpolation:{escapeValue:!1},detection:{caches:["cookie","localStorage"],order:["querystring","cookie","localStorage","header","navigator","htmlTag","path","subdomain"],cookieMinutes:525600,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupHeader:"accept-language"}},H=(c=(0,u._)(function(e){var t,n,i,r,o,a,s,c,u=arguments;return(0,h.__generator)(this,function(h){switch(h.label){case 0:return t=u.length>1&&void 0!==u[1]&&u[1],r=null===(i=window._SSR_DATA)||void 0===i?void 0:null===(n=i.data)||void 0===n?void 0:n.i18nData,s=void 0===(a=(o=e||{}).plugins)?[]:a,c=(0,K._)(o,["plugins"]),t||V.use($.default),s.filter(function(e){return!!e}).forEach(function(e){V.use(e)}),[4,V.init((0,D._)((0,l._)({},q,c),{resources:(0,f.merge)({},(null==e?void 0:e.resources)||{},(null==r?void 0:r.resources)||{}),lng:(null==r?void 0:r.lng)||(null==e?void 0:e.lng)}))];case 1:return h.sent(),[2,V]}})}),function(e){return c.apply(this,arguments)});function W(e){return Array.isArray(e)?e:[e]}function J(e){if(Array.isArray(e.projects)&&e.projects.forEach(function(e){e.namespace=W(e.namespace),e.apiKey=e.apiKey||e.api_key}),!e.projects){var t,n,i,r,o,a,s,c,u=e.clientOptions||{},h=u.api_key,p=u.apiKey,f=u.namespace,d=(e.nodeOptions||{}).projectName;e.projects=W({projectName:d,apiKey:p||h,namespace:W(f||(null===(c=e.intlOptions)||void 0===c?void 0:c.ns))})}var g=!(null===(r=e.intlOptions)||void 0===r?void 0:r.defaultNS);if(e.intlOptions=(0,l._)({},q,e.intlOptions),e.intlOptions){e.intlOptions.ns=(_=e.projects)?1===_.length?_[0].namespace:_.reduce(function(e,t){return e.concat(W(t.namespace).map(function(e){return"".concat(t.projectName,"_").concat(e)}))},[]):[],g&&(e.intlOptions.defaultNS=null===(i=e.intlOptions)||void 0===i?void 0:null===(n=i.ns)||void 0===n?void 0:n[0]);var _,m=e.intlOptions.fallbackLng;m&&("string"==typeof m?t=[m]:Array.isArray(m)&&(t=m))}return{mode:e.mode,disableDefaultRequest:e.disableDefaultRequest,starling:{disableExportResourceToWindow:e.disableExportResourceToWindow,projects:e.projects,clientOptions:e.clientOptions||{},nodeOptions:(0,D._)((0,l._)({},e.nodeOptions||{}),{enableOptimizeResourceHandle:e.enableOptimizeResourceHandle})},fallback:{enableRequestFallbackLng:e.enableRequestFallbackLng||!1,fallbackLangs:(null===(o=e.clientOptions)||void 0===o?void 0:o.fallbackLang)||(null===(s=e.nodeOptions)||void 0===s?void 0:null===(a=s.options)||void 0===a?void 0:a.fallbackLangs)||t||[]},intlOptions:e.intlOptions||{},disableLanguageDetect:e.disableLanguageDetect}}var F=(0,E.createContext)({I18n:V}),X=F.Provider;F.Consumer;var Y=new d.EventEmitter,Z="__EDENX_LANGUAGE_EVENT",Q={I18n:V,withTranslation:_.withTranslation,useTranslation:m.useTranslation,changeLanguage:function(e){return e.locale,Promise.resolve()},starlingLoadWithLng:function(e){return Promise.resolve()},addResourceToI18n:function(){}},ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:"@edenx/plugin-starling-intl",post:["@edenx/plugin-ssr-compat","@edenx/i18n-common"],pre:["@edenx/plugin-router"],usePlugins:[{name:"@edenx/i18n-common",post:["@edenx/plugin-ssr-compat"],pre:["@edenx/plugin-router"],registryHooks:{resolveI18nConfig:S,resolveI18nInstance:k},setup:function(e){var t,n,i,r,o={config:{},i18n:{}},a="",s=(t=(0,u._)(function(e,t){var n,i,s,c,l,p,f,d,g,_,m,v,y;return(0,h.__generator)(this,function(b){switch(b.label){case 0:return[4,r];case 1:var E;if(b.sent(),n=e.isBrowser,i=o.i18n,c=(s=o.config).disableDefaultRequest,l=s.mode,p=s.starling,f=s.fallback,d=s.intlOptions,g=s.i18nOptions,n?i.changeLanguage():(m=e.ssrContext,v=(null===(_=i.services.languageDetector)||void 0===_?void 0:_.detect(m.request,{}))||(d||g).lng||"en",i.language=v),E=(0,u._)(function(){var t,r,o,a,s,u;return(0,h.__generator)(this,function(h){switch(h.label){case 0:if(c||"offline"===l)return[2];if(n)return[3,2];return a=(o=e.ssrContext).reporter,s=o.logger,[4,P(e,i,p,i.language,f,{reporter:a,logger:s})];case 1:case 3:return h.sent(),[2];case 2:if((null==(u=null===(r=window._SSR_DATA)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.i18nData)?void 0:u.resources)&&Object.keys(null==u?void 0:u.resources).length)return[2];return[4,x(p,i.language,f,{addResourceBundle:i.addResourceBundle.bind(i),hasResourceBundle:i.hasResourceBundle.bind(i),getResourceBundle:i.getResourceBundle.bind(i)})]}})}),y=function(){return E.apply(this,arguments)},a&&a!==t)return[2];return[4,y()];case 2:return b.sent(),a=t,[2]}})}),function(e,n){return t.apply(this,arguments)});e.onBeforeCreateRoutes&&e.onBeforeCreateRoutes((n=(0,u._)(function(e){return(0,h.__generator)(this,function(t){switch(t.label){case 0:return[4,s(e,"beforeCreateRoutes")];case 1:return t.sent(),[2]}})}),function(e){return n.apply(this,arguments)})),e.onBeforeRender((i=(0,u._)(function(e){return(0,h.__generator)(this,function(t){switch(t.label){case 0:return[4,s(e,"beforeRender")];case 1:return t.sent(),[2]}})}),function(e){return i.apply(this,arguments)})),e.wrapRoot(function(t){var n=e.getHooks();return r=Promise.all([n.resolveI18nConfig.call(o),n.resolveI18nInstance.call(o)]),function(e){var n,i,r=o.i18n,a=(0,E.useContext)(y.RuntimeReactContext),s=a.context,c=null===(i=null!==(n=null==s?void 0:s.isBrowser)&&void 0!==n?n:a.isBrowser)||void 0===i||i,u=(0,E.useMemo)(function(){return{_i18n:{loading:!1,error:null,resources:r.getDataByLanguage(r.language),lng:r.language}}},[]),h=(0,v._)((0,E.useState)(u),2),f=h[0],d=h[1];(0,E.useEffect)(function(){var e=function(e){d(e)};return j.on(U,e),function(){j.off(U,e)}},[]),c||(r.translator.language=r.language);var g=E.isValidElement(t);return(0,p.jsx)(b.I18nextProvider,{i18n:r,children:(0,p.jsx)(L,{value:f._i18n,children:g?(0,p.jsx)(t,(0,l._)({},e,f)):(0,p.jsx)(t,(0,l._)({},e))})})}})}}],setup:function(t){var n,i,r,o;t.resolveI18nConfig(function(r){var o=t.getRuntimeConfig(),a=(0,f.merge)((null==o?void 0:o.intl)||{},e);i=(0,g.default)(a),n=J(a||{}),r.config=n}),t.resolveI18nInstance((r=(0,u._)(function(e){var t,i;return(0,h.__generator)(this,function(r){switch(r.label){case 0:if(t=n.disableLanguageDetect,i=n.intlOptions,V.i18nInstance.instance.isInitialized)return[3,2];return[4,H(i,t)];case 1:r.sent(),r.label=2;case 2:return e.i18n=V.i18nInstance.instance,[2]}})}),function(e){return r.apply(this,arguments)})),t.onBeforeRender((o=(0,u._)(function(e){var t,r,o,a,s;return(0,h.__generator)(this,function(c){var p,f,d;return t=e.isBrowser,r=n.mode,o=n.starling,a=n.fallback,p=(0,u._)(function(e,n,i){var o,s,c,u,l,p,f,d;return(0,h.__generator)(this,function(h){switch(h.label){case 0:if(o=null,"offline"!==r)return[3,1];return V.setLang(n),[3,5];case 1:if(!t)return[3,3];if(u=null===(c=window._SSR_DATA)||void 0===c?void 0:null===(s=c.data)||void 0===s?void 0:s.i18nData,n&&(null==u?void 0:u.resources)&&(null==u?void 0:u.resources[n]))return V.setLang(n),[2];return Y.emit(Z,{_i18n:{loading:!0,error:null,resources:null,lng:n}}),[4,x(e,n,a,{addResourceBundle:(l=V.i18nInstance.instance).addResourceBundle.bind(l),hasResourceBundle:l.hasResourceBundle.bind(l),getResourceBundle:l.getResourceBundle.bind(l)})];case 2:return o=h.sent().resources,V.setLang(n),[3,5];case 3:return f=(p=i.ssrContext).reporter,d=p.logger,[4,P(i,V.i18nInstance.instance,e,n,a,{reporter:f,logger:d})];case 4:h.sent(),V.setLang(n),h.label=5;case 5:return Y.emit(Z,{_i18n:{loading:!1,error:null,resources:o?o[n]:null,lng:n}}),[2]}})}),s=function(e,t,n){return p.apply(this,arguments)},Q.starlingLoadWithLng=(f=(0,u._)(function(t,n,r){var o;return(0,h.__generator)(this,function(a){return o=r||e,[2,s(J((0,l._)({},i,t)).starling,n||V.language,o)]})}),function(e,t,n){return f.apply(this,arguments)}),Q.addResourceToI18n=function(n,i,r,o,a,s){var c=s||e;t?V.addResourceBundle(n,i,r,o,a):(V.addResourceBundle(n,i,r,o,a),z(c,V.i18nInstance.instance,n))},Q.changeLanguage=(d=(0,u._)(function(t,n){var i,r;return(0,h.__generator)(this,function(a){return i=t.locale,r=n||e,[2,s(o,i||V.language,r)]})}),function(e,t){return d.apply(this,arguments)}),[2]})}),function(e){return o.apply(this,arguments)})),t.wrapRoot(function(e){return function(t){return(0,p.jsx)(X,{value:{I18n:V},children:(0,p.jsx)(e,(0,l._)({},t))})}})}}}},727643:function(e,t){var n,i=function(e,t){return(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},a=function(){return(a=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function s(e,t,n,i){return new(n||(n=Promise))(function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((i=i.apply(e,t||[])).next())})}function c(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var u=function(e){function t(t,n,i){var r=e.call(this,n)||this;return r.code=t,r.message=n,r.originError=i,r.name="StarlingError",r.code=t,r.message=n,r.originError=i,Error.captureStackTrace&&Error.captureStackTrace(r,r.constructor),r}return!function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t}(Error),l={API_PARAMS_ERROR:{ERROR_CODE:103,ERROR_MESSAGE:"Request failed, confirm your apiKey and namespace is correct"},PARAMS_ERROR:{ERROR_CODE:110,ERROR_MESSAGE:"Check your params, parameter apiKey, namespace and zoneHost is required!"},PARAMS_ERROR_2:{ERROR_CODE:111,ERROR_MESSAGE:"Check your params, parameter request and store is required!"},CACHE_ERROR:{ERROR_CODE:112,ERROR_MESSAGE:"Cache error!"},VERSION_NOT_FOUND:{ERROR_CODE:120,ERROR_MESSAGE:"Version is not found, please check your param [version]!"}},h={zone:"CN",locale:"zh",timeout:15e3,test:!1,mode:"normal",format:"merged",lazyUpdate:!1,fallbackLang:["zh"],tracker:function(){},cache:!0},p=function(){function e(e){this.options=e,this.options=e}return e.prototype.getText=function(e,t){return s(this,void 0,void 0,function(){return c(this,function(n){switch(n.label){case 0:return[4,this._request(e,t)];case 1:return[2,n.sent()]}})})},e.prototype.getTexts=function(e){var t=this;return Promise.all(e.map(function(e){var n=e[0],i=e[1];return t.getText(n,i)}))},e.prototype._request=function(e,t){return s(this,void 0,void 0,function(){var n,i,r,o,a,s,h,p;return c(this,function(c){switch(c.label){case 0:if(n=(0,this.options.getReleaseVersion)(e),e&&n&&t)return[2,{}];return i=this.getUrl(e,t),[4,(0,(r=this.options).request)(i,{timeout:r.timeout})];case 1:if(a=(o=c.sent().data).status,s=o.message,200==+a)return[2,this._mapResponse(s)];if(1001==+a)throw new u((h=l.VERSION_NOT_FOUND).ERROR_CODE,h.ERROR_MESSAGE);throw new u((p=l.API_PARAMS_ERROR).ERROR_CODE,p.ERROR_MESSAGE)}})})},e.prototype.getUrl=function(e,t){var n=this.options,i=n.apiKey,r=n.locale,o=n.fallbackLang,a=n.zoneHost,s=n.mode,c=n.getReleaseVersion,u=[r].concat(o),l=a+"/check_and_get_text/"+i+"/"+s+"/"+e+"?lang="+u,h=c(e);return h&&(l=a+"/text_by_release_version/"+i+"/"+s+"/"+e+"/"+h+"?lang="+u),"string"==typeof t&&(l+="&version="+t),l},e.prototype._mapResponse=function(e){return e?Object.keys(e).reduce(function(t,n){return t[n.toLowerCase()]=e[n],t},{}):{}},e}(),f=function(){function e(e){this.options=e,this.options=e}return e.prototype._setCache=function(e,t){try{return this.options.store.set(e,t)}catch(e){var n=l.CACHE_ERROR.ERROR_CODE;this.options.tracker("cache_error",{code:n,message:e.message,stack:e.stack});return}},e.prototype._getCache=function(e){var t=this.options,n=t.store,i=t.cache;try{return i&&n.get(e)}catch(e){var r=l.CACHE_ERROR.ERROR_CODE;this.options.tracker("cache_error",{code:r,message:e.message,stack:e.stack});return}},e.prototype.getVersion=function(e){var t=this.options,n=t.apiKey,i=t.locale,r=t.getReleaseVersion,o="version."+n+"."+e+"."+i,a=r(e);return(a&&(o+="."+a),this.getText(e))?this._getCache(o):null},e.prototype.getVersions=function(e){var t=this;return Promise.all(e.map(function(e){return t.getVersion(e)}))},e.prototype.getText=function(e){var t=this.options,n=t.apiKey,i=t.locale,r=t.getReleaseVersion,o="text."+n+"."+e+"."+i,a=r(e);return a&&(o+="."+a),this._getCache(o)},e.prototype.getTexts=function(e){var t=this;return Promise.all(e.map(function(e){return t.getText(e)}))},e.prototype.refresh=function(e,t,n,i){return s(this,void 0,void 0,function(){var r,o,a,s,u,l=this;return c(this,function(c){switch(c.label){case 0:return o=(r=this.options).apiKey,a=r.getReleaseVersion,s=r.cache,u=[],t.forEach(function(r,c){var h="text."+o+"."+e[c]+"."+i[c],p="version."+o+"."+e[c]+"."+i[c],f=a(e[c]);f&&(h+="."+f,p+="."+f),s&&(u.push(l._setCache(h,t[c])),u.push(l._setCache(p,n[c])))}),[4,Promise.all(u)];case 1:return c.sent(),[2,t.reduce(function(e,t){return Object.assign(e,t)},{})]}})})},e}(),d=function(){function e(e){void 0===e&&(e=[]),this._list=[],this._list=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),e.prototype.getList=function(){return this._list},e.prototype.getNamespaces=function(){return this._list.map(function(e){return e.namespace})},e.prototype.addNamespace=function(e){this._list.push(e)},e.prototype.insertTexts=function(e){this._list.forEach(function(t,n){t.texts=e[n]})},e.prototype.sortByPrior=function(){return this._list.sort(function(e,t){return e.prior-t.prior}),this._list},e.prototype.concat=function(t){return new e(this._list.concat(t.getList()))},e}(),g=function(){function e(e,t,n){this._promiseRefresh=Promise.resolve(null),this.remote=e,this.local=t,this.options=n}return e.prototype._checkVersions=function(e){return s(this,void 0,void 0,function(){var t,n,i,r,o,a;return c(this,function(s){switch(s.label){case 0:return t=this.options.locale,[4,this.local.getVersions(e)];case 1:return n=s.sent(),i=e.map(function(e,t){return[e,n[t]]}),[4,this.remote.getTexts(i)];case 2:return r=s.sent(),o=new d,a=new d,e.forEach(function(e,i){var s=r[i],c=s.updated,u=s.version,l=s.data,h=s.lang;c?a.addNamespace({namespace:e,prior:i,version:u,texts:l,lang:h}):o.addNamespace({namespace:e,prior:i,version:n[i],lang:t})}),[2,{equalNs:o,diffNs:a}]}})})},e.prototype.waitForRefresh=function(){return this._promiseRefresh},e.prototype._refresh=function(e){var t=e.getList(),n=[],i=[],r=[],o=[];return t.forEach(function(e){n.push(e.namespace),i.push(e.version),r.push(e.texts),o.push(e.lang)}),this.local.refresh(n,r,i,o)},e.prototype._getLocalTexts=function(e){return s(this,void 0,void 0,function(){var t;return c(this,function(n){switch(n.label){case 0:return[4,this.local.getTexts(e.getNamespaces())];case 1:return t=n.sent(),e.insertTexts(t),[2,t]}})})},e.prototype.load=function(e){return s(this,void 0,void 0,function(){var t,n,i,r,o,a;return c(this,function(a){switch(a.label){case 0:return t=this.options.format,[4,this._checkVersions(e)];case 1:if(i=(n=a.sent()).equalNs,r=n.diffNs,!i.length)return[3,3];return[4,this._getLocalTexts(i)];case 2:return a.sent(),[3,4];case 3:a.label=4;case 4:if(o=this._formatTexts(t,r.concat(i)),!r.length)return[3,6];return[4,this._refresh(r)];case 5:a.sent(),a.label=6;case 6:return[2,{texts:o,diffNs:r.getNamespaces(),equalNs:i.getNamespaces()}]}})})},e.prototype._getCacheText=function(e){return s(this,void 0,void 0,function(){var t,n,i,r,o,a;return c(this,function(s){switch(s.label){case 0:return n=(t=this.options).locale,i=t.format,[4,this.local.getTexts(e)];case 1:return r=s.sent(),[4,this.local.getVersions(e)];case 2:return o=s.sent(),a=new d(r.map(function(t,i){if(t)return{namespace:e[i],version:o[i],lang:n,texts:t}}).filter(function(e){return!!e})),[2,this._formatTexts(i,a)]}})})},e.prototype.lazyLoad=function(e){return s(this,void 0,void 0,function(){var t,n,i;return c(this,function(r){switch(r.label){case 0:return[4,this._getCacheText(e)];case 1:if(n=0===Object.keys(t=r.sent()).length,this._promiseRefresh=this.load(e),!n)return[3,3];return[4,this._promiseRefresh];case 2:t=(i=r.sent()).texts,r.label=3;case 3:return[2,{texts:t,diffNs:n?i&&i.diffNs:[],equalNs:n?i&&i.equalNs:e}]}})})},e.prototype._formatTexts=function(e,t){return"splitted"===e?t.getList().reduce(function(e,t){var n=t.namespace,i=t.lang,r=t.texts,o=t.version;return e[n]={lang:i,texts:r,version:o},e},{}):t.sortByPrior().map(function(e){return e.texts}).reduce(function(e,t){return Object.assign(e,t)},{})},e}();"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e){if(null==e)throw TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},writable:!0,configurable:!0});var _={EVENT_EXCEPTION:"client_exception",EVENT_LOAD:"client_load",EVENT_CACHE:"client_cache",EVENT_LOAD_TIME:"client_load_time"};(D||(D={})).AfterLoad="afterLoad";var m=function(){function e(e){this.afterLoadPlugins=[],this.setConfig(e)}return e.prototype._init=function(e){var t=this;this.options=function(e){var t=(e=Object.assign({},h,e)).namespace,n=e.apiKey,i=e.request,r=e.store,o=e.zoneHost;if(e.test&&(e.mode="test"),e.namespace=t=t?Array.isArray(t)?t:[t]:[],e.apiKey=n=n||e.api_key,!i||!r){var a=l.PARAMS_ERROR_2,s=a.ERROR_CODE,c=a.ERROR_MESSAGE;throw new u(s,c,null)}if(!n||!t.length||!o){var p=l.PARAMS_ERROR,s=p.ERROR_CODE,c=p.ERROR_MESSAGE;throw new u(s,c,null)}return e}(e);var n=this.options,i=n.apiKey,r=n.locale,o=n.zoneHost,s=n.request,c=n.timeout,d=n.fallbackLang,_=n.store,m=n.lazyUpdate,v=n.test,y=n.mode,b=n.format,E=n.cache,w={mode:m?"lazy":v?"test":"prod",zone:o,locale:r,apiKey:i};this._tracker=function(e,n){try{t.options.tracker(e,a(a({},w),n))}catch(e){}};var S=this._getReleaseVersionByNamespace.bind(this),k=new p({request:s,timeout:c,apiKey:i,locale:r,zoneHost:o,fallbackLang:d,mode:y,getReleaseVersion:S}),A=new f({apiKey:i,locale:r,store:_,tracker:this._tracker,getReleaseVersion:S,cache:E});this._textManager=new g(k,A,{locale:r,format:b}),this.initPlugin()},e.prototype.initPlugin=function(){var e=this,t=this.options.plugins||[];Array.isArray(t)&&t.every(function(e){return"object"==typeof e})&&t.forEach(function(t){t.type===D.AfterLoad&&e.afterLoadPlugins.push(t)})},e.prototype._getReleaseVersionByNamespace=function(e){var t=this.options.namespace,n=this.options.version,i=null;return Array.isArray(n)?i=n[t.findIndex(function(t){return t===e})]:n&&"object"==typeof n?i=n[e]:"string"==typeof n&&(i=n),i},e.prototype.setConfig=function(e){var t=Object.assign({},this.options,e);this._init(t)},e.prototype.waitForRefresh=function(){return s(this,void 0,void 0,function(){var e;return c(this,function(t){switch(t.label){case 0:return[4,this._textManager.waitForRefresh()];case 1:return[2,(e=t.sent())?e.texts:null]}})})},e.prototype._load=function(){return s(this,void 0,void 0,function(){var e,t,n,i,r;return c(this,function(o){switch(o.label){case 0:if(t=(e=this.options).namespace,n=e.lazyUpdate,i=t,!n)return[3,2];return[4,this._textManager.lazyLoad(i)];case 1:return r=o.sent(),[3,4];case 2:return[4,this._textManager.load(i)];case 3:r=o.sent(),o.label=4;case 4:return[2,r]}})})},e.prototype.load=function(e,t){return s(this,void 0,void 0,function(){var n,i,r,o,a,s,u,l,h,p,f,d,g,m=this;return c(this,function(c){switch(c.label){case 0:n=Date.now(),i=this.options.namespace,c.label=1;case 1:return c.trys.push([1,5,,10]),this._tracker(_.EVENT_LOAD,{state:"start",version:"0.5.9"}),[4,this._load()];case 2:if(o=(r=c.sent()).diffNs,a=r.equalNs,s=r.texts,!(Array.isArray(u=this.afterLoadPlugins)&&u.length))return[3,4];return[4,u.reduce(function(e,t){return e.then(function(e){return"function"==typeof t.process?t.process(e||s,m.options):e})},Promise.resolve(s))];case 3:s=c.sent()||s,c.label=4;case 4:return e&&e(s),this._tracker(_.EVENT_LOAD_TIME,{time:Date.now()-n}),this._tracker(_.EVENT_LOAD,{state:"success",version:"0.5.9"}),l=o.length,f=((h=a.length)/(p=i.length)).toFixed(2),this._tracker(_.EVENT_CACHE,{diffLen:l,diff:o.join(","),equalLen:h,equal:a.join(","),namespaces:a.join(","),namespacesLen:p,ratio:f}),[2,s];case 5:if(d=c.sent(),this._tracker(_.EVENT_LOAD,{state:"fail"}),this._tracker(_.EVENT_EXCEPTION,{code:d.code,message:d.message,stack:d.stack}),!(d||{}).useWebCache)return[3,9];c.label=6;case 6:return c.trys.push([6,8,,9]),[4,this._textManager._getCacheText(i)];case 7:return(g=c.sent())&&"object"==typeof g?d.response.data=g:d.response.data={},[3,9];case 8:return c.sent(),[3,9];case 9:if(!t)return[2,Promise.reject(d)];return t(d),[3,10];case 10:return[2]}})})},e}(),v=new(function(){function e(){}return e.prototype.get=function(e){if(localStorage&&localStorage.getItem)return function(e){if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e||void 0}}(localStorage.getItem(e))},e.prototype.set=function(e,t){localStorage&&localStorage.setItem&&localStorage.setItem(e,JSON.stringify(t))},e}()),y=function(e){function t(t,n,i,r,o,a){var s=e.call(this,t)||this;return s.url=n,s.code=i,s.request=r,s.response=o,s.useWebCache=a,s.url=n,s.code=i,s.request=r,s.response=o,s.useWebCache=!!a,s}return r(t,e),t}(Error);function b(e,t){var n=t.timeout;return new Promise(function(t,i){var r=new XMLHttpRequest;r.open("GET",e),r.withCredentials=!1,r.onreadystatechange=function(){if(r&&4===r.readyState&&(0!==r.status||r.responseURL&&0===r.responseURL.indexOf("file:"))){var n,o,a=function(e){try{return JSON.parse(e)}catch(e){return{}}}(r.responseText),s=a.message&&"object"==typeof a.message?a:null;if(r.status<200||r.status>=300||!s){n=r,o=(o=(a||{}).message||"")?", reason is: ".concat(o):"",i(new y("Request failed with status code "+n.status+o,e,null,n,{data:{}},!0)),r=null;return}t({data:s,status:r.status,statusText:r.statusText,request:r}),r=null}},r.onerror=function(){i(new y("Network Error",e,null,r,{data:{}},!0)),r=null},r.timeout=n,r.ontimeout=function(){i(new y("timeout of "+n+"ms exceeded",e,"ECONNABORTED",r)),r=null},r.send()})}var E=function(e){function t(t){var n=this;return t.store||(t.store=v),t.request||(t.request=b),e.call(this,t)||this}return r(t,e),t}(m),w=function(){return(w=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function S(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function k(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function A(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(k(arguments[t]));return e}var D,T,R=function(){function e(){this._hooks={},this._cache=[],this._hooksCache={}}return e.prototype.on=function(e,t){e&&t&&"function"==typeof t&&(this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t))},e.prototype.once=function(e,t){var n=this;e&&t&&"function"==typeof t&&this.on(e,function i(r){t(r),n.off(e,i)})},e.prototype.off=function(e,t){if(e&&this._hooks[e]&&this._hooks[e].length){if(t){var n=this._hooks[e].indexOf(t);-1!==n&&this._hooks[e].splice(n,1)}else this._hooks[e]=[]}},e.prototype.emit=function(e,t,n){n?!e||(-1!==this._cache.indexOf(n)?this._emit(e,t):(this._hooksCache.hasOwnProperty(n)||(this._hooksCache[n]={}),this._hooksCache[n].hasOwnProperty(e)||(this._hooksCache[n][e]=[]),this._hooksCache[n][e].push(t))):this._emit(e,t)},e.prototype._emit=function(e,t){e&&this._hooks[e]&&this._hooks[e].length&&A(this._hooks[e]).forEach(function(e){try{e(t)}catch(e){}})},e.prototype.set=function(e){e&&-1===this._cache.indexOf(e)&&this._cache.push(e)},e}(),O=function(e){return null!=e&&"[object Object]"==Object.prototype.toString.call(e)},M=function(e){return Array.isArray(e)},C=(T=+Date.now()+Number((""+Math.random()).slice(2,8)),function(){return T+=1}),I=function(e){return function(e,t,n){if("string"==typeof e&&"number"==typeof n){var i,r=[],o=String.fromCharCode((n=n<=25?n:n%25)+97);i=e.split(o);for(var a=0;a<i.length;a++){var s=parseInt(i[a],n),c=String.fromCharCode(s=64^+s);r.push(c)}return r.join("")}}(e,64,25)},G=function(e){navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.addEventListener("pagehide",e,!1):window.addEventListener("beforeunload",e,!1)},x=function(e,t,n){var i=document.createElement("script");i.src=e,i.onerror=function(){n(e)},i.onload=function(){t()},document.getElementsByTagName("head")[0].appendChild(i)},N=function(){var e=0;return["hidden","msHidden","webkitHidden"].forEach(function(t){void 0!==document[t]&&(e=1)}),e},z=function(e,t){void 0===e&&(e=function(){}),void 0===t&&(t=1e3);var n,i=Date.now()+t;return n=window.setTimeout(function r(){var o=Date.now()-i;e(),i+=t,n=window.setTimeout(r,Math.max(0,t-o))},t),function(){window.clearTimeout(n)}},P=function(e){var t=document.createElement("a");return t.href=e,t},B=function(e){var t={};try{var n=P(e).search;(n=n.slice(1)).split("&").forEach(function(e){var n,i,r=e.split("=");r.length&&(n=r[0],i=r[1]);try{t[n]=decodeURIComponent(void 0===i?"":i)}catch(e){t[n]=i}})}catch(e){}return t},L=function(e){for(var t=0,n=0,i=(e+="").length,r=0;r<i;r++)((t=31*t+e.charCodeAt(n++))>0x7fffffffffff||t<-0x800000000000)&&(t&=0xffffffffffff);return t<0&&(t+=0x7ffffffffffff),t};function U(e,t){return e(t={exports:{}},t.exports),t.exports}var j,V,K=U(function(e,t){var n;n=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(i){function r(){}function o(t,n,o){if("undefined"!=typeof document){"number"==typeof(o=e({path:"/"},r.defaults,o)).expires&&(o.expires=new Date(+new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var a=JSON.stringify(n);/^[\{\[]/.test(a)&&(n=a)}catch(e){}n=i.write?i.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in o)o[c]&&(s+="; "+c,!0!==o[c]&&(s+="="+o[c].split(";")[0]));return document.cookie=t+"="+n+s}}function a(e,n){if("undefined"!=typeof document){for(var r={},o=document.cookie?document.cookie.split("; "):[],a=0;a<o.length;a++){var s=o[a].split("="),c=s.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=t(s[0]);if(c=(i.read||i)(c,u)||t(c),n)try{c=JSON.parse(c)}catch(e){}if(r[u]=c,e===u)break}catch(e){}}return e?r[e]:r}}return r.set=o,r.get=function(e){return a(e,!1)},r.getJSON=function(e){return a(e,!0)},r.remove=function(t,n){o(t,"",e(n,{expires:-1}))},r.defaults={},r.withConverter=n,r}(function(){})},e.exports=n()}),$=function(e,t){try{return K.get(e,{domain:t||document.domain})}catch(e){return""}},q=function(e,t,n,i){try{var r=i||document.domain,o=+new Date+(n||6048e5);K.set(e,t,{expires:new Date(o),path:"/",domain:r})}catch(e){}},H=function(){function e(){this.cache={}}return e.prototype.setItem=function(e,t){this.cache[e]=t},e.prototype.getItem=function(e){return this.cache[e]},e.prototype.removeItem=function(e){this.cache[e]=void 0},e.prototype.getCookie=function(e,t){return $(e,t)},e.prototype.setCookie=function(e,t,n,i){q(e,t,n,i)},e}(),W={getItem:function(e){try{var t=localStorage.getItem(e),n=t;try{t&&"string"==typeof t&&(n=JSON.parse(t))}catch(e){}return n||{}}catch(e){}return{}},setItem:function(e,t){try{var n="string"==typeof t?t:JSON.stringify(t);localStorage.setItem(e,n)}catch(e){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){return $(e,t)},setCookie:function(e,t,n,i){q(e,t,n,i)},isSupportLS:function(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}()},J={getItem:function(e){try{var t=sessionStorage.getItem(e),n=t;try{t&&"string"==typeof t&&(n=JSON.parse(t))}catch(e){}return n||{}}catch(e){}return{}},setItem:function(e,t){try{var n="string"==typeof t?t:JSON.stringify(t);sessionStorage.setItem(e,n)}catch(e){}},removeItem:function(e){try{sessionStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){return $(e,t)},setCookie:function(e,t,n,i){q(e,t,n,i)},isSupportSession:function(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}()},F=function(){function e(e,t){this._storage=t&&"session"===t?J:!e&&W.isSupportLS?W:new H}return e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t)},e.prototype.getCookie=function(e,t){return this._storage.getCookie(e,t)},e.prototype.setCookie=function(e,t,n,i){this._storage.setCookie(e,t,n,i)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e}(),X=function(){function e(e,t,n){this.appid=e,this.domain=t,this.userAgent=window.navigator.userAgent,this.appVersion=window.navigator.appVersion,this.cookie_expire=n}return e.prototype.init=function(){var e=window.navigator.userAgent,t=window.navigator.language,n=document.referrer,i=n?P(n).hostname:"",r=B(window.location.href),o=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(this.appVersion)?"wap":"web";this.utm=function(e,t,n,i){var r=new F(!1),o=new F(!1,"session"),a=e?"_tea_utm_cache_"+e:"_tea_utm_cache",s=e?"_$utm_from_url_"+e:"_$utm_from_url",c={},u=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],l={ad_id:Number(t.ad_id)||void 0,campaign_id:Number(t.campaign_id)||void 0,creative_id:Number(t.creative_id)||void 0,utm_source:t.utm_source,utm_medium:t.utm_medium,utm_campaign:t.utm_campaign,utm_term:t.utm_term,utm_content:t.utm_content,tr_shareuser:t.tr_shareuser,tr_admaster:t.tr_admaster,tr_param1:t.tr_param1,tr_param2:t.tr_param2,tr_param3:t.tr_param3,tr_param4:t.tr_param4};try{var h=!1;for(var p in l)l[p]&&(-1!==u.indexOf(p)?(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data[p]=l[p]):c[p]=l[p],h=!0);if(h)o.setItem(s,"1"),r.setCookie(a,JSON.stringify(c),i,n);else{var f=r.getCookie(a,n);f&&(c=JSON.parse(f))}o.getItem(s)&&(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data.$utm_from_url=1)}catch(e){return l}return c}(this.appid,r,this.domain,this.cookie_expire);var a=this.browser(),s=this.os();return{browser:a.browser,browser_version:a.browser_version,platform:o,os_name:s.os_name,os_version:s.os_version,userAgent:e,screen_width:window.screen&&window.screen.width,screen_height:window.screen&&window.screen.height,device_model:this.getDeviceModel(s.os_name),language:t,referrer:n,referrer_host:i,utm:this.utm,latest_data:this.last(n,i)}},e.prototype.last=function(e,t){var n="",i="",r="",o=location.hostname,a=!1;if(e&&t&&o!==t){n=e,i=t,a=!0;var s=B(e);s.keyword&&(r=s.keyword)}return{$latest_referrer:n,$latest_referrer_host:i,$latest_search_keyword:r,isLast:a}},e.prototype.browser=function(){var e,t,n="",i=""+parseFloat(this.appVersion),r=this.userAgent;return -1!==r.indexOf("Edge")||-1!==r.indexOf("Edg")?(n="Microsoft Edge",-1!==r.indexOf("Edge")?(e=r.indexOf("Edge"),i=r.substring(e+5)):(e=r.indexOf("Edg"),i=r.substring(e+4))):-1!==(e=r.indexOf("MSIE"))?(n="Microsoft Internet Explorer",i=r.substring(e+5)):-1!==r.indexOf("Chrome")?-1!==(e=r.indexOf("TTWebView"))?(n="TTWebView",i=r.substring(e+10,e+23)):-1!==(e=r.indexOf("Chrome"))?(n="Chrome",i=r.substring(e+7)):-1!==(e=r.indexOf("Chrome"))&&(n="Chrome",i=r.substring(e+7)):-1!==r.indexOf("Safari")?-1!==(e=r.indexOf("Safari"))&&(n="Safari",i=r.substring(e+7),-1!==(e=r.indexOf("Version"))&&(i=r.substring(e+8))):-1!==(e=r.indexOf("Firefox"))&&(n="Firefox",i=r.substring(e+8)),-1!==(t=i.indexOf(";"))&&(i=i.substring(0,t)),-1!==(t=i.indexOf(" "))&&(i=i.substring(0,t)),-1!==(t=i.indexOf(")"))&&(i=i.substring(0,t)),{browser:n,browser_version:i}},e.prototype.os=function(){for(var e,t,n="",i="",r=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/}],o=0;o<r.length;o++){var a=r[o];if(a.r.test(this.userAgent)){"Mac OS X"===(n=a.s)&&this.isNewIpad()&&(n="iOS");break}}var s=function(e,t){var n=e.exec(t);return n&&n[1]?n[1]:""},c=function(e,t){var n=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:"+e+")","i").exec(t);return n?n.slice(1)[0]:""};switch(/Windows/.test(n)&&(i=s(/Windows (.*)/,n),n="windows"),n){case"Mac OS X":i=c("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent),n="mac";break;case"Android":(t=s(/Android ([\.\_\d]+)/,e=this.userAgent))||(t=s(/Android\/([\.\_\d]+)/,e)),i=t,n="android";break;case"iOS":i=this.isNewIpad()?c("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent):(i=/OS (\d+)_(\d+)_?(\d+)?/.exec(this.appVersion))?i[1]+"."+i[2]+"."+(0|i[3]):"",n="ios"}return{os_name:n,os_version:i}},e.prototype.getDeviceModel=function(e){var t="";try{if("android"===e)navigator.userAgent.split(";").forEach(function(e){e.indexOf("Build/")>-1&&(t=e.slice(0,e.indexOf("Build/")))});else if("ios"===e||"mac"===e||"windows"===e){if(this.isNewIpad())t="iPad";else{var n=navigator.userAgent.replace("Mozilla/5.0 (",""),i=n.indexOf(";");t=n.slice(0,i)}}}catch(e){}return t.trim()},e.prototype.isNewIpad=function(){return void 0!==this.userAgent&&"MacIntel"===navigator.platform&&"number"==typeof navigator.maxTouchPoints&&navigator.maxTouchPoints>1},e}(),Y={sg:"1fz22z22z1nz21z4mz4bz4bz21z1ez18z1jz1gz49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz18z1jz1gz24z18z49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k"},Z={va:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",in:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k"},Q={sg:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z21z1ez4az22z1gz1iz22z1mz1iz24z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z24z18z4az22z1gz1iz22z1mz1iz24z4az1az1mz1k",in:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z24z18z49z23z21z1cz18z21z22z4ez18z4az22z1gz1iz22z1mz1iz24z4az1az1mz1k"},ee={sg:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az23z21z4az22z1gz1iz22z1mz1iz24z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az23z21z4az22z1gz1iz22z1mz1iz4az1az1mz1k"},et="5.1.4_oversea_safe",en=function(){function e(e,t){this.collector=e,this.config=t,this.eventNameWhiteList=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure"],this.paramsNameWhiteList=["$inactive","$inline","$target_uuid_list","$source_uuid","$is_spider","$source_id","$is_first_time","_staging_flag"],this.regStr=RegExp("^[a-zA-Z0-9][a-z0-9A-Z_.-]{1,255}$")}return e.prototype.checkVerify=function(e){var t=this;if(!e||!e.length)return!1;var n=e[0];if(!n)return!1;var i=n.events,r=n.header;if(!i||!i.length)return!1;var o=!0;return i.forEach(function(e){if(!e)return o=!1,void(e.checkEvent="\u4E8B\u4EF6\u5F02\u5E38");t.checkEventName(e.event)||(o=!1,e.checkEvent="\u4E8B\u4EF6\u540D\u4E0D\u80FD\u4EE5 $ or __\u5F00\u5934"),t.checkEventParams(e.params)||(o=!1,e.checkParams="\u5C5E\u6027\u540D\u4E0D\u80FD\u4EE5 $ or __\u5F00\u5934")}),this.checkEventParams(r)||(o=!1),o},e.prototype.checkEventName=function(e){return!!e&&this.calculate(e,"event")},e.prototype.checkEventParams=function(e){var t=e;if("string"==typeof e&&(t=JSON.parse(t)),!Object.keys(t).length)return!0;for(var n in t)return!!this.calculate(n,"params")&&!("string"==typeof t[n]&&t[n].length>1024);return!0},e.prototype.calculate=function(e,t){return -1!==("event"===t?this.eventNameWhiteList:this.paramsNameWhiteList).indexOf(e)||!RegExp("^\\$").test(e)&&!RegExp("^__").test(e)},e}();(tn=j||(j={})).Init="init",tn.Config="config",tn.Start="start",tn.Ready="ready",tn.TokenComplete="token-complete",tn.TokenStorage="token-storage",tn.TokenFetch="token-fetch",tn.TokenError="token-error",tn.ConfigUuid="config-uuid",tn.ConfigWebId="config-webid",tn.ConfigDomain="config-domain",tn.CustomWebId="custom-webid",tn.TokenChange="token-change",tn.TokenReset="token-reset",tn.ConfigTransform="config-transform",tn.EnvTransform="env-transform",tn.SessionReset="session-reset",tn.SessionResetTime="session-reset-time",tn.Event="event",tn.Events="events",tn.EventNow="event-now",tn.CleanEvents="clean-events",tn.BeconEvent="becon-event",tn.SubmitBefore="submit-before",tn.SubmitScuess="submit-scuess",tn.SubmitAfter="submit-after",tn.SubmitError="submit-error",tn.SubmitVerify="submit-verify",tn.DestoryInstance="destory-instance",tn.Stay="stay",tn.ResetStay="reset-stay",tn.StayReady="stay-ready",tn.SetStay="set-stay",tn.RouteChange="route-change",tn.RouteReady="route-ready",tn.Ab="ab",tn.AbVar="ab-var",tn.AbAllVars="ab-all-vars",tn.AbConfig="ab-config",tn.AbExternalVersion="ab-external-version",tn.AbVersionChangeOn="ab-version-change-on",tn.AbVersionChangeOff="ab-version-change-off",tn.AbOpenLayer="ab-open-layer",tn.AbCloseLayer="ab-close-layer",tn.AbReady="ab-ready",tn.AbComplete="ab-complete",tn.AbTimeout="ab-timeout",tn.Profile="profile",tn.ProfileSet="profile-set",tn.ProfileSetOnce="profile-set-once",tn.ProfileUnset="profile-unset",tn.ProfileIncrement="profile-increment",tn.ProfileAppend="profile-append",tn.ProfileClear="profile-clear",tn.Autotrack="autotrack",tn.AutotrackReady="autotrack-ready",tn.CepReady="cep-ready",tn.TracerReady="tracer-ready",tn.sessionRecord="session-record",tn.SessionRecordStart="session-record-start",tn.SessionRecordPause="session-record-pause",tn.SessionRecordEnd="session-record-end",tn.SessionRecordReport="session-record-report",tn.VisualCollectReady="visual-collect-ready",tn.VisualApiReady="visual-api-ready",tn.VisualApiUpdate="visual-api-update",(ti=V||(V={})).DEBUGGER_MESSAGE="debugger-message",ti.DEBUGGER_MESSAGE_SDK="debugger-message-sdk",ti.DEBUGGER_MESSAGE_FETCH="debugger-message-fetch",ti.DEBUGGER_MESSAGE_FETCH_RESULT="debugger-message-fetch-result",ti.DEBUGGER_MESSAGE_EVENT="debugger-message-event",ti.DEVTOOL_WEB_READY="devtool-web-ready";var ei=j,er=void 0,eo=(new Date).getTimezoneOffset(),ea=parseInt(""+-eo/60,10),es=60*eo,ec=function(){function e(e,t){this.is_first_time=!0,this.configPersist=!1,this.initConfig=t,this.collect=e;var n=new X(t.app_id,t.cookie_domain||"",t.cookie_expire||6048e5).init();this.eventCheck=new en(e,t);var i="__tea_cache_first_"+t.app_id;this.configKey="__tea_cache_config_"+t.app_id,this.sessionStorage=new F(!1,"session"),this.localStorage=new F(!1,"local"),this.channelUrl="tcpy"===t.channel_type||"ttp"===t.channel_type?{WEBID_URL:"/v1/user/webid",TOB_URL:"",REPORT_URL:"/v1/list"}:{WEBID_URL:"/webid",TOB_URL:"/tobid",REPORT_URL:"/list"},t.configPersist&&(this.configPersist=!0,this.storage=1===t.configPersist?this.sessionStorage:this.localStorage);var r=this.localStorage.getItem(i);r&&1==r?this.is_first_time=!1:(this.is_first_time=!0,this.localStorage.setItem(i,"1")),this.envInfo={user:{user_unique_id:er,user_type:er,user_id:er,user_is_auth:er,user_is_login:er,device_id:er,web_id:er,ip_addr_id:er,user_unique_id_type:er},header:{app_id:er,app_name:er,app_install_id:er,install_id:er,app_package:er,app_channel:er,app_version:er,ab_version:er,os_name:n.os_name,os_version:n.os_version,device_model:n.device_model,ab_client:er,traffic_type:er,client_ip:er,device_brand:er,os_api:er,access:er,language:n.language,region:er,app_language:er,app_region:er,creative_id:n.utm.creative_id,ad_id:n.utm.ad_id,campaign_id:n.utm.campaign_id,log_type:er,rnd:er,platform:n.platform,sdk_version:et,sdk_lib:"js",province:er,city:er,timezone:ea,tz_offset:es,tz_name:er,sim_region:er,carrier:er,resolution:n.screen_width+"x"+n.screen_height,browser:n.browser,browser_version:n.browser_version,referrer:n.referrer,referrer_host:n.referrer_host,width:n.screen_width,height:n.screen_height,screen_width:n.screen_width,screen_height:n.screen_height,utm_term:n.utm.utm_term,utm_content:n.utm.utm_content,utm_source:n.utm.utm_source,utm_medium:n.utm.utm_medium,utm_campaign:n.utm.utm_campaign,tracer_data:JSON.stringify(n.utm.tracer_data),custom:{},wechat_unionid:er,wechat_openid:er}},this.ab_version="",this.ab_uuid_cache={},this.evtParams={},this.reportErrorCallback=function(){},this.isLast=!1,this.setCustom(n),this.initDomain(),this.initABData()}return e.prototype.initDomain=function(e){var t=this.initConfig.channel_domain;if(t)this.domain=t;else{var n=e||this.initConfig.channel,i=this.initConfig&&this.initConfig.channel_type?"tcpy"===this.initConfig.channel_type?Q[n]:ee[n]:Y[n];this.domain=I(i)}},e.prototype.setDomain=function(e){this.customDomain=!0,this.domain=e},e.prototype.getDomain=function(e){return this.customDomain||e&&this.initDomain(e),this.domain},e.prototype.initABData=function(){var e="__tea_sdk_ab_version_"+this.initConfig.app_id,t=null;if(this.initConfig.ab_cross){var n=this.localStorage.getCookie(e,this.initConfig.ab_cookie_domain);t=n?JSON.parse(n):null}else t=this.localStorage.getItem(e);this.setAbCache(t)},e.prototype.setAbCache=function(e){this.ab_cache=e},e.prototype.getAbCache=function(){return this.ab_cache},e.prototype.clearAbCache=function(){this.ab_cache={},this.ab_version=""},e.prototype.setAbVersion=function(e){this.ab_version=e},e.prototype.getAbVersion=function(){return this.ab_version},e.prototype.setAbUuidCache=function(e,t){var n=t||this.envInfo.user.user_unique_id;this.ab_uuid_cache[""+n]||(this.ab_uuid_cache[""+n]=[]),-1===this.ab_uuid_cache[""+n].indexOf(e)&&this.ab_uuid_cache[""+n].push(e)},e.prototype.getAbUuidCache=function(e){return this.ab_uuid_cache[""+e]},e.prototype.getUrl=function(e){var t="";switch(e){case"event":t=this.channelUrl.REPORT_URL;break;case"webid":t=this.channelUrl.WEBID_URL;break;case"tobid":t=this.channelUrl.TOB_URL}var n="";return this.initConfig.caller&&(n="?sdk_version="+et+"&sdk_name=web&app_id="+this.initConfig.app_id+"&caller="+this.initConfig.caller),""+this.getDomain()+t+n},e.prototype.setCustom=function(e){if(e&&e.latest_data&&e.latest_data.isLast)for(var t in delete e.latest_data.isLast,this.isLast=!0,e.latest_data)this.envInfo.header.custom[t]=e.latest_data[t]},e.prototype.setAppid=function(e){this.envInfo.header.app_id=e},e.prototype.set=function(e){var t=this;Object.keys(e).forEach(function(n){void 0!==e[n]&&null!==e[n]||t.delete(n);try{t.eventCheck.calculate(n,"config")}catch(e){}if("traffic_type"===n&&t.isLast&&(t.envInfo.header.custom.$latest_traffic_source_type=e[n]),"evtParams"===n)t.evtParams=w({},t.evtParams||{},e.evtParams||{});else if("_staging_flag"===n)t.evtParams=w({},t.evtParams||{},{_staging_flag:e._staging_flag});else if("reportErrorCallback"===n&&"function"==typeof e[n])t.reportErrorCallback=e[n];else{var i="",r="";if(n.indexOf(".")>-1){var o=n.split(".");i=o[0],r=o[1]}i?"user"===i||"header"===i?t.envInfo[i][r]=e[n]:t.envInfo.header.custom[r]=e[n]:Object.hasOwnProperty.call(t.envInfo.user,n)?["user_type","ip_addr_id"].indexOf(n)>-1?t.envInfo.user[n]=e[n]?Number(e[n]):e[n]:["user_id","web_id","user_unique_id","user_unique_id_type"].indexOf(n)>-1?t.envInfo.user[n]=e[n]?String(e[n]):e[n]:["user_is_auth","user_is_login"].indexOf(n)>-1?t.envInfo.user[n]=!!e[n]:"device_id"===n&&(t.envInfo.user[n]=e[n]):Object.hasOwnProperty.call(t.envInfo.header,n)?t.envInfo.header[n]=e[n]:t.envInfo.header.custom[n]=e[n]}})},e.prototype.get=function(e){try{return e?"evtParams"===e?this.evtParams:"reportErrorCallback"===e?this[e]:Object.hasOwnProperty.call(this.envInfo.user,e)?this.envInfo.user[e]:Object.hasOwnProperty.call(this.envInfo.header,e)?this.envInfo.header[e]:JSON.parse(JSON.stringify(this.envInfo[e])):JSON.parse(JSON.stringify(this.envInfo))}catch(e){this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}},e.prototype.setStore=function(e){try{if(!this.configPersist)return;var t=this.storage.getItem(this.configKey)||{};if(t&&Object.keys(e).length){var n=Object.assign(e,t);this.storage.setItem(this.configKey,n)}}catch(e){this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}},e.prototype.getStore=function(){try{if(!this.configPersist)return null;var e=this.storage.getItem(this.configKey)||{};return e&&Object.keys(e).length?e:null}catch(e){return this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message}),null}},e.prototype.delete=function(e){try{if(!this.configPersist)return;var t=this.storage.getItem(this.configKey)||{};t&&Object.hasOwnProperty.call(t,e)&&(delete t[e],this.storage.setItem(this.configKey,t))}catch(e){this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}},e}(),eu=function(){function e(e,t){this.isLog=t||!1,this.name=e||""}return e.prototype.info=function(e){this.isLog},e.prototype.warn=function(e){this.isLog},e.prototype.error=function(e){this.isLog},e.prototype.throw=function(e){throw this.error(this.name),Error(e)},e}(),el=function(){function e(){this.spiderBot=["Baiduspider","googlebot","360Spider","haosouspider","YoudaoBot","Sogou News Spider","Yisouspider","Googlebot","Headless","Applebot","Bingbot","PetalBot"]}return e.prototype.checkSpider=function(e){if(!e.enable_spider)return!1;var t=window.navigator.userAgent;if(!t)return!0;var n=!1;return this.spiderBot.forEach(function(e){-1!==t.indexOf(e)&&(n=!0)}),n},e}(),eh=function(){function e(e,t){this.collect=e,this.native=t}var t=e.prototype;return t.bridgeInject=function(){try{return!!this.native&&!!AppLogBridge}catch(e){return!1}},t.bridgeReady=function(){var e=this;return new Promise(function(t,n){try{e.bridgeInject()?AppLogBridge.hasStarted(function(e){e?t(!0):n(!1)}):n(!1)}catch(e){n(!1)}})},t.setNativeAppId=function(e){try{AppLogBridge.setNativeAppId(JSON.stringify(e))}catch(e){}},t.setConfig=function(e){var t=this;try{Object.keys(e).forEach(function(n){"user_unique_id"===n?t.setUserUniqueId(e[n]):e[n]?t.addHeaderInfo(n,e[n]):t.removeHeaderInfo(n)})}catch(e){}},t.setUserUniqueId=function(e){try{AppLogBridge.setUserUniqueId(e)}catch(e){}},t.addHeaderInfo=function(e,t){try{AppLogBridge.addHeaderInfo(e,t)}catch(e){}},t.setHeaderInfo=function(e){try{AppLogBridge.setHeaderInfo(JSON.stringify(e))}catch(e){}},t.removeHeaderInfo=function(e){try{AppLogBridge.removeHeaderInfo(e)}catch(e){}},t.reportPv=function(e){this.onEventV3("predefine_pageview",e)},t.onEventV3=function(e,t){try{AppLogBridge.onEventV3(e,t),this.collect.emit(DebuggerMesssge.DEBUGGER_MESSAGE,{type:DebuggerMesssge.DEBUGGER_MESSAGE_EVENT,info:"bridge\u57CB\u70B9\u4E0A\u62A5",time:Date.now(),data:[{events:[{event:e,params:t}]}],code:200,status:"success"})}catch(e){}},t.profileSet=function(e){try{AppLogBridge.profileSet(e)}catch(e){}},t.profileSetOnce=function(e){try{AppLogBridge.profileSetOnce(e)}catch(e){}},t.profileIncrement=function(e){try{AppLogBridge.profileIncrement(e)}catch(e){}},t.profileUnset=function(e){try{AppLogBridge.profileUnset(e)}catch(e){}},t.profileAppend=function(e){try{AppLogBridge.profileAppend(e)}catch(e){}},e}(),ep=function(){function e(){this.eventLimit=50,this.enable_ttwebid=!1,this.eventCache=[],this.beconEventCache=[]}return e.prototype.apply=function(e,t){var n=this;this.collect=e,this.config=t,this.configManager=e.configManager,this.eventCheck=new en(e,t),this.cacheStorgae=new F(!0),this.localStorage=new F(!1),this.maxReport=t.max_report||10,this.reportTime=t.reportTime||30,this.timeout=t.timeout||1e5,this.enable_ttwebid=t.enable_ttwebid,this.reportUrl=t.report_url||this.configManager.getUrl("event"),this.eventKey="__tea_cache_events_"+this.configManager.get("app_id"),this.beconKey="__tea_cache_events_becon_"+this.configManager.get("app_id"),this.abKey="__tea_sdk_ab_version_"+this.configManager.get("app_id"),this.refer_key="__tea_cache_refer_"+this.configManager.get("app_id"),this.collect.on(ei.Ready,function(){n.reportAll(!1)}),this.collect.on(ei.ConfigDomain,function(){n.reportUrl=n.configManager.getUrl("event")}),this.collect.on(ei.Event,function(e){n.event(e)}),this.collect.on(ei.BeconEvent,function(e){n.beconEvent(e)}),this.collect.on(ei.CleanEvents,function(){n.reportAll(!1)}),this.linster()},e.prototype.linster=function(){var e=this;window.addEventListener("unload",function(){e.reportAll(!0)},!1),G(function(){e.reportAll(!0)}),document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&e.reportAll(!0)},!1)},e.prototype.reportAll=function(e){this.report(e),this.reportBecon()},e.prototype.event=function(e){var t=this;try{var n=A(e,this.cacheStorgae.getItem(this.eventKey)||[]);if(this.cacheStorgae.setItem(this.eventKey,n),this.reportTimeout&&clearTimeout(this.reportTimeout),n.length>=this.maxReport)this.report(!1);else{var i=this.reportTime;this.reportTimeout=setTimeout(function(){t.report(!1),t.reportTimeout=null},i)}}catch(e){this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}},e.prototype.beconEvent=function(e){var t=A(e,this.cacheStorgae.getItem(this.beconKey)||[]);this.cacheStorgae.setItem(this.beconKey,t),this.collect.destroy||this.collect.tokenManager.getReady()&&this.collect.sdkReady&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(t)),!0))},e.prototype.reportBecon=function(){if(!this.collect.destroy&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var e=this.cacheStorgae.getItem(this.beconKey)||[];e&&e.length&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(e)),!0))}},e.prototype.report=function(e){if(!this.collect.destroy&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var t=this.cacheStorgae.getItem(this.eventKey)||[];t.length&&(this.cacheStorgae.removeItem(this.eventKey),this.sliceEvent(t,e))}},e.prototype.sliceEvent=function(e,t){if(e.length>this.eventLimit)for(var n=0;n<e.length;n+=this.eventLimit){i=e.slice(n,n+this.eventLimit);var i,r=this.split(this.merge(i));this.send(r,t)}else r=this.split(this.merge(e)),this.send(r,t)},e.prototype.handleRefer=function(){var e="";try{if(this.config.spa||this.config.autotrack){var t=this.localStorage.getItem(this.refer_key)||{};e=t.routeChange?t.refer_key:this.configManager.get("referrer")}else e=this.configManager.get("referrer")}catch(t){e=document.referrer}return e},e.prototype.merge=function(e,t){var n=this,i=this.configManager.get(),r=i.header,o=i.user;r.custom=JSON.stringify(r.custom),r.referrer=this.handleRefer();var a=this.configManager.get("evtParams"),s=this.configManager.get("user_unique_id_type"),c=JSON.parse(JSON.stringify({events:e.map(function(e){try{Object.keys(a).length&&!t&&(e.params=w({},a,e.params)),s&&(e.params.$user_unique_id_type=s);var i=n.configManager.getAbCache(),r=n.configManager.getAbUuidCache(o.user_unique_id);if(i&&i.uuid&&i.uuid===o.user_unique_id){var c=n.configManager.getAbVersion();if(n.config.enable_ab_uuid){if(r&&r.length){var u=r.join(",");c&&c.includes(u)&&(e.ab_sdk_version=c)}}else c&&(e.ab_sdk_version=c)}return e.session_id=n.collect.sessionManager.getSessionId(),e.params=JSON.stringify(e.params),e}catch(t){return n.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message}),e}}),user:o,header:r}));c.local_time=Math.floor(Date.now()/1e3),c.user_unique_type=this.config.enable_ttwebid?this.config.user_unique_type:void 0,c.verbose=1;var u=[];return u.push(c),u},e.prototype.split=function(e){return e=e.map(function(e){var t=[];return t.push(e),t})},e.prototype.send=function(e,t){var n=this;e.length&&(this.config.disable_track_event||e.forEach(function(e){try{var i=JSON.parse(JSON.stringify(e));n.config.filter&&(i=n.config.filter(i)),n.collect.eventFilter&&i&&(i=n.collect.eventFilter(i));var r=i||e,o=JSON.parse(JSON.stringify(r));if(n.eventCheck.checkVerify(o),!r.length)return;n.collect.emit(ei.SubmitBefore,r),n.collect.emit(ei.SubmitVerify,r),n.collect.requestManager.useRequest({url:n.reportUrl,data:r,success:function(e,t){e&&0!==e.e?(n.collect.emit(ei.SubmitError,{type:"f_data",eventData:t,errorCode:e.e,response:e}),n.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_EVENT,info:"\u57CB\u70B9\u4E0A\u62A5\u5931\u8D25",time:Date.now(),data:o,code:e.e,failType:"\u6570\u636E\u5F02\u5E38\u5931\u8D25",status:"fail"})):(n.collect.emit(ei.SubmitScuess,{eventData:t,res:e}),n.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_EVENT,info:"\u57CB\u70B9\u4E0A\u62A5\u6210\u529F",time:Date.now(),data:o,code:200,status:"success"}))},fail:function(e,t){n.configManager.get("reportErrorCallback")(e,t),n.collect.emit(ei.SubmitError,{type:"f_net",eventData:e,errorCode:t}),n.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_EVENT,info:"\u57CB\u70B9\u4E0A\u62A5\u7F51\u7EDC\u5F02\u5E38",time:Date.now(),data:o,code:t,failType:"\u7F51\u7EDC\u5F02\u5E38\u5931\u8D25",status:"fail"})},timeout:n.timeout,useBeacon:!n.config.disable_sendbeacon&&t,withCredentials:n.enable_ttwebid}),n.collect.emit(ei.SubmitAfter,r)}catch(e){n.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}}))},e}(),ef=function(){return(function e(t){return t?(t^16*Math.random()>>t/4).toString(10):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e)})().replace(/-/g,"").slice(0,19)},ed=function(){function e(){this.cacheToken={},this.enableCookie=!1,this.enable_ttwebid=!1,this.enableCustomWebid=!1}return e.prototype.apply=function(e,t){var n=this;this.collect=e,this.config=t,this.configManager=this.collect.configManager,this.storage=new F(!1),this.tokenKey="__tea_cache_tokens_"+t.app_id,this.enable_ttwebid=t.enable_ttwebid,this.enableCustomWebid=t.enable_custom_webid,this.collect.on(ei.ConfigUuid,function(e){n.setUuid(e)}),this.collect.on(ei.ConfigWebId,function(e){n.setWebId(e)}),this.enableCookie=t.cross_subdomain,this.expiresTime=t.cookie_expire||6048e5,this.cookieDomain=t.cookie_domain||"",this.checkStorage()},e.prototype.checkStorage=function(){var e=this;if(this.enableCookie){var t=this.storage.getCookie(this.tokenKey,this.cookieDomain);this.cacheToken=t&&"string"==typeof t?JSON.parse(t):{}}else this.cacheToken=this.storage.getItem(this.tokenKey)||{};this.tokenType=this.cacheToken&&this.cacheToken._type_?this.cacheToken._type_:"default","custom"!==this.tokenType||this.enableCustomWebid?this.enableCustomWebid?this.collect.on(ei.CustomWebId,function(){e.tokenReady=!0,e.collect.emit(ei.TokenComplete)}):this.checkEnv()||(this.enable_ttwebid?this.completeTtWid(this.cacheToken):this.check()):this.remoteWebid()},e.prototype.check=function(){this.cacheToken&&this.cacheToken.web_id?this.complete(this.cacheToken):this.config.disable_webid?this.complete({web_id:ef(),user_unique_id:this.configManager.get("user_unique_id")||ef()}):this.remoteWebid()},e.prototype.checkEnv=function(){var e=window.navigator.userAgent;if(-1!==e.indexOf("miniProgram")||-1!==e.indexOf("MiniProgram")){var t=B(window.location.href);return!(!t||!t.Web_ID)&&(this.complete({web_id:""+t.Web_ID,user_unique_id:this.configManager.get("user_unique_id")||""+t.Web_ID}),!0)}return!1},e.prototype.remoteWebid=function(){var e=this,t=this.configManager.getUrl("webid"),n={app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""};this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"SDK \u53D1\u8D77WEBID\u8BF7\u6C42",logType:"fetch",level:"info",time:Date.now(),data:n});var i=ef();this.collect.requestManager.useRequest({url:t,data:n,success:function(t){var n;t&&0===t.e?(n=t.web_id,e.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8BF7\u6C42\u6210\u529F",logType:"fetch",level:"info",time:Date.now(),data:t})):(n=i,e.collect.configManager.set({localWebId:i}),e.collect.emit(ei.TokenError),e.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8BF7\u6C42\u8FD4\u56DE\u503C\u5F02\u5E38",logType:"fetch",level:"warn",time:Date.now(),data:t}),e.collect.logger.warn("appid: "+e.config.app_id+" get webid error, use local webid~")),e.complete({web_id:e.configManager.get("web_id")||n,user_unique_id:e.configManager.get("user_unique_id")||n})},fail:function(){e.complete({web_id:e.configManager.get("web_id")||i,user_unique_id:e.configManager.get("user_unique_id")||i}),e.collect.configManager.set({localWebId:i}),e.collect.emit(ei.TokenError),e.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8BF7\u6C42\u7F51\u7EDC\u5F02\u5E38",logType:"fetch",level:"error",time:Date.now(),data:null}),e.collect.logger.warn("appid: "+e.config.app_id+", get webid error, use local webid~")},timeout:3e5})},e.prototype.complete=function(e){var t=e.web_id,n=e.user_unique_id;e.timestamp=Date.now(),this.collect.configManager.set({web_id:t,user_unique_id:n}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(ei.TokenComplete)},e.prototype.completeTtWid=function(e){var t=e.user_unique_id||"",n=this.configManager.get("user_unique_id");(n||t)&&this.configManager.set({user_unique_id:n||t}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(ei.TokenComplete)},e.prototype.setUuid=function(e){if(e&&-1===["null","undefined","Null","None"].indexOf(e)){var t=String(e),n=this.configManager.get("user_unique_id"),i=this.cacheToken&&this.cacheToken.user_unique_id;(t!==n||t!==i)&&(this.configManager.set({user_unique_id:t}),this.cacheToken||(this.cacheToken={}),this.cacheToken.user_unique_id=t,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken),this.collect.emit(ei.TokenChange,"uuid"),this.collect.emit(ei.SessionReset))}else this.clearUuid()},e.prototype.clearUuid=function(){this.config.enable_ttwebid||this.configManager.get("web_id")&&(this.configManager.set({user_unique_id:this.configManager.get("web_id")}),this.cacheToken&&this.cacheToken.web_id&&(this.cacheToken.user_unique_id=this.cacheToken.web_id,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken)),this.collect.emit(ei.TokenReset))},e.prototype.setWebId=function(e){if(e&&!this.config.enable_ttwebid){this.cacheToken&&this.cacheToken.web_id?this.cacheToken.web_id!==e&&(this.cacheToken.user_unique_id=this.cacheToken.web_id===this.cacheToken.user_unique_id?e:this.cacheToken.user_unique_id,this.cacheToken.web_id=e):(this.cacheToken={},this.cacheToken.web_id=e,this.cacheToken.user_unique_id=e),this.cacheToken.timestamp=Date.now();var t=this.configManager.get("web_id"),n=this.configManager.get("user_unique_id");n&&n!==t||(this.configManager.set({user_unique_id:e}),this.collect.emit(ei.TokenChange,"uuid")),t!==e&&(this.configManager.set({web_id:e}),this.collect.emit(ei.TokenChange,"webid")),this.setStorage(this.cacheToken)}},e.prototype.setStorage=function(e){e._type_=this.enableCustomWebid?"custom":"default",delete e["diss".split("").reverse().join("")],this.enableCookie||this.enable_ttwebid?(this.storage.setCookie(this.tokenKey,e,this.expiresTime,this.cookieDomain),this.enable_ttwebid&&(delete e.web_id,this.storage.setItem(this.tokenKey,e))):this.storage.setItem(this.tokenKey,e),this.cacheToken=e},e.prototype.getReady=function(){return this.tokenReady},e.prototype.getTobId=function(){var e=this;return new Promise(function(t){"tcpy"!==e.config.channel_type&&"ttp"!==e.config.channel_type?e.collect.requestManager.useRequest({url:e.configManager.getUrl("tobid"),data:{app_id:e.config.app_id,user_unique_id:e.configManager.get("user_unique_id"),web_id:e.configManager.get("web_id"),user_unique_id_type:e.configManager.get("user_unique_id_type")},success:function(e){e&&0===e.e?t(e.tobid):t("")},fail:function(){t("")},time:3e4,withCredentials:e.enable_ttwebid}):t("")})},e}(),eg=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},e_=function(){function e(){}return e.prototype.apply=function(e,t){var n=this;this.collect=e,this.storage=new F(!1,"session"),this.sessionKey="__tea_session_id_"+t.app_id,this.expireTime=t.expireTime||18e5,this.disableSession=t.disable_session,this.disableSession||(this.setSessionId(),this.collect.on(ei.SessionReset,function(){n.resetSessionId()}),this.collect.on(ei.SessionResetTime,function(){n.updateSessionIdTime()}))},e.prototype.updateSessionIdTime=function(){var e=this.storage.getItem(this.sessionKey);if(e&&e.sessionId){var t=e.timestamp;Date.now()-t>this.expireTime?e={sessionId:eg(),timestamp:Date.now()}:e.timestamp=Date.now(),this.storage.setItem(this.sessionKey,e),this.resetExpTime()}},e.prototype.setSessionId=function(){var e=this,t=this.storage.getItem(this.sessionKey);t&&t.sessionId?t.timestamp=Date.now():t={sessionId:eg(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,t),this.sessionExp=setInterval(function(){e.checkEXp()},this.expireTime)},e.prototype.getSessionId=function(){var e=this.storage.getItem(this.sessionKey);return this.disableSession?"":e&&e.sessionId?e.sessionId:""},e.prototype.resetExpTime=function(){var e=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval(function(){e.checkEXp()},this.expireTime))},e.prototype.resetSessionId=function(){var e={sessionId:eg(),timestamp:Date.now()};this.storage.setItem(this.sessionKey,e)},e.prototype.checkEXp=function(){var e=this.storage.getItem(this.sessionKey);e&&e.sessionId&&Date.now()-e.timestamp+30>=this.expireTime&&(e={sessionId:eg(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,e))},e}(),em={XHR_ON:500,TIMEOUT:5005},ev=function(e,t,n,i){try{var r=e.match(/\/v\d\//),o="";o=r?r[0]:-1!==e.indexOf("/v1/")?"/v1/":"/v2/";var a=e.split(o)[0];if(!a)return void i(e,t,4001);t.forEach(function(r){var o=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&void 0!==e[n]&&(t+="&"+n+"="+encodeURIComponent(JSON.stringify(e[n])));return t="&"===t[0]?t.slice(1):t}(r),s=new Image(1,1);s.onload=function(){s=null,n&&n()},s.onerror=function(){s=null,i&&i(e,t,4e3)},s.src=a+"/gif?"+o})}catch(n){i&&i(e,t,4002,n.message)}},ey=function(e,t,n,i,r,o,a,s){var c=window.navigator.userAgent;if(-1===window.navigator.appName.indexOf("Microsoft Internet Explorer")||-1===c.indexOf("MSIE 8.0")&&-1===c.indexOf("MSIE 9.0")){if(a)return window.navigator&&window.navigator.sendBeacon?void(window.navigator.sendBeacon(e,JSON.stringify(t))?r():o(e,t,4003)):void ev(e,t,r,o)}else ev(e,t,r,o);!function(e,t,n,i,r,o,a,s,c){try{var u=new XMLHttpRequest;u.open("POST",""+e,!0),u.setRequestHeader("Content-Type","application/json; charset=utf-8"),i&&(u.withCredentials=!0),u.onload=function(){if(r){var e=null;if(u.responseText){try{e=JSON.parse(u.responseText)}catch(t){e={}}r(e,t)}}},n&&(u.timeout=n,u.ontimeout=function(){o&&o(t,em.TIMEOUT)}),u.onerror=function(){u.abort(),o&&o(t,em.XHR_ON)},c?u.send(t):u.send(JSON.stringify(t))}catch(e){}}(e,t,n,i,r,o,0,0,s)},eb=function(){function e(e,t){this.collector=e,this.config=t,this.requestType=t.request_type||"xhr",this.supportBeacon=!(!window.navigator||!window.navigator.sendBeacon),this.errorCode={NO_URL:4001,IMG_ON:4e3,IMG_CATCH:4002,BEACON_FALSE:4003,XHR_ON:500,RESPONSE:5001,TIMEOUT:5005}}return e.prototype.useFetch=function(e){var t=e.url,n=e.data,i=e.method,r=e.success,o=e.fail;window.fetch?fetch(t,{method:i||"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(n)}).then(function(e){return e.json()}).then(function(e){r&&r(e)}).catch(function(e){o&&o(n,e)}):(this.requestType="xhr",this.useRequest({url:t,data:n,method:i,success:r,fail:o}))},e.prototype.useBeacon=function(e){var t=e.url,n=e.data,i=e.success,r=e.fail;window.navigator.sendBeacon(t,JSON.stringify(n))?i&&i():r&&r(n,this.errorCode.BEACON_FALSE)},e.prototype.useRequest=function(e){var t=this,n=e.url,i=e.data,r=e.method,o=e.success,a=e.fail,s=e.timeout,c=e.useBeacon,u=e.withCredentials,l=e.app_key,h=e.forceXhr;if(c&&this.supportBeacon)this.useBeacon({url:n,data:i,method:r,success:o,fail:a});else if("fetch"!==this.requestType||h)try{var p=new XMLHttpRequest,f=r||"POST";p.open(f,""+n,!0),p.setRequestHeader("Content-Type","application/json; charset=utf-8"),l&&p.setRequestHeader("X-MCS-AppKey",""+l),u&&(p.withCredentials=!0),s&&(p.timeout=s,p.ontimeout=function(){a&&a(i,t.errorCode.TIMEOUT)}),p.onload=function(){if(o){var e=null;if(p.responseText){try{e=JSON.parse(p.responseText)}catch(t){e={}}o(e,i)}}},p.onerror=function(){p.abort(),a&&a(i,t.errorCode.XHR_ON)},p.send(JSON.stringify(i))}catch(e){}else this.useFetch({url:n,data:i,method:r,success:o,fail:a})},e}(),eE=function(){function e(e,t){if(this.devToolReady=!1,this.devToolOrigin="*",this.sendAlready=!1,t.enable_debug){this.collect=e,this.config=t,this.app_id=t.app_id;var n=e.adapters.storage;this.cacheStorgae=new n(!1,"session"),this.filterEvent=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure","bav2b_page","bav2b_beat","bav2b_page_statistics","bav2b_click","bav2b_page_exposure","_be_active","predefine_pageview","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append","predefine_page_alive","predefine_page_close","abtest_exposure"],this.load()}}return e.prototype.loadScript=function(e){try{var t=document.createElement("script");t.src=e,t.onerror=function(){},t.onload=function(){},document.getElementsByTagName("body")[0].appendChild(t)}catch(e){}},e.prototype.parseUrl=function(){var e={};try{var t=window.location.href.split("?")[1].split("&");t.length&&t.forEach(function(t){var n=t.split("=");e[decodeURIComponent(n[0])]=decodeURIComponent(n[1])})}catch(e){}return e},e.prototype.load=function(){try{var e=this.parseUrl();if(e.open_devtool_web&&e.app_id){if(parseInt(e.app_id)!==this.app_id)return}else if(!this.getStorage())return;this.loadBaseInfo(),this.loadHook(),this.setStorage(),this.addLintener(),this.loadDebuggerModule(),this.loadDevTool()}catch(e){}},e.prototype.getStorage=function(){var e=this.cacheStorgae.getItem("__applog_devtool_web");return e&&parseInt(e)===this.app_id},e.prototype.setStorage=function(){this.cacheStorgae.setItem("__applog_devtool_web",this.app_id)},e.prototype.loadDevTool=function(){this.loadScript("https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/devtool/debug-web.js")},e.prototype.loadBaseInfo=function(){var e=this;this.info=[{title:"\u57FA\u672C\u4FE1\u606F",type:1,infoName:{app_id:this.config.app_id,channel:this.config.channel,\u4E0A\u62A5\u57DF\u540D:this.collect.configManager.getDomain(),SDK\u7248\u672C:et,SDK\u5F15\u5165\u65B9\u5F0F:"npm"}},{title:"\u7528\u6237\u4FE1\u606F",type:2,infoName:{uuid:this.collect.configManager.get("user").user_unique_id||"",web_id:this.collect.configManager.get("user").web_id||"",ssid:"\u70B9\u51FB\u83B7\u53D6SSID"}},{title:"\u516C\u5171\u53C2\u6570\u4FE1\u606F",type:2,infoName:{\u6D4F\u89C8\u5668:this.collect.configManager.get("browser"),\u6D4F\u89C8\u5668\u7248\u672C:this.collect.configManager.get("browser_version"),\u5E73\u53F0:this.collect.configManager.get("platform"),\u8BBE\u5907\u578B\u53F7:this.collect.configManager.get("device_model"),\u64CD\u4F5C\u7CFB\u7EDF:this.collect.configManager.get("os_name"),\u64CD\u4F5C\u7CFB\u7EDF\u7248\u672C:this.collect.configManager.get("os_version"),\u5C4F\u5E55\u5206\u8FA8\u7387:this.collect.configManager.get("os_version"),\u6765\u6E90:this.collect.configManager.get("referrer"),\u81EA\u5B9A\u4E49\u4FE1\u606F:""}},{title:"\u914D\u7F6E\u4FE1\u606F",type:3,infoName:{\u5168\u57CB\u70B9:!!this.config.autotrack,\u505C\u7559\u65F6\u957F:!!this.config.enable_stay_duration}},{title:"A/B\u914D\u7F6E\u4FE1\u606F",type:4,infoName:{"A/B\u5B9E\u9A8C":!!this.config.enable_ab_test}},{title:"\u5BA2\u6237\u7AEF\u4FE1\u606F",type:3,infoName:{\u6253\u901A\u5F00\u5173:!!this.config.Native}}],this.log=[],this.event=[],this.collect.on(ei.Ready,function(){e.info[1].infoName.uuid=e.collect.configManager.get("user").user_unique_id,e.info[1].infoName.web_id=e.collect.configManager.get("user").web_id,e.info[2].infoName["\u81EA\u5B9A\u4E49\u4FE1\u606F"]=JSON.stringify(e.collect.configManager.get("custom")),e.config.enable_ab_test&&(e.info[4].infoName["\u5DF2\u66DD\u5149VID"]=e.collect.configManager.getAbVersion(),e.info[4].infoName["A/B\u57DF\u540D"]=e.config.ab_channel_domain||I(Z[e.config.channel]),e.info[4].infoName["\u5168\u90E8\u914D\u7F6E"]=e.collect.configManager.getAbData()),e.config.Native&&(e.info[5].infoName["\u662F\u5426\u6253\u901A"]=!!e.collect.bridgeReport)})},e.prototype.loadHook=function(){var e=this;this.collect.on(V.DEBUGGER_MESSAGE,function(t){switch(t.type){case V.DEBUGGER_MESSAGE_SDK:var n={time:t.time,type:t.logType||"sdk",level:t.level,name:t.info,show:!0,levelShow:!0,needDesc:!!t.data};return t.data&&(n.desc={content:JSON.stringify(t.data)}),e.updateLog(n),t.secType&&"AB"===t.secType?(e.info[4].infoName["\u5DF2\u66DD\u5149VID"]=e.collect.configManager.getAbVersion(),e.info[4].infoName["\u5168\u90E8\u914D\u7F6E"]=e.collect.configManager.getAbData()):"USER"===t.secType&&(e.info[1].infoName.uuid=e.collect.configManager.get("user").user_unique_id,e.info[1].infoName.web_id=e.collect.configManager.get("user").web_id),void e.updateInfo();case V.DEBUGGER_MESSAGE_EVENT:if(t.data&&t.data.length){var i=t.data[0],r=i.events;if(!r.length)return;r.forEach(function(n){n.checkShow=!0,n.searchShow=!0,n.success=t.status,n.type=-1!==e.filterEvent.indexOf(n.event)?"sdk":"cus",n.type=e.collect.bridgeReport?"bridge":n.type,n.info="","fail"===t.status&&(n.info={message:"code: "+t.code+"\uFF0C msg: "+t.failType})}),e.updateEvent(i)}return}})},e.prototype.addLintener=function(){var e=this;window.addEventListener("message",function(t){if(t.origin===location.origin){if(t&&t.data&&"devtool:web:ready"===t.data.type){if(e.devToolOrigin=t.origin,e.devToolReady=!0,e.sendAlready)return;e.sendData("devtool:web:init",{info:e.info,log:e.log,event:e.event}),e.sendAlready=!0}t&&t.data&&"devtool:web:ssid"===t.data.type&&e.collect.getToken(function(t){e.info[1].infoName.ssid=t.tobid,e.updateInfo()})}})},e.prototype.sendData=function(e,t){try{(window.opener||window.parent).postMessage({type:e,payload:t},this.devToolOrigin)}catch(e){}},e.prototype.updateInfo=function(){this.devToolReady&&this.sendData("devtool:web:info",this.info)},e.prototype.updateLog=function(e){this.devToolReady?this.sendData("devtool:web:log",e):this.log.push(e)},e.prototype.updateEvent=function(e){this.devToolReady?this.sendData("devtool:web:event",e):this.event.push(e)},e.prototype.loadDebuggerModule=function(){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.appendChild(document.createTextNode("#debugger-applog-web {\n      position: absolute;\n      width: 90px;\n      height: 30px;\n      background: #23c243;\n      border-radius: 6px;\n      color: #fff;\n      font-size: 12px;\n      bottom: 5%;\n      right: 10%;\n      text-align: center;\n      line-height: 30px;\n      cursor: pointer;\n      z-index:100;\n    }")),e.appendChild(t);var n=document.createElement("div");n.innerHTML='<div id="debugger-applog-web" class="debugger-applog-web">AppLog\u8C03\u8BD5</div>';var i=document.createElement("div");i.innerHTML='<div id="debugger-container" class="debugger-container"></div>',document.getElementsByTagName("body")[0].appendChild(n),document.getElementsByTagName("body")[0].appendChild(i),document.getElementById("debugger-applog-web").addEventListener("click",function(){(window.opener||window.parent).postMessage({type:"devtool:web:open-draw"},location.origin)})},e}(),ew={autotrack:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/autotrack.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/autotrack.js"},object:"LogAutoTrack"},ab:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/ab.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/ab.js"},object:"LogAb"},stay:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/stay.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/stay.js"},object:"LogStay"},route:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/route.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/route.js"},object:"LogRoute"},cep:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/cep.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/cep.js"},object:"LogCep"},tracer:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/tracer.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/tracer.js"},object:"LogTracer"},retry:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/retry.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/retry.js"},object:"LogRetry"},visual:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/visual.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/visual.js"},object:"LogVisual"}},eS=["ab","autotrack","Stay","store","et","profile","cep","heartbeat","monitor","route","tracer"],ek=function(){function e(e){this.disableAutoPageView=!1,this.bridgeReport=!1,this.staging=!1,this.pluginInstances=[],this.sended=!1,this.started=!1,this.destroy=!1,this.sdkReady=!1,this.adapters={},this.loadType="base",this.name=e,this.hook=new R,this.remotePlugin=new Map,this.Types=ei,this.adapters.storage=F,this.loadType="full"}return e.usePlugin=function(t,n,i){if(n){for(var r=!1,o=0,a=e.plugins.length;o<a;o++)if(e.plugins[o].name===n){e.plugins[o].plugin=t,e.plugins[o].options=i||{},r=!0;break}r||e.plugins.push({name:n,plugin:t,options:i})}else e.plugins.push({plugin:t})},e.prototype.usePlugin=function(e,t,n){e&&("full"===this.loadType&&eS.includes(e)||(t?"string"==typeof t?this.remotePlugin.get(e)||this.remotePlugin.set(e,{src:t,call:n}):this.remotePlugin.get(e)||this.remotePlugin.set(e,{instance:t}):this.remotePlugin.get(e)||this.remotePlugin.set(e,"sdk")))},e.prototype.init=function(t){var n,i,r=this;try{n=JSON.parse(JSON.stringify(t))}catch(e){n=t}if(this.logger=new eu(this.name,n.log),this.inited)this.logger.warn("[instance: "+this.name+"], every instance's api: init,  can be call only one time!");else if(n&&O(n)){if(n.app_id&&"number"==typeof(i=n.app_id)&&!isNaN(i)){if(n.app_key&&"string"!=typeof n.app_key)this.logger.warn("app_key param is error, must be string, please check!");else{var o=n.channel_type&&"tcpy"===n.channel_type?["sg","va","in"]:["sg","va"];n.channel_domain||-1!==o.indexOf(n.channel)||(this.logger.warn("channel must "+o.join(" ,")+"!!!"),n.channel="sg"),this.spider=new el,this.spider.checkSpider(n)?this.logger.warn("The current environment may be a spider, can not report!"):(this.appBridge=new eh(this,n.enable_native),this.requestManager=new eb(this,n),this.bridgeReport=this.appBridge.bridgeInject(),this.configManager=new ec(this,n),this.debugger=new eE(this,n),this.initConfig=n,this.emit(ei.Init),this.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CINIT",data:n,level:"info",time:Date.now()}),n.disable_auto_pv&&(this.disableAutoPageView=!0),this.bridgeReport||(this.configManager.setAppid(n.app_id),this.eventManager=new ep,this.tokenManager=new ed,this.sessionManager=new e_,Promise.all([new Promise(function(e){r.once(ei.TokenComplete,function(){e(!0)})}),new Promise(function(e){r.once(ei.Start,function(){e(!0)})})]).then(function(){try{e.plugins.reduce(function(e,t){var n=t.plugin,i=t.options,o=Object.assign(r.initConfig,i),a=new n;return a.apply(r,o),e.push(a),e},r.pluginInstances)}catch(e){r.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}r.sdkReady=!0,r.emit(ei.Ready),r.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"SDK \u521D\u59CB\u5316\u5B8C\u6210",time:Date.now(),level:"info",data:r.configManager.get("user")}),r.logger.info("appid: "+n.app_id+", userInfo:"+JSON.stringify(r.configManager.get("user"))),r.logger.info("appid: "+n.app_id+", sdk is ready, version is "+et+", you can report now !!!"),n.disable_auto_pv&&(r.disableAutoPageView=!0);try{("full"===r.loadType&&n.enable_ab_test||n.autotrack)&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(e){r.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}r.pageView(),r.on(ei.TokenChange,function(e){"webid"===e&&r.pageView(),r.logger.info("appid: "+n.app_id+" token change, new userInfo:"+JSON.stringify(r.configManager.get("user"))),r.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"SDK \u8BBE\u7F6E\u4E86\u7528\u6237\u4FE1\u606F",time:Date.now(),secType:"USER",level:"info",data:r.configManager.get("user")})}),r.on(ei.TokenReset,function(){r.logger.info("appid: "+n.app_id+" token reset, new userInfo:"+JSON.stringify(r.configManager.get("user"))),r.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"SDK \u91CD\u7F6E\u4E86\u7528\u6237\u4FE1\u606F",time:Date.now(),secType:"USER",level:"info",data:r.configManager.get("user")})}),r.on(ei.RouteChange,function(e){e.init||n.disable_route_report||r.pageView()})}),this.tokenManager.apply(this,n),this.eventManager.apply(this,n),this.sessionManager.apply(this,n)),this.inited=!0)}}else this.logger.warn("app_id param is error, must be number, please check!")}else this.logger.warn("init params error,please check")},e.prototype.config=function(e){if(this.inited){if(e&&O(e)){var t;try{t=JSON.parse(JSON.stringify(t))}catch(n){t=e}if(this.bridgeReport)this.appBridge.setConfig(t);else{t._staging_flag&&1===t._staging_flag&&(this.staging=!0),t.disable_auto_pv&&(this.disableAutoPageView=!0,delete t.disable_auto_pv);var n=w({},t);if(this.initConfig&&this.initConfig.configPersist){var i=this.configManager.getStore();i&&(n=Object.assign(i,t)),this.configManager.setStore(t)}n.web_id,n.user_unique_id;var r=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)0>t.indexOf(i[r])&&(n[i[r]]=e[i[r]])}return n}(n,["web_id","user_unique_id"]);n.hasOwnProperty("web_id")&&this.emit(ei.ConfigWebId,n.web_id),n.hasOwnProperty("user_unique_id")&&this.emit(ei.ConfigUuid,n.user_unique_id),this.configManager.set(r),this.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CCONFIG",level:"info",time:Date.now(),data:n})}}else this.logger.warn("config params is error, please check")}else this.logger.warn("config must be use after function init")},e.prototype.setDomain=function(e){this.configManager&&this.configManager.setDomain(e),this.emit(ei.ConfigDomain)},e.prototype.getConfig=function(e){return this.configManager.get(e)},e.prototype.send=function(){this.start()},e.prototype.start=function(){this.inited&&!this.sended&&(this.sended=!0,this.emit(ei.Start),this.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CSTART",level:"info",time:Date.now()}),this.bridgeReport&&(this.pageView(),this.emit(ei.Ready)))},e.prototype.event=function(e,t){var n=this;try{var i=[];if(Array.isArray(e))e.forEach(function(e){var t=n.processEvent(e[0],e[1]||{});t&&i.push(t)});else{var r=this.processEvent(e,t);if(!r)return;i.push(r)}this.bridgeReport?i.forEach(function(e){var t=e.event,i=e.params;n.appBridge.onEventV3(t,JSON.stringify(i))}):i.length&&(this.emit(ei.Event,i),this.emit(ei.SessionResetTime))}catch(e){this.logger.warn("something error, please check"),this.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}},e.prototype.beconEvent=function(e,t){if(Array.isArray(e))this.logger.warn("beconEvent not support batch report, please check");else{var n=[],i=this.processEvent(e,t||{});i&&(n.push(i),n.length&&(this.emit(ei.BeconEvent,n),this.emit(ei.SessionResetTime)))}},e.prototype.processEvent=function(e,t){void 0===t&&(t={});try{if(!e)return this.logger.warn("eventName is null\uFF0C please check"),null;var n=e;/^event\./.test(e)&&(n=e.slice(6));var i=t;"object"!=typeof i&&(i={}),i.profile?delete i.profile:i.event_index=C();var r=void 0;return i.local_ms?(r=i.local_ms,delete i.local_ms):r=+new Date,{event:n,params:i,local_time_ms:r,is_bav:this.initConfig&&this.initConfig.autotrack?1:0}}catch(n){return this.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:n.message}),{event:e,params:t}}},e.prototype.filterEvent=function(e){this.eventFilter=e},e.prototype.on=function(e,t){this.hook.on(e,t)},e.prototype.once=function(e,t){this.hook.once(e,t)},e.prototype.off=function(e,t){this.hook.off(e,t)},e.prototype.emit=function(e,t,n){this.hook.emit(e,t,n)},e.prototype.set=function(e){this.hook.set(e)},e.prototype.pageView=function(){this.disableAutoPageView||this.predefinePageView()},e.prototype.predefinePageView=function(e){if(void 0===e&&(e={}),this.inited){var t={title:document.title||location.pathname,url:location.href,url_path:location.pathname,time:Date.now(),referrer:window.document.referrer,$is_first_time:""+(this.configManager&&this.configManager.is_first_time||!1)},n=w({},t,e);this.event("predefine_pageview",n)}else this.logger.warn("predefinePageView should call after init")},e.prototype.clearEventCache=function(){this.emit(ei.CleanEvents)},e.prototype.setWebIDviaUnionID=function(e){if(e){var t=L(e);this.config({web_id:""+t,wechat_unionid:e}),this.emit(ei.CustomWebId)}},e.prototype.setWebId=function(e){this.config({web_id:""+e})},e.prototype.setWebIDviaOpenID=function(e){if(e){var t=L(e);this.config({web_id:""+t,wechat_openid:e}),this.emit(ei.CustomWebId)}},e.prototype.setNativeAppId=function(e){this.bridgeReport&&this.appBridge.setNativeAppId(e)},e.prototype.resetStayDuration=function(e,t,n){this.emit(ei.ResetStay,{url_path:e,title:t,url:n},ei.Stay)},e.prototype.resetStayParams=function(e,t,n){void 0===e&&(e=""),void 0===t&&(t=""),void 0===n&&(n=""),this.emit(ei.SetStay,{url_path:e,title:t,url:n},ei.Stay)},e.prototype.getToken=function(e,t){var n=this;if(this.inited){var i=!1,r=function(t){if(!i){i=!0;var r=n.configManager.get().user;return t&&(r.tobid=t,r["diss".split("").reverse().join("")]=t),e(w({},r))}},o=function(){n.tokenManager.getTobId().then(function(e){r(e)})};this.sdkReady?o():(t&&setTimeout(function(){r()},t),this.on(ei.Ready,function(){o()}))}else this.logger.warn("predefinePageView should call after init")},e.prototype.profileSet=function(e){this.bridgeReport?this.appBridge.profileSet(JSON.stringify(e)):this.emit(ei.ProfileSet,e,ei.Profile),this.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CprofileSet",level:"info",time:Date.now(),data:e})},e.prototype.profileSetOnce=function(e){this.bridgeReport?this.appBridge.profileSetOnce(JSON.stringify(e)):this.emit(ei.ProfileSetOnce,e,ei.Profile),this.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CprofileSetOnce",level:"info",time:Date.now(),data:e})},e.prototype.profileIncrement=function(e){this.bridgeReport?this.appBridge.profileIncrement(JSON.stringify(e)):this.emit(ei.ProfileIncrement,e,ei.Profile),this.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CprofileIncrement",level:"info",time:Date.now(),data:e})},e.prototype.profileUnset=function(e){this.bridgeReport?this.appBridge.profileUnset(e):this.emit(ei.ProfileUnset,e,ei.Profile),this.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CprofileUnset",level:"info",time:Date.now(),data:e})},e.prototype.profileAppend=function(e){this.bridgeReport?this.appBridge.profileAppend(JSON.stringify(e)):this.emit(ei.ProfileAppend,e,ei.Profile),this.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CprofileAppend",level:"info",time:Date.now(),data:e})},e.prototype.setExternalAbVersion=function(e){this.emit(ei.AbExternalVersion,"string"==typeof e&&e?(""+e).trim():null,ei.Ab)},e.prototype.getVar=function(e,t,n,i){this.emit(ei.AbVar,{name:e,defaultValue:t,callback:n,uuid:i},ei.Ab)},e.prototype.getABconfig=function(e,t){this.emit(ei.AbConfig,{params:e,callback:t},ei.Ab)},e.prototype.getAbSdkVersion=function(){return this.configManager.getAbVersion()},e.prototype.onAbSdkVersionChange=function(e){var t=this;return this.emit(ei.AbVersionChangeOn,e,ei.Ab),function(){t.emit(ei.AbVersionChangeOff,e,ei.Ab)}},e.prototype.offAbSdkVersionChange=function(e){this.emit(ei.AbVersionChangeOff,e,ei.Ab)},e.prototype.openOverlayer=function(){this.emit(ei.AbOpenLayer,"",ei.Ab)},e.prototype.closeOverlayer=function(){this.emit(ei.AbCloseLayer,"",ei.Ab)},e.prototype.getAllVars=function(e){this.emit(ei.AbAllVars,e,ei.Ab)},e.prototype.autoInitializationRangers=function(e){var t,n,i,r,o,a,s;t=e.app_id,n=e.channel,i=e.onTokenReady,r=Y[n]+"/webid",o=new F(!1),a="__tea_cache_tokens_"+t,(s=o.getItem(a))&&s.web_id?i(s.web_id):ey(r,{app_key:"",app_id:t,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer},3e3,!1,function(e){if(e&&0===e.e){i(e.web_id);var t={web_id:e.web_id,user_unique_id:e.web_id,timestamp:Date.now()};o.setItem(a,t)}else i("")},function(){i("")},!0)},e.prototype.destoryInstace=function(){this.destroy||(this.destroy=!0,this.off(ei.TokenComplete),this.emit(ei.DestoryInstance))},e.prototype.destroyInstance=function(){this.destroy||(this.destroy=!0,this.off(ei.TokenComplete),this.emit(ei.DestoryInstance))},e.plugins=[],e}(),eA="__rangers_ab_style__",eD={},eT=[],eR=function(e){e.length&&e.forEach(function(e){eT.push(e)})};function eO(e,t,n,i){var r=e&&e.source||window.opener||window.parent,o=e&&e.origin||i||"*";r.postMessage(JSON.stringify({type:t,payload:n}),o)}function eM(e,t){eD[e]=eD[e]||[],eD[e].push(t)}function eC(e){if(eT.some(function(e){return"*"===e})||eT.some(function(t){return e.origin.indexOf(t)>-1})){var t=e.data;if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(e){t=void 0}if(t){var n=t.type,i=t.payload;eD[n]&&eD[n].forEach(function(t){"function"==typeof t&&t(e,i)})}}}function eI(e,t){var n=w({},e);delete n.filter,(window.opener||window.parent).postMessage({type:"tea:sdk:info",config:n,version:t},"*"),window.addEventListener("message",eC,!1)}var eG="",ex=!1;function eN(e){var t=e.event,n=e.editorUrl;e.collectInstance,e.fromSession,ex||(ex=!0,x(n,function(){eO(t,"abEditorScriptloadSuccess")},function(){t&&eO(t,"abEditorScriptloadError"),ex=!1}))}(tr=to||(to={}))[tr.Var=0]="Var",tr[tr.All=1]="All";var ez=function(){function e(){this.fetchStatus="no",this.refreshFetchStatus="no",this.versions=[],this.extVersions=[],this.mulilinkVersions=[],this.enable_multilink=!1,this.enable_ab_visual=!1,this.editMode=!1,this.callbacks=[],this.data={},this.changeListener=new Map,this.readyStatus=!1,this.exposureCache=[]}return e.prototype.apply=function(e,t){var n=this;if(this.collect=e,this.config=t,this.config.enable_ab_test){var i=t.enable_multilink,r=t.ab_channel_domain,o=t.enable_ab_visual,a=t.ab_cross,s=t.ab_cookie_domain,c=t.ab_timeout,u=r||I(Z[t.channel||"sg"]),l=e.adapters.storage;this.cacheStorgae=new l(!1),this.timeout=c||3e3,this.enable_multilink=i,this.enable_ab_visual=o,this.abKey="__tea_sdk_ab_version_"+t.app_id,this.ab_cross=a,this.ab_cookie_domain=s||"",this.fetchUrl=u+"/service/2/abtest_config/",this.reportUrl=this.collect.configManager.getUrl("event"),this.exposureLimit=t.exposure_limit||20,this.ab_batch_time=t.ab_batch_time||500;var h=this.collect.Types;this.types=h,this.collect.on(h.TokenChange,function(e){"uuid"===e&&n.readyStatus&&(n.clearCache(),n.fetchAB())}),this.collect.on(h.AbVar,function(e){var t=e.name,i=e.defaultValue,r=e.callback;n.getVar(t,i,r)}),this.collect.on(h.AbAllVars,function(e){n.getAllVars(e)}),this.collect.on(h.AbConfig,function(e){var t=e.params,i=e.callback;n.getABconfig(t,i)}),this.collect.on(h.AbExternalVersion,function(e){n.setExternalAbVersion(e)}),this.collect.on(h.AbOpenLayer,function(){n.openOverlayer()}),this.collect.on(h.AbCloseLayer,function(){n.closeOverlayer()}),this.collect.on(h.AbVersionChangeOn,function(e){n.changeListener.set(e,e)}),this.collect.on(h.AbVersionChangeOff,function(e){n.changeListener.get(e)&&n.changeListener.delete(e)}),this.loadMode(),(this.enable_ab_visual||this.enable_multilink)&&this.openOverlayer(this.config.multilink_timeout_ms||500),this.checkLocal(),this.ready("ab"),this.readyStatus||(this.fetchAB(),this.readyStatus=!0),this.collect.emit(h.AbReady)}},e.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var n=this.collect.hook._hooksCache[e];if(!Object.keys(n).length)return;var i=function(e){n[e].length&&n[e].forEach(function(n){t.collect.hook.emit(e,n)})};for(var r in n)i(r)}},e.prototype.loadMode=function(){var e,t,n=function(){try{return JSON.parse(atob(window.name))||void 0}catch(e){return}}(),i="";if(n){var r=n.scenario,o=n.href;r?(this.editMode=!0,i=r):o&&(-1!==o.indexOf("datatester")||-1!==o.indexOf("visual-editor"))&&(this.editMode=!0,i="visual-editor")}this.enable_ab_visual&&(function(e,t){window.TEAVisualEditor=window.TEAVisualEditor||{},eR(["*"]);var n,i="";eI(t,et);var r="";try{var o=window.performance.getEntriesByType("resource");if(o&&o.length&&(o.forEach(function(e){"script"===e.initiatorType&&e.name&&-1!==e.name.indexOf("collect")&&(r=e.name)}),r||document.currentScript&&(r=document.currentScript.src),r&&(n=r.split("/"))&&n.length)){i="https:/";for(var a=2;a<n.length&&a!==n.length-1;a++)i=i+"/"+n[a];i+="/visual-ab-core"}}catch(e){}eM("tea:openVisualABEditor",function(n){var r=n.data;if("string"==typeof n.data)try{r=JSON.parse(n.data)}catch(e){r=void 0}if(r){var o=r.lang;if(r.appId!==t.app_id)return void eO(n,"appIdError");var a=r.version;eG=a&&i?i+(a?"."+a:".1.0.1")+".js?query="+Date.now():"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/visual-ab-core.js?query="+Date.now(),window.TEAVisualEditor.lang=o,window.TEAVisualEditor.__ab_domin=t.channel_domain||"",eN({event:n,editorUrl:eG,collectInstance:e})}})}(this.collect,this.config),"visual-editor"===i)?this.collect.destoryInstace():this.enable_multilink&&(e=this.collect,t=this.config,window.TEAVisualEditor=window.TEAVisualEditor||{},window.TEAVisualEditor.appId=t.app_id,eM("tea:openTesterEventInspector",function(t){var n=t.data;if("string"==typeof t.data)try{n=JSON.parse(t.data)}catch(e){n=void 0}if(n){var i=n.referrer,r=n.lang,o=n.appId;window.TEAVisualEditor.__editor_ajax_domain=i||"",window.TEAVisualEditor.__ab_appId=o||"",window.TEAVisualEditor.lang=r||"",eN({event:t,editorUrl:"https://lf16-data.bytepluscdn.com/obj/data-static-sg/log-sdk/collect/tester-event-inspector.js?query="+Date.now(),collectInstance:e})}}))},e.prototype.checkLocal=function(){var e=this.getABCache(),t=e.ab_version,n=e.ab_ext_version,i=e.ab_version_multilink,r=(e.data,this.checkFromUrl());r?this.mulilinkVersions.push(r):this.mulilinkVersions=i||[],this.extVersions=n||[],this.versions=t||[];var o=this.versions.concat(this.extVersions);this.enable_multilink&&(o=o.concat(this.mulilinkVersions))},e.prototype.checkFromUrl=function(){var e=B(window.location.href);return e&&e.vid?e.vid:""},e.prototype.updateVersions=function(){var e=this.extVersions.length?this.versions.concat(this.extVersions):this.versions;this.enable_multilink&&(e=e.concat(this.mulilinkVersions)),this.configVersions(e.join(",")),this.updateABCache(),this.changeListener.size>0&&this.changeListener.forEach(function(t){"function"==typeof t&&t(e)})},e.prototype.configVersions=function(e){this.collect.configManager.setAbVersion(e)},e.prototype.getVar=function(e,t,n,i){if(!e)throw Error("variable must not be empty");if(void 0===t)throw Error("variable no default value");if("function"!=typeof n)throw Error("callback must be a function");var r={name:e,defaultValue:t,callback:n,type:to.Var};"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealVar(r,e,i):this.callbacks.push(r)},e.prototype.setAbUuid=function(e,t){this.collect.configManager.setAbUuidCache(e,t)},e.prototype.getRealVar=function(e,t,n){var i=e.name,r=e.defaultValue,o=e.callback,a=this.data;if(a){if(O(a[i])){var s=a[i].vid;return"$ab_url"===t?this.mulilinkVersions.includes(s)||this.mulilinkVersions.push(s):this.versions.includes(s)||this.versions.push(s),this.setAbUuid(s,n),this.updateVersions(),this.fechEvent(s,t,r),o(a[i].val),void this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u66DD\u5149\u4E86\u5B9E\u9A8C"+i,level:"info",time:Date.now(),data:a[i]})}this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u8C03\u7528getVar",level:"info",time:Date.now(),data:r}),o(r)}else o(r)},e.prototype.getAllVars=function(e){if("function"!=typeof e)throw Error("callback must be a function");var t={callback:e,type:to.All};"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealAllVars(t):this.callbacks.push(t)},e.prototype.getRealAllVars=function(e){(0,e.callback)(this.data?JSON.parse(JSON.stringify(this.data)):{}),this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u8C03\u7528getAllVars",level:"info",time:Date.now(),data:this.data})},e.prototype.fechEvent=function(e,t,n){try{if(this.config.disable_track_event||!e)return;var i=this.collect.configManager.get(),r=i.header,o=i.user,a=this.getABCache();if(a&&a.uuid&&a.uuid!==o.user_unique_id)return;var s={event:"abtest_exposure",ab_sdk_version:""+e,params:JSON.stringify({app_id:this.config.appId,ab_url:"$ab_url"===t?n:window.location.href,data:this.data}),local_time_ms:Date.now()};r.custom=JSON.stringify(r.custom),this.reportExposure({events:[s],user:o,header:r},t)}catch(e){this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}},e.prototype.reportExposure=function(e,t){var n=this;this.exposureCache.push(e),this.reportTimeout&&clearTimeout(this.reportTimeout),this.exposureCache.length>=this.exposureLimit?this.report(t):this.reportTimeout=setTimeout(function(){n.report(t),clearTimeout(n.reportTimeout)},this.ab_batch_time)},e.prototype.report=function(e){var t=this;this.collect.requestManager.useRequest({url:this.reportUrl,data:this.exposureCache,timeout:2e4,useBeacon:"$ab_url"===e}),this.exposureCache.forEach(function(e){t.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_EVENT,info:"\u57CB\u70B9\u4E0A\u62A5\u6210\u529F",time:Date.now(),data:[e],code:200,status:"success"})}),this.exposureCache=[]},e.prototype.setExternalAbVersion=function(e){this.extVersions=[e],this.updateVersions()},e.prototype.getABconfig=function(e,t){var n=Object.keys(e);n&&n.length&&this.collect.configManager.set(e),this.fetchAB(t)},e.prototype.get=function(e){if(this.ab_cross){var t=this.cacheStorgae.getCookie(e,this.ab_cookie_domain);return t?JSON.parse(t):{}}return this.cacheStorgae.getItem(e)},e.prototype.set=function(e,t){this.ab_cross?this.cacheStorgae.setCookie(e,t,2592e6,this.ab_cookie_domain):this.cacheStorgae.setItem(e,t),this.collect.configManager.setAbCache(t),this.collect.event("abtest_cache",{env_uuid:this.collect.configManager.get("user").user_unique_id||"",cache:JSON.stringify(t)})},e.prototype.getABCache=function(e){var t={ab_version:[],ab_ext_version:[],ab_version_multilink:[],data:null,timestamp:+new Date,uuid:""};return t=this.get(this.abKey)||t,e?t[e]:t},e.prototype.updateABCache=function(){var e=this.getABCache();e.ab_version_multilink=this.mulilinkVersions,e.ab_ext_version=this.extVersions,e.ab_version=this.versions,e.timestamp=Date.now(),this.set(this.abKey,e)},e.prototype.setAbCache=function(e){var t=this.getABCache();t.data=this.data,t.uuid=e,t.timestamp=Date.now(),this.set(this.abKey,t)},e.prototype.clearCache=function(){this.refreshFetchStatus="ing",this.data={},this.extVersions=[],this.mulilinkVersions=[],this.versions=[],this.collect.configManager.clearAbCache()},e.prototype.openOverlayer=function(e){var t=this;if(function(){if(!document.getElementById(eA)){var e="body { opacity: 0 !important; }",t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.id=eA,n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),t.appendChild(n)}}(),e)var n=setTimeout(function(){t.closeOverlayer(),clearTimeout(n)},e)},e.prototype.closeOverlayer=function(){var e;(e=document.getElementById(eA))&&e.parentElement.removeChild(e)},e.prototype.fetchComplete=function(e,t){var n=this;try{if(e&&"[object Object]"==Object.prototype.toString.call(e)){this.data=e,this.setAbCache(t);var i=[];Object.keys(e).forEach(function(t){var n=e[t].vid;n&&i.push(n)}),this.versions=this.versions.filter(function(e){return i.includes(e)});var r=e.$ab_url,o=e.$ab_modification;if(o&&o.val&&this.enable_ab_visual){if(this.collect.destroy)return;this.getVar("$ab_modification",window.location.href,function(){var e;e=o.val,window.TEAVisualEditor=window.TEAVisualEditor||{},window.TEAVisualEditor.__ab_config=e,x("https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/visual-ab-loader.js?query="+Date.now(),function(){},function(){}),n.closeOverlayer()})}else if(r&&this.enable_multilink){this.mulilinkVersions=this.mulilinkVersions.filter(function(e){return i.includes(e)});var a=r.val,s=r.vid;a&&s&&this.getVar("$ab_url",a,function(){n.editMode||(a!==window.location.href?setTimeout(function(){if(!n.collect.destroy){var e=""+a;e=-1===e.indexOf("http")?"https://"+e:e,P(e).host!==location.host?e=e+"&vid="+s:window.history.replaceState("","",e),window.location.href=e}},100):n.closeOverlayer())})}this.updateVersions()}else this.closeOverlayer();this.callbacks.forEach(function(e){return n[e.type===to.Var?"getRealVar":"getRealAllVars"](e,"")}),this.callbacks=[]}catch(e){}},e.prototype.fetchAB=function(e){var t=this,n=this.collect.configManager.get(),i={header:w({aid:this.config.app_id},n.user||{},n.header||{},{ab_sdk_version:this.collect.configManager.getAbVersion(),ab_url:window.location.href})},r=n.user.user_unique_id;this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"SDK \u53D1\u8D77AB\u5B9E\u9A8C\u8BF7\u6C42",level:"info",logType:"fetch",time:Date.now(),data:i}),this.collect.requestManager.useRequest({url:this.fetchUrl,data:i,success:function(n){t.fetchStatus="complete",t.refreshFetchStatus="complete";var i=n.data;"success"===n.message?(t.fetchComplete(i,r),e&&e(i)):(t.fetchComplete(null,r),e&&e(null)),t.collect.emit(t.types.AbComplete,i),t.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"AB\u5B9E\u9A8C\u8BF7\u6C42\u6210\u529F",level:"info",logType:"fetch",time:Date.now(),data:i})},fail:function(){t.fetchStatus="complete",t.refreshFetchStatus="complete",t.fetchComplete(null,n.user.user_unique_id),t.collect.emit(t.types.AbTimeout),e&&e(null),t.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"AB\u5B9E\u9A8C\u8BF7\u6C42\u7F51\u7EDC\u5F02\u5E38",level:"error",logType:"fetch",time:Date.now()})},timeout:this.timeout})},e.prototype.filterUrl=function(e){try{var t="";-1!==e.indexOf("&multilink=true")?t="&multilink=true[\0-\xff]*":-1!==e.indexOf("?multilink=true")&&(t="\\?multilink=true[\0-\xff]*");var n=RegExp(t,"g");e=e.replace(n,"")}catch(e){}return e},e}(),eP=function(){function e(){}return e.prototype.apply=function(e,t){var n=this;if(t.event_verify_url&&"string"==typeof t.event_verify_url&&(this.url=t.event_verify_url+"/v1/list_test",this.url)){var i=e.Types;e.on(i.SubmitBefore,function(t){e.requestManager.useBeacon({url:n.url,data:t})})}},e}(),eB=function(){function e(e,t){this.maxDuration=432e5,this.aliveDTime=6e4,this.options={aliveName:"predefine_page_alive",params:{}},this.collect=e,this.config=t,this.pageStartTime=Date.now(),this.sessionStartTime=this.pageStartTime,this.timerHandler=null,O(t.enable_stay_duration)&&(this.options=Object.assign(this.options,t.enable_stay_duration))}return e.prototype.setParams=function(e,t,n){this.set_path=e,this.set_url=n,this.set_title=t},e.prototype.enable=function(e,t,n){this.url_path=e,this.url=n,this.title=t,this.disableCallback=this.enablePageAlive()},e.prototype.disable=function(){this.disableCallback(),this.pageStartTime=Date.now()},e.prototype.sendEvent=function(e,t){void 0===t&&(t=!1);var n=t?this.aliveDTime:Date.now()-this.sessionStartTime;n<0||n>this.aliveDTime||Date.now()-this.pageStartTime>this.maxDuration||t&&"hidden"===document.visibilityState||(this.collect.beconEvent(this.options.aliveName,w({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),duration:n,is_support_visibility_change:N(),startTime:this.sessionStartTime,hidden:document.visibilityState,leave:e},this.options.params)),this.sessionStartTime=Date.now())},e.prototype.getParams=function(e){switch(e){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},e.prototype.setUpTimer=function(){var e=this;return this.timerHandler&&clearInterval(this.timerHandler),setInterval(function(){Date.now()-e.sessionStartTime>e.aliveDTime&&e.sendEvent(!1,!0)},1e3)},e.prototype.visibilitychange=function(){"hidden"===document.visibilityState?this.timerHandler&&(clearInterval(this.timerHandler),this.sendEvent(!1)):"visible"===document.visibilityState&&(this.sessionStartTime=Date.now(),this.timerHandler=this.setUpTimer())},e.prototype.beforeunload=function(){document.hidden||this.sendEvent(!0)},e.prototype.enablePageAlive=function(){var e=this;this.timerHandler=this.setUpTimer();var t=this.visibilitychange.bind(this),n=this.beforeunload.bind(this);return document.addEventListener("visibilitychange",t),G(n),function(){e.beforeunload(),document.removeEventListener("visibilitychange",t),window.removeEventListener("beforeunload",n),window.removeEventListener("pagehide",n)}},e}(),eL=function(){function e(e,t){var n=this;this.maxDuration=432e5,this.aliveDTime=6e4,this.options={closeName:"predefine_page_close",params:{}},this.visibilitychange=function(){"hidden"===document.visibilityState?n.activeEndTime=Date.now():"visible"===document.visibilityState&&(n.activeEndTime&&(n.totalTime+=n.activeEndTime-n.activeStartTime,n.activeTimes+=1),n.activeEndTime=void 0,n.activeStartTime=Date.now())},this.beforeunload=function(){if(n.totalTime+=(n.activeEndTime||Date.now())-n.activeStartTime,n.config.autotrack)try{window.sessionStorage.setItem("_tea_cache_duration",JSON.stringify({duration:n.totalTime,page_title:document.title||location.pathname}))}catch(e){}n.sendEventPageClose()},this.collect=e,this.config=t,this.maxDuration=t.maxDuration||864e5,this.pageStartTime=Date.now(),O(t.enable_stay_duration)&&(this.options=Object.assign(this.options,t.enable_stay_duration)),this.resetData()}return e.prototype.setParams=function(e,t,n){this.set_path=e,this.set_url=n,this.set_title=t},e.prototype.resetParams=function(e,t,n){this.url_path=e,this.url=n,this.title=t},e.prototype.enable=function(e,t,n){this.url_path=e,this.url=n,this.title=t,this.disableCallback=this.enablePageClose()},e.prototype.disable=function(){this.disableCallback()},e.prototype.resetData=function(){this.activeStartTime=void 0===this.activeStartTime?this.pageStartTime:Date.now(),this.activeEndTime=void 0,this.activeTimes=1,this.totalTime=0,this.resetParams(location.pathname,document.title,location.href)},e.prototype.sendEventPageClose=function(){var e=Date.now()-this.pageStartTime;this.totalTime<0||e<0||this.totalTime>=this.maxDuration||(this.collect.beconEvent(this.options.closeName,w({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),active_times:this.activeTimes,duration:this.totalTime,total_duration:e,is_support_visibility_change:N()},this.options.params)),this.pageStartTime=Date.now(),this.resetData())},e.prototype.getParams=function(e){switch(e){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},e.prototype.enablePageClose=function(){var e=this,t=this.visibilitychange.bind(this),n=this.beforeunload.bind(this);return document.addEventListener("visibilitychange",t),G(n),function(){e.beforeunload(),document.removeEventListener("visibilitychange",t),window.removeEventListener("beforeunload",n),window.removeEventListener("pagehide",n)}},e}(),eU=function(){function e(){}return e.prototype.apply=function(e,t){var n=this;if(this.collect=e,this.config=t,this.config.enable_stay_duration){this.title=document.title||location.pathname,this.url=location.href,this.url_path=location.pathname,this.pageAlive=new eB(e,t),this.pageClose=new eL(e,t);var i=this.collect.Types;this.collect.on(i.ResetStay,function(e){var t=e.url_path,i=e.title,r=e.url;n.resetStayDuration(t,i,r)}),this.collect.on(i.RouteChange,function(e){e.init||t.disable_route_report||n.resetStayDuration()}),this.collect.on(i.SetStay,function(e){var t=e.url_path,i=e.title,r=e.url;n.setStayParmas(t,i,r)}),this.enable(this.url_path,this.title,this.url),this.ready(i.Stay),this.collect.emit(i.StayReady)}},e.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var n=this.collect.hook._hooksCache[e];if(!Object.keys(n).length)return;var i=function(e){n[e].length&&n[e].forEach(function(n){t.collect.hook.emit(e,n)})};for(var r in n)i(r)}},e.prototype.enable=function(e,t,n){this.pageAlive.enable(e,t,n),this.pageClose.enable(e,t,n)},e.prototype.disable=function(){this.pageAlive.disable(),this.pageClose.disable()},e.prototype.setStayParmas=function(e,t,n){void 0===e&&(e=""),void 0===t&&(t=""),void 0===n&&(n=""),this.pageAlive.setParams(e,t,n),this.pageClose.setParams(e,t,n),this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884C resetStayParams",level:"info",time:Date.now(),data:{url_path:e,title:t,url:n}})},e.prototype.reset=function(e,t,n){this.disable(),this.enable(e,t,n)},e.prototype.resetStayDuration=function(e,t,n){this.reset(e,t,n),this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884C resetStayDuration",level:"info",time:Date.now(),data:{url_path:e,title:t,url:n}})},e}(),ej=function(){function e(){}return e.prototype.apply=function(e,t){var n=this;this.collect=e,this.config=t,this.duration=6e4,this.reportUrl=e.configManager.getDomain()+"/profile/list";var i=e.Types;this.eventCheck=new en(e,t),this.cache={},this.collect.on(i.ProfileSet,function(e){n.setProfile(e)}),this.collect.on(i.ProfileSetOnce,function(e){n.setOnceProfile(e)}),this.collect.on(i.ProfileUnset,function(e){n.unsetProfile(e)}),this.collect.on(i.ProfileIncrement,function(e){n.incrementProfile(e)}),this.collect.on(i.ProfileAppend,function(e){n.appendProfile(e)}),this.collect.on(i.ProfileClear,function(){n.cache={}}),this.ready(i.Profile)},e.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var n=this.collect.hook._hooksCache[e];if(!Object.keys(n).length)return;var i=function(e){n[e].length&&n[e].forEach(function(n){t.collect.hook.emit(e,n)})};for(var r in n)i(r)}},e.prototype.report=function(e,t){void 0===t&&(t={});try{if(this.config.disable_track_event)return;var n=[];n.push(this.collect.processEvent(e,t));var i=this.collect.eventManager.merge(n);this.collect.requestManager.useRequest({url:this.reportUrl,data:i}),this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_EVENT,info:"\u57CB\u70B9\u4E0A\u62A5\u6210\u529F",time:Date.now(),data:i,code:200,status:"success"})}catch(e){this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}},e.prototype.setProfile=function(e){var t=this.formatParams(e);t&&Object.keys(t).length&&(this.pushCache(t),this.report("__profile_set",w({},t,{profile:!0})))},e.prototype.setOnceProfile=function(e){var t=this.formatParams(e,!0);t&&Object.keys(t).length&&(this.pushCache(t),this.report("__profile_set_once",w({},t,{profile:!0})))},e.prototype.incrementProfile=function(e){e&&this.report("__profile_increment",w({},e,{profile:!0}))},e.prototype.unsetProfile=function(e){if(e){var t={};t[e]="1",this.report("__profile_unset",w({},t,{profile:!0}))}},e.prototype.appendProfile=function(e){if(e){var t={};for(var n in e)("string"==typeof e[n]||"Array"===Object.prototype.toString.call(e[n]).slice(8,-1))&&(t[n]=e[n]);Object.keys(t).length&&this.report("__profile_append",w({},t,{profile:!0}))}},e.prototype.pushCache=function(e){var t=this;Object.keys(e).forEach(function(n){t.cache[n]={val:t.clone(e[n]),timestamp:Date.now()}})},e.prototype.formatParams=function(e,t){var n=this;void 0===t&&(t=!1);try{if(!e||"[object Object]"!==Object.prototype.toString.call(e))return;var i={};for(var r in e)("string"==typeof e[r]||"number"==typeof e[r]||"Array"===Object.prototype.toString.call(e[r]).slice(8,-1))&&(i[r]=e[r]);var o=Object.keys(i);if(!o.length||!this.eventCheck.checkEventParams(i))return;var a=Date.now();return o.filter(function(i){var r=n.cache[i];return t?!r:!(r&&n.compare(r.val,e[i])&&a-r.timestamp<n.duration)}).reduce(function(e,t){return e[t]=i[t],e},{})}catch(e){this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}},e.prototype.compare=function(e,t){try{return JSON.stringify(e)===JSON.stringify(t)}catch(e){return this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message}),!1}},e.prototype.clone=function(e){try{return JSON.parse(JSON.stringify(e))}catch(t){return this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message}),e}},e.prototype.unReady=function(){},e}(),eV=function(){function e(){var e=this;this.setInterval=function(){e.clearIntervalFunc=z(function(){e.isSessionhasEvent&&e.endCurrentSession()},e.sessionInterval)},this.clearInterval=function(){e.clearIntervalFunc&&e.clearIntervalFunc()}}return e.prototype.apply=function(e,t){var n=this;if(this.collect=e,!t.disable_heartbeat){this.sessionInterval=6e4,this.startTime=0,this.lastTime=0,this.setInterval();var i=this.collect.Types;this.collect.on(i.SessionReset,function(){n.process()})}},e.prototype.endCurrentSession=function(){this.collect.event("_be_active",{start_time:this.startTime,end_time:this.lastTime,url:window.location.href,referrer:window.document.referrer,title:document.title||location.pathname}),this.isSessionhasEvent=!1,this.startTime=0},e.prototype.process=function(){this.isSessionhasEvent||(this.isSessionhasEvent=!0,this.startTime=+new Date);var e=this.lastTime||+new Date;this.lastTime=+new Date,this.lastTime-e>this.sessionInterval&&(this.clearInterval(),this.endCurrentSession(),this.setInterval())},e}(),eK=function(){function e(){}return e.prototype.apply=function(e,t){var n=this;if(this.collect=e,this.config=t,!this.config.channel_domain&&!t.disable_track_event&&!t.disable_sdk_monitor){this.url=e.configManager.getUrl("event");var i=this.collect.Types;this.collect.on(i.Ready,function(){n.sdkOnload()}),this.collect.on(i.SubmitError,function(e){var t=e.type,i=e.eventData,r=e.errorCode;"f_data"===t&&n.sdkError(i,r)})}},e.prototype.sdkOnload=function(){var e=this;try{var t=this.collect.configManager.get(),n=t.header,i=t.user,r=n.app_id,o=n.app_name,a=n.sdk_version,s=i.web_id,c={events:[{event:"onload",params:JSON.stringify({app_id:r,app_name:o||"",sdk_version:a,sdk_type:"npm",sdk_config:this.config,sdk_desc:"TOC_OVERSEA"}),local_time_ms:Date.now()}],user:{user_unique_id:s},header:{}};setTimeout(function(){e.collect.requestManager.useRequest({url:e.url,data:[c],timeout:3e4,app_key:"566f58151b0ed37e",forceXhr:!0})},16)}catch(e){}},e.prototype.sdkError=function(e,t){var n=this;try{var i=e[0],r=i.user,o=i.header,a=[];e.forEach(function(e){e.events.forEach(function(e){a.push(e)})});var s={events:a.map(function(e){return{event:"on_error",params:JSON.stringify({error_code:t,app_id:o.app_id,app_name:o.app_name||"",error_event:e.event,sdk_version:o.sdk_version,local_time_ms:e.local_time_ms,tea_event_index:Date.now(),params:e.params,header:JSON.stringify(o),user:JSON.stringify(r)}),local_time_ms:Date.now()}}),user:{user_unique_id:r.user_unique_id},header:{}};setTimeout(function(){n.collect.requestManager.useRequest({url:n.url,data:[s],timeout:3e4,app_key:"566f58151b0ed37e",forceXhr:!0})},16)}catch(e){}},e}();function e$(e,t){if(void 0===t&&(t="list"),!e)return!1;if(t&&"list"===t){if(["LI","TR","DL"].includes(e.nodeName)||e.dataset&&e.dataset.hasOwnProperty("teaIdx")||e.hasAttribute&&e.hasAttribute("data-tea-idx"))return!0}else if(["A","BUTTON"].includes(e.nodeName)||e.dataset&&e.dataset.hasOwnProperty("teaContainer")||e.hasAttribute&&e.hasAttribute("data-tea-container"))return!0;return!1}function eq(e){for(var t=e;t&&!e$(t,"container");){if("HTML"===t.nodeName||"BODY"===t.nodeName)return e;t=t.parentElement}return t||e}function eH(e){var t="";return 3===e.nodeType?t=e.textContent.trim():e.dataset&&e.dataset.hasOwnProperty("teaTitle")?t=e.getAttribute("data-tea-title"):e.hasAttribute("ata-tea-title")?t=e.getAttribute("data-tea-title"):e.hasAttribute("title")?t=e.getAttribute("title"):"INPUT"===e.nodeName&&["button","submit"].includes(e.getAttribute("type"))?t=e.getAttribute("value"):"IMG"===e.nodeName&&e.getAttribute("alt")&&(t=e.getAttribute("alt")),t.slice(0,200)}var eW=function(e,t){return e.hasAttribute?e.hasAttribute(t):e.attributes?!(!e.attributes[t]||!e.attributes[t].specified):void 0},eJ=function(e,t){if("string"==typeof t)return eW(e,t);if(M(t)){for(var n=!1,i=0;i<t.length;i++)if(eW(e,t[i])){n=!0;break}return n}},eF=function(e,t){var n={};if("string"==typeof t)eW(e,t)&&(n.attrs=e.getAttribute(t));else if(M(t))for(var i=0;i<t.length;i++)eW(e,t[i])&&(n[t[i]]=e.getAttribute(t[i]));return n},eX=function(e){if(e.children.length){var t=e.children;return![].slice.call(t).some(function(e){return e.children.length>0})}return!0},eY=function(e){if("svg"===e.tagName.toLowerCase())return!0;for(var t=e.parentElement,n=!1;t;)"svg"===t.tagName.toLowerCase()?(t=null,n=!0):t=t.parentElement;return n},eZ=function(){function e(e,t,n){var i=this;this.statistics=!1,this.pageView=!1,this.clickEvent=function(e){var t,n;t=e.target,n=i.options,!(1!==t.nodeType||!n.svg&&eY(t)||["HTML","BODY"].includes(t.tagName.toUpperCase()))&&"none"!==t.style.display&&(e$(t,"container")||eX(t)||n.svg)&&i.eventHandel({eventType:"dom",eventName:"click"},e)},this.changeEvent=function(e){i.eventHandel({eventType:"dom",eventName:"change"},e)},this.submitEvent=function(e){i.eventHandel({eventType:"dom",eventName:"submit"},e)},this.getPageViewEvent=function(e,t){t&&"pushState"===t&&i.eventHandel({eventType:"dom",eventName:"beat"},w({beat_type:0},e)),i.eventHandel({eventType:"dom",eventName:"page_view"},e)},this.getPageLoadEvent=function(e){i.eventHandel({eventType:"dom",eventName:"page_statistics"},{lcp:e})},this.config=n.getConfig().eventConfig,this.collect=t,this.options=e,this.beatTime=e.beat}return e.prototype.init=function(e){this.eventHandel=e;var t=this.config.mode;this.addListener(t)},e.prototype.addListener=function(e){var t=this;if("proxy-capturing"===e){if(this.config.click&&window.document.addEventListener("click",this.clickEvent,!0),this.config.change&&window.document.addEventListener("change",this.changeEvent,!0),this.config.submit&&window.document.addEventListener("submit",this.submitEvent,!0),this.config.pv){this.collect.on("route-change",function(e){var n=e.config,i=e.name;t.getPageViewEvent(n,i),t.pageView=!0});var n=setTimeout(function(){t.pageView||(t.getPageViewEvent(t.getDefaultConfig()),t.pageView=!0,clearTimeout(n))},2e3)}if(this.config.beat){try{"complete"===document.readyState?this.beatEvent(this.beatTime):window.addEventListener("load",function(){t.beatEvent(t.beatTime)});var i=0,r=null;window.addEventListener("scroll",function(){clearTimeout(r),r=setTimeout(o,500),i=document.documentElement.scrollTop||document.body.scrollTop});var o=function(){(document.documentElement.scrollTop||document.body.scrollTop)==i&&t.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:1})}}catch(e){}try{var a=window.performance&&window.performance.getEntriesByType("paint");a&&a.length?(new PerformanceObserver(function(e){var n=e.getEntries(),i=n[n.length-1],r=i.renderTime||i.loadTime;t.statistics||(t.getPageLoadEvent(r),t.statistics=!0)}).observe({entryTypes:["largest-contentful-paint"]}),setTimeout(function(){t.statistics||(t.getPageLoadEvent(a[0].startTime||0),t.statistics=!0)},2e3)):this.getPageLoadEvent(0)}catch(e){this.getPageLoadEvent(0)}}}},e.prototype.removeListener=function(){window.document.removeEventListener("click",this.clickEvent,!0),window.document.removeEventListener("change",this.changeEvent,!0),window.document.removeEventListener("submit",this.submitEvent,!0)},e.prototype.beatEvent=function(e){var t,n=this;try{this.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:3}),this.beatTime&&(t=setInterval(function(){n.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:2})},e)),G(function(){n.eventHandel({eventType:"dom",eventName:"beat",eventSend:"becon"},{beat_type:0}),n.beatTime&&clearInterval(t)})}catch(e){}},e.prototype.getDefaultConfig=function(){return{is_html:1,url:location.href,referrer:document.referrer,page_key:location.href,refer_page_key:document.referrer,page_title:document.title||location.pathname,page_manual_key:"",refer_page_manual_key:"",refer_page_title:"",page_path:location.pathname,page_host:location.host}},e}(),eQ={eventConfig:{mode:"proxy-capturing",submit:!1,click:!0,change:!1,pv:!0,beat:!0,hashTag:!1,impr:!1},scoutConfig:{mode:"xpath"}},e0=function(){function e(e,t){this.config=e,this.config.eventConfig=Object.assign(this.config.eventConfig,t)}return e.prototype.getConfig=function(){return this.config},e.prototype.setConfig=function(e){return this.config=e},e}(),e1=function(e,t,n,i,r){return w({event:e},function(e,t,n,i){var r,o,a,s,c,u,l,h,p,f,d={},g=function(e){if(e){var t=e.getBoundingClientRect(),n=t.width,i=t.height;return{left:t.left,top:t.top,element_width:n,element_height:i}}}(t),_=(void 0===(r=e)&&(r={}),void 0===(o=g)&&(o={}),a=r.clientX,s=r.clientY,{touch_x:Math.floor(a-(c=o.left)>=0?a-c:0),touch_y:Math.floor(s-(u=o.top)>=0?s-u:0)}),m=g.element_width,v=g.element_height,y=_.touch_x,b=_.touch_y,E=function(e){for(var t=[];null!==e.parentElement;)t.push(e),e=e.parentElement;var n=[],i=[];return t.forEach(function(e){var t=function(e){if(null===e)return{str:"",index:0};var t=0,n=e.parentElement;if(n)for(var i=n.children,r=0;r<i.length&&i[r]!==e;r++)i[r].nodeName===e.nodeName&&t++;return{str:[e.nodeName.toLowerCase(),e$(e,"list")?"[]":""].join(""),index:t}}(e),r=t.str,o=t.index;n.unshift(r),i.unshift(o)}),{element_path:"/"+n.join("/"),positions:i}}(t),w=E.element_path,S=E.positions,k=(l=eq(t),h=[],function e(t){var n=eH(t);if(n&&-1===h.indexOf(n)&&h.push(n),t.childNodes.length>0)for(var i=t.childNodes,r=0;r<i.length;r++)8!==i[r].nodeType&&e(i[r])}(l),h),A=window.performance.timing.navigationStart,D=Date.now()-A,T=S.map(function(e){return""+e}),R=null;if(window.TEAVisualEditor&&window.TEAVisualEditor.getOriginXpath&&(R=window.TEAVisualEditor.getOriginXpath({xpath:w,positions:T})),d.element_path=R&&R.xpath||w,d.positions=R&&R.positions||T,i&&!i.text&&(d.texts=k,d.element_title=(p=eq(t),f="",function e(t){var n=eH(t);if(n&&(f+=n),t.childNodes.length>0)for(var i=t.childNodes,r=0;r<i.length;r++)3===i[r].nodeType&&e(i[r])}(p),f)),d.element_id=t.getAttribute("id")||"",d.element_class_name=t.getAttribute("class")||"",d.element_type=t.nodeType,d.element_width=Math.floor(m),d.element_height=Math.floor(v),d.touch_x=y,d.touch_y=b,d.page_manual_key="",d.elememt_manual_key="",d.since_page_start_ms=D,d.page_start_ms=A,d.page_path=location.pathname,d.page_host=location.host,n.track_attr&&eJ(t,n.track_attr)){var O=eF(t,n.track_attr);for(var M in O)d[M]=O[M]}var C=eq(t);return"A"===C.tagName&&(d.href=C.getAttribute("href")),"IMG"===t.tagName&&(d.src=t.getAttribute("src")),d}(t,n,i,r),{is_html:1,page_key:window.location.href,page_title:document.title})},e2=function(){function e(e,t){this.ignore={text:!0},this.initConfig=e,this.options=t,this.eventName=t&&"tea"===t.custom?{click:"__bav_click",page:"__bav_page",beat:"__bav_beat",static:"__bav_page_statistics",exposure:"__bav_page_exposure"}:{click:"bav2b_click",page:"bav2b_page",beat:"bav2b_beat",static:"bav2b_page_statistics",exposure:"bav2b_exposure"},t&&!0===t.text&&(this.ignore.text=!1),t&&t.exposure&&t.exposure.eventName&&(this.eventName.exposure=t.exposure.eventName)}return e.prototype.handleEvent=function(e,t){try{if(function(e){for(var t=e;t&&t.parentNode;){if(t.hasAttribute("data-tea-ignore"))return!0;if("HTML"===t.nodeName||"body"===t.nodeName)break;t=t.parentNode}return!1}(e.target))return null;var n="bav2b_click";switch(t){case"click":return n=this.eventName.click,e1(n,e,e.target,this.options,this.ignore);case"exposure":return n=this.eventName.exposure,e1(n,e,e.target,this.options,this.ignore);case"change":return w({},e1(n="bav2b_change",e,e.target,this.options),function(e,t){try{if("bav2b_change"===e)return t.hasAttribute("data-tea-track")?{value:t.value}:{}}catch(e){return{}}}(n,e.target));case"submit":return e1(n="bav2b_submit",e,e.target,this.options)}}catch(e){return null}},e.prototype.handleViewEvent=function(e){e.event=this.eventName.page,e.page_title=document.title,e.page_total_width=window.innerWidth,e.page_total_height=window.innerHeight;try{var t=window.sessionStorage.getItem("_tea_cache_duration");if(t){var n=JSON.parse(t);e.refer_page_duration_ms=n?n.duration:""}e.scroll_width=document.documentElement.scrollLeft?document.documentElement.scrollLeft+window.innerWidth:window.innerWidth,e.scroll_height=document.documentElement.scrollTop?document.documentElement.scrollTop+window.innerHeight:window.innerHeight,e.page_start_ms=window.performance.timing.navigationStart}catch(e){}return e},e.prototype.handleStatisticsEvent=function(e){var t={};t.event=this.eventName.static,t.is_html=1,t.page_key=location.href,t.refer_page_key=document.referrer||"",t.page_title=document.title,t.page_manual_key=this.initConfig.autotrack.page_manual_key||"",t.refer_page_manual_key="";try{var n=e.lcp,i=window.performance.timing,r=i.loadEventEnd-i.navigationStart;t.page_init_cost_ms=parseInt(n||(r>0?r:0)),t.page_start_ms=i.navigationStart}catch(e){}return t},e.prototype.handleBeadtEvent=function(e){e.event=this.eventName.beat,e.page_key=window.location.href,e.is_html=1,e.page_title=document.title,e.page_manual_key=this.initConfig.autotrack.page_manual_key||"";try{e.page_viewport_width=window.innerWidth,e.page_viewport_height=window.innerHeight,e.page_total_width=document.documentElement.scrollWidth,e.page_total_height=document.documentElement.scrollHeight,e.scroll_width=document.documentElement.scrollLeft+window.innerWidth,e.scroll_height=document.documentElement.scrollTop+window.innerHeight,e.since_page_start_ms=Date.now()-window.performance.timing.navigationStart,e.page_start_ms=window.performance.timing.navigationStart}catch(e){}return e},e}(),e4=function(){function e(e){this.collect=e,this.eventNameList=["report_click_event","report_change_event","report_submit_event","report_exposure_event","report_page_view_event","report_page_statistics_event","report_beat_event"]}return e.prototype.send=function(e,t){var n=e.eventSend,i=t.event;delete t.event,n&&"becon"===n?this.collect.beconEvent(i,t):this.collect.event(i,t)},e.prototype.get=function(e,t){fetch(e,Object.assign({headers:{"content-type":"application/json"},method:"GET"},t))},e.prototype.post=function(e,t){fetch(e,Object.assign({headers:{"content-type":"application/json"},method:"POST"},t))},e}(),e3="_TEA_VE_OPEN",e5="_TEA_VE_APIHOST",e8="lang",e6="_VISUAL_EDITOR_V",e9="_VISUAL_EDITOR_U";function e7(){try{var e=window.TEAVisualEditor.lang=window.TEAVisualEditor.lang||K.get(e8),t=window.TEAVisualEditor.__editor_ajax_domain=window.TEAVisualEditor.__editor_ajax_domain||K.get(e5),n=window.TEAVisualEditor.__editor_verison=window.TEAVisualEditor.__editor_verison||K.get(e6),i=window.TEAVisualEditor.__editor_url=window.TEAVisualEditor.__editor_url||K.get(e9),r=+new Date,o=new Date(r+18e5);K.set(e3,"1",{expires:o}),K.set(e5,t,{expires:o}),K.set(e9,i,{expires:o}),K.set(e8,e,{expires:o}),K.set(e6,n||"",{expires:o})}catch(e){}}var te=!1;function tt(e){var t=e.event,n=e.editorUrl,i=e.autoTrackInstance;te||(te=!0,x(n,function(){eO(t,"editorScriptloadSuccess"),i.destroy()},function(){t&&eO(t,"editorScriptloadError"),te=!1}))}var tn,ti,tr,to,ta,ts=function(){function e(e){this._instance=null,this._intersection=e,this.init()}return e.prototype.init=function(){var e=this;this._instance=new MutationObserver(function(t){t.forEach(function(t){"attributes"===t.type&&e.attributeChangeObserve(t),"childList"===t.type&&e.modifyNodeObserve(t)})}),this._instance.observe(document.body,{childList:!0,attributes:!0,subtree:!0,attributeOldValue:!1})},e.prototype.attributeChangeObserve=function(e){e.target.hasAttribute("data-exposure")?this.exposureAdd(e,"mutation"):this.exposureRemove(e)},e.prototype.modifyNodeObserve=function(e){var t=this;Array.prototype.forEach.call(e.addedNodes,function(e){1===e.nodeType&&e.hasAttribute("data-exposure")&&t.exposureAdd(e,"intersect"),t.mapChild(e,t.exposureAdd)}),Array.prototype.forEach.call(e.removedNodes,function(e){1===e.nodeType&&e.hasAttribute("data-exposure")&&t.exposureRemove(e),t.mapChild(e,t.exposureRemove)})},e.prototype.mapChild=function(e,t){var n=this;1===e.nodeType&&e.children.length&&Array.prototype.forEach.call(e.children,function(e){1===e.nodeType&&e.hasAttribute("data-exposure")&&t(e),n.mapChild(e,t)})},e.prototype.exposureAdd=function(e,t){this._intersection.exposureAdd(e,t)},e.prototype.exposureRemove=function(e){this._intersection.exposureRemove(e)},e._exposure_observer=null,e}(),tc=function(){function e(t,n){this.count=1,this.instance=this.buildObserver(),this.observeMap=e._observer_map,t.autotrack.exposure.ratio?this.Ratio=t.autotrack.exposure.ratio:0===t.autotrack.exposure.ratio?this.Ratio=0:this.Ratio=.5,this.EventHandle=n}return e.prototype.buildObserver=function(){var t=this;if(!e._observer_instance)return IntersectionObserver&&(e._observer_instance=new IntersectionObserver(function(e){e.forEach(function(e){t.observeMap.get(e.target._observeId)&&t.exposureEvent(e)})},{threshold:[.01,.25,.5,.75,1]})),e._observer_instance},e.prototype.exposureAdd=function(e,t){var n=e;"mutation"===t&&(n=e.target);var i=n._observeId;if(i||this.observeMap.has(i)){if(!1===n.visible){var r=n.getBoundingClientRect(),o=r.top,a=r.left,s=r.right,c=r.bottom;o>=0&&c<=window.innerHeight&&a>=0&&s<=window.innerWidth&&(n.visible=!0,this.EventHandle({eventType:"dom",eventName:"exposure"},e))}}else n._observeId=this.count,n.visible=!1,this.observeMap.set(this.count,n),this.observe(n),this.count++},e.prototype.exposureRemove=function(e){this.observeMap.has(e._observeId)&&(this.observeMap.delete(e._observeId),this.unobserve(e))},e.prototype.exposureEvent=function(e){e.intersectionRatio>=this.Ratio&&e.isIntersecting?"0"!==e.target.style.opacity&&"hidden"!==e.target.style.visibility&&!0!==e.target.visible&&(e.target.visible=!0,this.EventHandle({eventType:"dom",eventName:"exposure"},e)):e.target.visible=!1},e.prototype.observe=function(e){this.instance.observe(e)},e.prototype.unobserve=function(e){this.instance.unobserve(e)},e._observer_instance=null,e._observer_map=new Map,e}(),tu=function(){function e(e,t){e.autotrack&&e.autotrack.exposure&&(this._intersection=new tc(e,t),this._observer=new ts(this._intersection),this.initObserver())}return e.prototype.initObserver=function(){var e=this;Array.prototype.forEach.call(document.querySelectorAll("[data-exposure]"),function(t){e._intersection.exposureAdd(t,"intersect")})},e}(),tl={hashTag:!1,impr:!1},th=function(){function e(){}return e.prototype.apply=function(e,t){if(this.autoTrackStart=!1,this.collect=e,this.config=t,t.autotrack){var n=e.Types;t.autotrack&&t.autotrack.collect_url&&!t.autotrack.collect_url()||(this.ready(n.Autotrack),this.collect.emit(n.AutotrackReady))}},e.prototype.ready=function(e){this.collect.set(e);var t=this.config.autotrack;t=Object.assign(tl,t="object"==typeof t?t:{}),this.destroyed=!1,this.options=t,this.Config=new e0(eQ,this.options),this.Exposure=new tu(this.config,this.handle.bind(this)),this.Listener=new eZ(t,this.collect,this.Config),this.EventHandle=new e2(this.config,t),this.Request=new e4(this.collect),this.autoTrackStart=!0,this.init(),function(e,t){window.TEAVisualEditor=window.TEAVisualEditor||{};var n="",i="https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/visual-editor-rangers.js?query="+Date.now();window.TEAVisualEditor.appId=t.app_id;var r=t.channel_domain,o="";if(eR(["*"]),r){var a,s="";try{var c=window.performance.getEntriesByType("resource");if(c&&c.length&&(c.forEach(function(e){"script"===e.initiatorType&&e.name&&-1!==e.name.indexOf("collect")&&(s=e.name)}),s&&(a=s.split("/"))&&a.length)){o="https:/";for(var u=2;u<a.length&&u!==a.length-1;u++)o=o+"/"+a[u];o&&o.indexOf("/5.0")&&(o=o.split("/5.0")[0]||o)}}catch(e){}}if(eI(t,et),"1"===K.get(e3)){var l=function(){var e=K.get(e5);try{e=JSON.parse(e)}catch(e){}return e}(),h="";l&&(window.TEAVisualEditor.__editor_ajax_domain=l,h=K.get(e9)),tt({event:null,editorUrl:h||i,autoTrackInstance:e}),e7()}else try{eM("tea:openVisualEditor",function(t){var a=t.data;if("string"==typeof t.data)try{a=JSON.parse(t.data)}catch(e){a=void 0}if(a){var s=a.referrer,c=a.lang;if(s&&(window.TEAVisualEditor.__editor_ajax_domain=s),n=i,r){var u=a.version;n=o?""+o+(u?"/visual-editor-rangers-v"+u:"/visual-editor-rangers-v1.0.0")+".js":i,window.TEAVisualEditor.__editor_verison=u}window.TEAVisualEditor.__editor_url=n,window.TEAVisualEditor.lang=c,tt({event:t,editorUrl:n,autoTrackInstance:e}),e7()}}),window.TEAVisualEditor.openAutotrackEditor=function(){tt({event:null,editorUrl:window.TEAVisualEditor.__editor_url,autoTrackInstance:e})}}catch(e){}try{eM("tea:openHeatMapCore",function(n){var i=n.data.app_id;i&&i!==t.app_id||tt({event:n,editorUrl:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/heatmap-core.js?query="+Date.now(),autoTrackInstance:e})})}catch(e){}}(this,this.config)},e.prototype.init=function(){this.Listener.init(this.handle.bind(this)),"base"===this.collect.loadType&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")},e.prototype.handle=function(e,t){"dom"===e.eventType&&this.handleDom(e,t)},e.prototype.handleDom=function(e,t){try{var n=e.eventName;if("click"===n||"exposure"===n||"change"===n||"submit"===n){var i=this.EventHandle.handleEvent(t,n);null!==i&&this.Request.send({eventType:"custom",eventName:"report_"+n+"_event",extra:{methods:"GET"}},i)}else if("page_view"===n||"page_statistics"===n){var r=void 0;r="page_view"===n?this.EventHandle.handleViewEvent(t):this.EventHandle.handleStatisticsEvent(t),this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"}},r)}else if("beat"===n){var o=this.EventHandle.handleBeadtEvent(t),a=e.eventSend;this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"},eventSend:a},o)}}catch(e){}},e.prototype.destroy=function(){this.autoTrackStart&&(this.autoTrackStart=!1,this.Listener.removeListener())},e}();(n=ta||(ta={})).Net="net",n.FailNet="f_net",n.FailData="f_data";var tp={pv:["predefine_pageview"],sdk:["_be_active","predefine_page_alive","predefine_page_close","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append"],autotrack:["bav2b_click","bav2b_page","bav2b_beat","bav2b_page_statistics","__bav_click","__bav_page","__bav_beat","__bav_page_statistics"]},tf=function(){function e(){}return e.prototype.apply=function(e,t){var n=this;if(this.ready=t.app_id&&t.enable_tracer&&!t.disable_track_event,this.ready){this.limit={pv:1,sdk:3,autotrack:3,log:3},this.errorCode={f_net:0,f_data:0},this.tracerCache=new Map,this.collect=e,this.appid=t.app_id,this.reportUrl=e.configManager.getUrl("event");var i=this.collect.Types;e.adapters.fetch,this.collect.on(i.Event,function(e){M(e)?e.forEach(function(e){n.addCount("log")}):n.addCount("log")}),this.collect.on(i.SubmitError,function(e){var t=e.type,i=e.eventDate,r=e.errorCode,o=e.response;n.addErrorCount(i,t,r,o)}),this.listener(),this.collect.emit(i.TracerReady)}},e.prototype.addCount=function(e,t,n){void 0===t&&(t="net"),void 0===n&&(n=1);try{this.tracerCache||(this.tracerCache=new Map);var i=void 0;if(this.tracerCache.has(e))(r=this.tracerCache.get(e)).has(t)?(i=r.get(t).params.count,i++,r.set(t,this.processTracer(i,e,t))):(i=n,r.set(t,this.processTracer(n,e,t)));else{var r=new Map;i=n,r.set(t,this.processTracer(n,e,t)),this.tracerCache.set(e,r)}"net"===t&&i>=this.limit[e]&&this.report(!1)}catch(e){}},e.prototype.addErrorCount=function(e,t,n,i){var r=this;try{if(e&&e.length){var o=e[0].events;o&&o.length&&("f_data"===t?(i&&i.hasOwnProperty("sc")?this.addCount("log",t,o.length-i.sc):this.addCount("log",t,o.length),this.errorCode[t]=n):o.forEach(function(e){var i="log";for(var o in tp)if(-1!==tp[o].indexOf(e.event)){i=o;break}r.addCount(i,t,1),r.errorCode[t]=n}))}}catch(e){}},e.prototype.report=function(e){if(this.tracerCache){var t=[];this.tracerCache.forEach(function(e){e.forEach(function(e){t.push(e)})}),t&&t.length&&this.sendTracer(t,e)}},e.prototype.sendTracer=function(e,t){try{var n=this.collect.eventManager.merge(e);this.collect.requestManager.useRequest({url:this.reportUrl,data:n,useBeacon:t}),this.tracerCache=null}catch(e){}},e.prototype.processTracer=function(e,t,n){try{var i={count:e,state:n,key:t,params_for_special:"applog_trace",aid:this.appid,platform:"web",_staging_flag:1,sdk_version:et};"f_net"!==n&&"f_data"!==n||(i.errorCode=this.errorCode[n]);var r=this.collect.processEvent("applog_trace",i);if(r&&r.event)return delete r.is_bav,r}catch(e){}},e.prototype.listener=function(){var e=this;document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&e.leavePage()}),G(function(){e.leavePage()})},e.prototype.leavePage=function(){this.report(!0)},e}(),td=U(function(e,t){var n,i,r,o,a,s,c,u,l,h,p,f,d,g,_,m,v,y,b,E,w;e.exports=(n="millisecond",i="second",r="minute",o="hour",a="week",s="month",c="quarter",u="year",l="date",h="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,f=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,d=function(e,t,n){var i=String(e);return!i||i.length>=t?e:""+Array(t+1-i.length).join(n)+e},(_={})[g="en"]={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},m=function(e){return e instanceof E},v=function(e,t,n){var i;if(!e)return g;if("string"==typeof e)_[e]&&(i=e),t&&(_[e]=t,i=e);else{var r=e.name;_[r]=e,i=r}return!n&&i&&(g=i),i||!n&&g},y=function(e,t){if(m(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new E(n)},(b={s:d,z:function(e){var t=-e.utcOffset(),n=Math.abs(t);return(t<=0?"+":"-")+d(Math.floor(n/60),2,"0")+":"+d(n%60,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var i=12*(n.year()-t.year())+(n.month()-t.month()),r=t.clone().add(i,s),o=n-r<0,a=t.clone().add(i+(o?-1:1),s);return+(-(i+(n-r)/(o?r-a:a-r))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return({M:s,y:u,w:a,d:"day",D:l,h:o,m:r,s:i,ms:n,Q:c})[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}}).l=v,b.i=m,b.w=function(e,t){return y(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})},w=(E=function(){function e(e){this.$L=v(e.locale,null,!0),this.parse(e)}var t=e.prototype;return t.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(b.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var i=t.match(p);if(i){var r=i[2]-1||0,o=(i[7]||"0").substring(0,3);return n?new Date(Date.UTC(i[1],r,i[3]||1,i[4]||0,i[5]||0,i[6]||0,o)):new Date(i[1],r,i[3]||1,i[4]||0,i[5]||0,i[6]||0,o)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},t.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},t.$utils=function(){return b},t.isValid=function(){return this.$d.toString()!==h},t.isSame=function(e,t){var n=y(e);return this.startOf(t)<=n&&n<=this.endOf(t)},t.isAfter=function(e,t){return y(e)<this.startOf(t)},t.isBefore=function(e,t){return this.endOf(t)<y(e)},t.$g=function(e,t,n){return b.u(e)?this[t]:this.set(n,e)},t.unix=function(){return Math.floor(this.valueOf()/1e3)},t.valueOf=function(){return this.$d.getTime()},t.startOf=function(e,t){var n=this,c=!!b.u(t)||t,h=b.p(e),p=function(e,t){var i=b.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return c?i:i.endOf("day")},f=function(e,t){return b.w(n.toDate()[e].apply(n.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},d=this.$W,g=this.$M,_=this.$D,m="set"+(this.$u?"UTC":"");switch(h){case u:return c?p(1,0):p(31,11);case s:return c?p(1,g):p(0,g+1);case a:var v=this.$locale().weekStart||0,y=(d<v?d+7:d)-v;return p(c?_-y:_+(6-y),g);case"day":case l:return f(m+"Hours",0);case o:return f(m+"Minutes",1);case r:return f(m+"Seconds",2);case i:return f(m+"Milliseconds",3);default:return this.clone()}},t.endOf=function(e){return this.startOf(e,!1)},t.$set=function(e,t){var a,c=b.p(e),h="set"+(this.$u?"UTC":""),p=((a={}).day=h+"Date",a[l]=h+"Date",a[s]=h+"Month",a[u]=h+"FullYear",a[o]=h+"Hours",a[r]=h+"Minutes",a[i]=h+"Seconds",a[n]=h+"Milliseconds",a)[c],f="day"===c?this.$D+(t-this.$W):t;if(c===s||c===u){var d=this.clone().set(l,1);d.$d[p](f),d.init(),this.$d=d.set(l,Math.min(this.$D,d.daysInMonth())).$d}else p&&this.$d[p](f);return this.init(),this},t.set=function(e,t){return this.clone().$set(e,t)},t.get=function(e){return this[b.p(e)]()},t.add=function(e,t){var n,c=this;e=Number(e);var l=b.p(t),h=function(t){var n=y(c);return b.w(n.date(n.date()+Math.round(t*e)),c)};if(l===s)return this.set(s,this.$M+e);if(l===u)return this.set(u,this.$y+e);if("day"===l)return h(1);if(l===a)return h(7);var p=((n={})[r]=6e4,n[o]=36e5,n[i]=1e3,n)[l]||1,f=this.$d.getTime()+e*p;return b.w(f,this)},t.subtract=function(e,t){return this.add(-1*e,t)},t.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||h;var i=e||"YYYY-MM-DDTHH:mm:ssZ",r=b.z(this),o=this.$H,a=this.$m,s=this.$M,c=n.weekdays,u=n.months,l=function(e,n,r,o){return e&&(e[n]||e(t,i))||r[n].substr(0,o)},p=function(e){return b.s(o%12||12,e,"0")},d=n.meridiem||function(e,t,n){var i=e<12?"AM":"PM";return n?i.toLowerCase():i},g={YY:String(this.$y).slice(-2),YYYY:this.$y,M:s+1,MM:b.s(s+1,2,"0"),MMM:l(n.monthsShort,s,u,3),MMMM:l(u,s),D:this.$D,DD:b.s(this.$D,2,"0"),d:String(this.$W),dd:l(n.weekdaysMin,this.$W,c,2),ddd:l(n.weekdaysShort,this.$W,c,3),dddd:c[this.$W],H:String(o),HH:b.s(o,2,"0"),h:p(1),hh:p(2),a:d(o,a,!0),A:d(o,a,!1),m:String(a),mm:b.s(a,2,"0"),s:String(this.$s),ss:b.s(this.$s,2,"0"),SSS:b.s(this.$ms,3,"0"),Z:r};return i.replace(f,function(e,t){return t||g[e]||r.replace(":","")})},t.utcOffset=function(){return-(15*Math.round(this.$d.getTimezoneOffset()/15))},t.diff=function(e,t,n){var l,h=b.p(t),p=y(e),f=6e4*(p.utcOffset()-this.utcOffset()),d=this-p,g=b.m(this,p);return g=((l={})[u]=g/12,l[s]=g,l[c]=g/3,l[a]=(d-f)/6048e5,l.day=(d-f)/864e5,l[o]=d/36e5,l[r]=d/6e4,l[i]=d/1e3,l)[h]||d,n?g:b.a(g)},t.daysInMonth=function(){return this.endOf(s).$D},t.$locale=function(){return _[this.$L]},t.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),i=v(e,t,!0);return i&&(n.$L=i),n},t.clone=function(){return b.w(this.$d,this)},t.toDate=function(){return new Date(this.valueOf())},t.toJSON=function(){return this.isValid()?this.toISOString():null},t.toISOString=function(){return this.$d.toISOString()},t.toString=function(){return this.$d.toUTCString()},e}()).prototype,y.prototype=w,[["$ms",n],["$s",i],["$m",r],["$H",o],["$W","day"],["$M",s],["$y",u],["$D",l]].forEach(function(e){w[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),y.extend=function(e,t){return e.$i||(e(t,E,y),e.$i=!0),y},y.locale=v,y.isDayjs=m,y.unix=function(e){return y(1e3*e)},y.en=_[g],y.Ls=_,y.p={},y)}),tg=U(function(e,t){var n,i,r,o,a,s,c,u,l,h,p,f,d;e.exports=(r=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,o=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,a={years:31536e6,months:2592e6,days:864e5,hours:36e5,minutes:6e4,seconds:1e3,milliseconds:1,weeks:6048e5},s=function(e){return e instanceof d},c=function(e,t,n){return new d(e,n,t.$l)},u=function(e){return i.p(e)+"s"},l=function(e){return e<0},h=function(e){return l(e)?Math.ceil(e):Math.floor(e)},p=function(e){return Math.abs(e)},f=function(e,t){return e?l(e)?{negative:!0,format:""+p(e)+t}:{negative:!1,format:""+e+t}:{negative:!1,format:""}},d=function(){function e(e,t,n){var i=this;if(this.$d={},this.$l=n,void 0===e&&(this.$ms=0,this.parseFromMilliseconds()),t)return c(e*a[u(t)],this);if("number"==typeof e)return this.$ms=e,this.parseFromMilliseconds(),this;if("object"==typeof e)return Object.keys(e).forEach(function(t){i.$d[u(t)]=e[t]}),this.calMilliseconds(),this;if("string"==typeof e){var r=e.match(o);if(r){var s=r.slice(2).map(function(e){return Number(e)});return this.$d.years=s[0],this.$d.months=s[1],this.$d.weeks=s[2],this.$d.days=s[3],this.$d.hours=s[4],this.$d.minutes=s[5],this.$d.seconds=s[6],this.calMilliseconds(),this}}return this}var t=e.prototype;return t.calMilliseconds=function(){var e=this;this.$ms=Object.keys(this.$d).reduce(function(t,n){return t+(e.$d[n]||0)*a[n]},0)},t.parseFromMilliseconds=function(){var e=this.$ms;this.$d.years=h(e/31536e6),e%=31536e6,this.$d.months=h(e/2592e6),e%=2592e6,this.$d.days=h(e/864e5),e%=864e5,this.$d.hours=h(e/36e5),e%=36e5,this.$d.minutes=h(e/6e4),e%=6e4,this.$d.seconds=h(e/1e3),e%=1e3,this.$d.milliseconds=e},t.toISOString=function(){var e=f(this.$d.years,"Y"),t=f(this.$d.months,"M"),n=+this.$d.days||0;this.$d.weeks&&(n+=7*this.$d.weeks);var i=f(n,"D"),r=f(this.$d.hours,"H"),o=f(this.$d.minutes,"M"),a=this.$d.seconds||0;this.$d.milliseconds&&(a+=this.$d.milliseconds/1e3);var s=f(a,"S"),c=e.negative||t.negative||i.negative||r.negative||o.negative||s.negative,u=r.format||o.format||s.format?"T":"",l=(c?"-":"")+"P"+e.format+t.format+i.format+u+r.format+o.format+s.format;return"P"===l||"-P"===l?"P0D":l},t.toJSON=function(){return this.toISOString()},t.format=function(e){var t={Y:this.$d.years,YY:i.s(this.$d.years,2,"0"),YYYY:i.s(this.$d.years,4,"0"),M:this.$d.months,MM:i.s(this.$d.months,2,"0"),D:this.$d.days,DD:i.s(this.$d.days,2,"0"),H:this.$d.hours,HH:i.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:i.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:i.s(this.$d.seconds,2,"0"),SSS:i.s(this.$d.milliseconds,3,"0")};return(e||"YYYY-MM-DDTHH:mm:ss").replace(r,function(e,n){return n||String(t[e])})},t.as=function(e){return this.$ms/a[u(e)]},t.get=function(e){var t=this.$ms,n=u(e);return"milliseconds"===n?t%=1e3:t="weeks"===n?h(t/a[n]):this.$d[n],0===t?0:t},t.add=function(e,t,n){var i;return i=t?e*a[u(t)]:s(e)?e.$ms:c(e,this).$ms,c(this.$ms+i*(n?-1:1),this)},t.subtract=function(e,t){return this.add(e,t,!0)},t.locale=function(e){var t=this.clone();return t.$l=e,t},t.clone=function(){return c(this.$ms,this)},t.humanize=function(e){return n().add(this.$ms,"ms").locale(this.$l).fromNow(!e)},t.milliseconds=function(){return this.get("milliseconds")},t.asMilliseconds=function(){return this.as("milliseconds")},t.seconds=function(){return this.get("seconds")},t.asSeconds=function(){return this.as("seconds")},t.minutes=function(){return this.get("minutes")},t.asMinutes=function(){return this.as("minutes")},t.hours=function(){return this.get("hours")},t.asHours=function(){return this.as("hours")},t.days=function(){return this.get("days")},t.asDays=function(){return this.as("days")},t.weeks=function(){return this.get("weeks")},t.asWeeks=function(){return this.as("weeks")},t.months=function(){return this.get("months")},t.asMonths=function(){return this.as("months")},t.years=function(){return this.get("years")},t.asYears=function(){return this.as("years")},e}(),function(e,t,r){n=r,i=r().$utils(),r.duration=function(e,t){return c(e,{$l:r.locale()},t)},r.isDuration=s;var o=t.prototype.add,a=t.prototype.subtract;t.prototype.add=function(e,t){return s(e)&&(e=e.asMilliseconds()),o.bind(this)(e,t)},t.prototype.subtract=function(e,t){return s(e)&&(e=e.asMilliseconds()),a.bind(this)(e,t)}})});td.extend(tg);var t_=["__cep_sdk_onboard","__cep_trigger_sdk","_be_active"],tm=["and","or","not"],tv=function(){function e(){this.support=!0,this.currentPlan=1,this.shouldSendEvent=!1,this.staing=!1,this.test=!1,this.cepReady=!1,this.eventCache=[]}return e.prototype.apply=function(e,t){var n=this;if(this.collect=e,this.config=t,this.config.cep){var i=e.adapters.storage,r=e.Types;this.types=r,this.storage=new i(!1),this.configManager=e.configManager,this.url=t.cep_url?""+t.cep_url:e.configManager.getDomain()+"/service/2/cep_settings/",this.reportUrl=e.configManager.getUrl("event"),this.key="__tea_cep_plan_"+t.app_id,this.quotasKey="__tea_cep_plan_quotas_"+t.app_id,this.isWait=!1,this.eventCache=[],this.test=e.configManager.staging,this.collect.on(r.SubmitAfter,function(e){n.matchEvent(e)}),this.init()}},e.prototype.init=function(){var e=this,t=!0,n=0,i=0,r=0,o=!1,a=this.storage.getItem(this.key)||{};if(a&&Object.keys(a).length&&(o=!0,n=a.last_update_time,i=a.fetch_interval,r=a.config_version||0,t=Date.now()-n>1e3*i),t){var s=this.configManager.get(),c=s.header,u=s.user;this.collect.requestManager.useRequest({url:this.url,data:{header:c,user:u,local_time:Date.now(),config_version:r},success:function(t){t&&0===t.code?(a.fetch_interval=t.fetch_interval,a.data=t.data,a.last_update_time=Date.now(),a.config_version=t.config_version,e.clearQuotas(),e.initState(t.data),e.storage.setItem(e.key,a),t.data.forEach(function(t){e.event("__cep_sdk_onboard",t.plan_id)})):(304===t.code||400===t.code)&&o&&(a.last_update_time=Date.now(),e.storage.setItem(e.key,a),e.initState(a.data))},fail:function(){o?(e.planData=a.data,e.initState(a.data)):e.support=!1},timeout:5e3})}else a.last_update_time=Date.now(),this.storage.setItem(this.key,a),this.initState(a.data)},e.prototype.initState=function(e){var t=this;e&&e.length&&(this.stateArray=new Map,this.waitArray=new Map,this.planData=e,e.forEach(function(e){var n=new Map;if(e.pattern&&e.pattern.events){var i=1===e.pattern.events.length;e.pattern.events.forEach(function(e){n.set(e.id,{id:e.id,isMatch:!1,event:null,after:e.after||null,connection:e.connection||null,window:e.window||null,matchTime:0,initTime:Date.now(),singleRule:i})}),t.stateArray.set(e.plan_id,{patternState:n,singleRule:i,pattern:{aid:e.aid,biz_id:e.biz_id,end_time:e.end_time,start_time:e.start_time,web_sdk_version:e.web_sdk_version,stage:e.stage},quotas:e.quotas})}}),this.cepReady=!0,this.dealCache(),this.collect.emit(this.types.CepReady))},e.prototype.check=function(e){var t=Date.now();return!(Date.now()>1e3*e.end_time)&&!(t<1e3*e.start_time)&&!(t>1e3*e.end_time)&&(this.staing="testing"===e.staing,!(et<e.web_sdk_version)||(this.support=!1,!1))},e.prototype.dealCache=function(){var e=this;if(this.eventCache.length){var t=1;this.eventCache.forEach(function(n){e.matchEvent(n),t++}),t===this.eventCache.length&&(this.eventCache=[])}},e.prototype.matchEvent=function(e){if(this.support&&(!this.staing||this.test)&&e&&e.length)try{if(!this.cepReady)return void this.eventCache.push(e);var t=e[0],n=t.header,i=t.user,r=t.events;r.length&&r.reverse();for(var o=0;o<r.length;o++){var a=r[o].event;if(-1!==t_.indexOf(a))return!1;this.matchRule(n,i,r[o])}}catch(e){return void this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}},e.prototype.matchRule=function(e,t,n){try{for(var i=0;i<this.planData.length;i++){var r=this.planData[i],o=r.plan_id;if(this.check(r)&&this.checkQuotas(o)&&r.pattern&&r.pattern.events){for(var a=r.pattern.events,s=0;s<a.length;s++)if(this.rule(e,t,n,a[s].condition)){var c=this.stateArray.get(o).patternState,u=c.get(a[s].id);if(this.stateArray.get(o).singleRule){this.changeStatus(o,a[s].id,n),this.publish([n],o,a[s].id);break}if(!u.isMatch){u.after&&c.get(u.after).isMatch?this.changeStatus(o,a[s].id,n):u.after||this.changeStatus(o,a[s].id,n);break}}}}this.statusCheck()}catch(e){return void this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}},e.prototype.changeStatus=function(e,t,n){var i=this.stateArray.get(e),r=i.patternState.get(t);r.isMatch=!0,r.event=n,r.matchTime=n.local_time_ms||Date.now(),i.patternState.set(t,r),this.stateArray.set(e,i)},e.prototype.statusCheck=function(){var e,t,n,i;try{for(var r=S(this.stateArray),o=r.next();!o.done;o=r.next()){var a=k(o.value,2),s=a[0],c=a[1],u=c.patternState;if(c.isSingle)break;try{for(var l=S(u),h=l.next();!h.done;h=l.next()){var p=k(h.value,2),f=p[0],d=p[1];if(d.after&&(!d.after||u.get(d.after).isMatch)){if("NOT_FOLLOWED_BY"===d.connection){d.isMatch?this.reset(s,f):Date.now()-u.get(d.after).matchTime>d.window?this.publish([u.get(d.after).event,d.event],s,f):this.startWait(s,f,d);break}d.isMatch?d.matchTime-u.get(d.after).matchTime<=d.window?this.publish([u.get(d.after).event,d.event],s,f):this.reset(s,f):Date.now()-u.get(d.after).matchTime>d.window?this.reset(s,f):this.startWait(s,f,d);break}}}catch(e){n={error:e}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.startWait=function(e,t,n){var i=this;try{this.waitArray.get(e)||this.waitArray.set(e,new Map);var r=this.waitArray.get(e);if(!r.get(t)){var o=setTimeout(function(){var r,o=i.stateArray.get(e).patternState,a=o.get(t);"NOT_FOLLOWED_BY"===a.connection?!a.isMatch&&o.get(a.after).isMatch||a.matchTime-o.get(a.after).matchTime>n.window?((r=i.waitArray.get(e).get(t)).triggerWait=!0,i.waitArray.set(e,i.waitArray.get(e).set(t,r)),i.publish([o.get(a.after).event],e,t)):i.reset(e,t):"FOLLOWED_BY"===a.connection&&(a.isMatch&&o.get(a.after).isMatch?((r=i.waitArray.get(e).get(t)).triggerWait=!0,i.waitArray.set(e,i.waitArray.get(e).set(t,r)),i.publish([o.get(a.after).event],e,t)):i.reset(e,t))},n.window);r.set(t,{waitFn:o,triggerWait:!1}),this.waitArray.set(e,r)}}catch(e){this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}},e.prototype.rule=function(e,t,n,i){var r=this;try{var o=n.event,a=n.params;if(a=JSON.parse(a),-1!==tm.indexOf(i.op)){if(i.conditions&&i.conditions.length){var s=i.conditions,c=0,u=new Map;u.set(c,{op:i.op,result:void 0,resultList:[],resultKey:[],resultLength:s.length}),function n(i,s){for(var l=0;l<i.length;l++)if(c++,-1!==tm.indexOf(i[l].op)&&i[l].hasOwnProperty("conditions"))u.set(c,{op:i[l].op,result:void 0,fatherKey:s,resultList:[],resultKey:[],resultLength:i[l].conditions.length}),n(i[l].conditions,c);else{var h=r.scope(i[l].key),p=h.scope,f=h.key,d=h.key2,g=p?"header"===p?d?JSON.parse(e[d])[f]:e[f]:"user"===p?t[f]:a[f]:o,_=r.calculate(i[l].op,g,i[l].value);u.set(c,{op:i[l].op,result:_,fatherKey:s})}}(s,c);for(var l=u.get(0);void 0===l.result||l.resultList.length<l.resultLength;)u.forEach(function(e,t){if(void 0!==e.result&&void 0!==e.fatherKey){var n=u.get(e.fatherKey);n.resultList.length<n.resultLength&&-1===n.resultKey.indexOf(t)&&(n.resultKey.push(t),n.resultList.push(e.result),u.set(e.fatherKey,n))}}),u.forEach(function(e){e.resultList&&e.resultList.length===e.resultLength&&("and"===e.op&&(e.result=-1===e.resultList.indexOf(!1)),"or"===e.op&&(e.result=-1!==e.resultList.indexOf(!0)))});return u.get(0).result}return!1}var h=this.scope(i.key),p=h.scope,f=h.key,d=h.key2,g=p?"header"===p?d?JSON.parse(e[d])[f]:e[f]:"user"===p?t[f]:a[f]:o;return this.calculate(i.op,g,i.value)}catch(e){return this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message}),!1}},e.prototype.publish=function(e,t,n){try{var i=this.configManager.get().user,r={biz_id:this.stateArray.get(t).pattern.biz_id,plan_id:t,uid:i.user_id||"",did:i.device_id||"",uuid:i.user_unique_id,events:e,extra:{url:window.location.href}};this.collect.emit("__cep_match",r),(window.opener||window.parent).postMessage({type:"__cep_match",data:r},"*"),this.event("__cep_trigger_sdk",t),this.addQuotas(t),this.reset(t,n)}catch(e){return void this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}},e.prototype.addQuotas=function(e){var t=this.stateArray.get(e).quotas;if(t&&t.length){var n=this.storage.getItem(this.quotasKey)||{};n[e]||(n[e]={value:0,lastTime:Date.now()});var i=n[e].value;0===i&&(n[e].lastTime=Date.now()),n[e].value=i+1,this.storage.setItem(this.quotasKey,n)}},e.prototype.checkQuotas=function(e){var t=this.stateArray.get(e).quotas,n=this.storage.getItem(this.quotasKey)||{};if(n[e]||(n[e]={value:0,lastTime:Date.now()}),t&&t.length){var i=t[0].granularity,r=t[0].value;if("per_keyid"!==t[0].type)return!0;var o=this.release(i);return"all"===o?!(n[e].value>=r):Date.now()-n[e].lastTime>=o?(n[e].value=0,n[e].lastTime=Date.now(),this.storage.setItem(this.quotasKey,n),!0):!(n[e].value>=r)}return!0},e.prototype.clearQuotas=function(){this.storage.setItem(this.quotasKey,null)},e.prototype.release=function(e){if("all"===e)return e;var t=td.duration(e);return t?t.asMilliseconds():"all"},e.prototype.reset=function(e,t){var n=this.stateArray.get(e);if(n.singleRule){var i=n.patternState.get(t);i.isMatch=!1,i.event=null,i.matchTime=0,i.initTime=Date.now(),n.patternState.set(t,i)}else n.patternState.forEach(function(e){e.isMatch=!1,e.event=null,e.matchTime=0,e.initTime=Date.now()});this.stateArray.set(e,n);var r=this.waitArray.get(e);r&&r.get(t)&&(clearTimeout(r.get(t).waitFn),r.delete(t))},e.prototype.event=function(e,t){try{var n={event:e,params:JSON.stringify({plan_id:t||"",biz_id:this.stateArray.get(t).pattern.biz_id}),local_time_ms:Date.now()},i=this.configManager.get(),r=i.header,o=i.user;r.custom=JSON.stringify(r.custom),this.collect.requestManager.useRequest({url:this.reportUrl,data:[{events:[n],user:o,header:r}]})}catch(e){return void this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}},e.prototype.scope=function(e){var t="",n="";if(e.indexOf(".")>-1){var i=e.split(".");t=i[0],e=i[1],"header"===t&&"custom"===e&&(e=i[2],n=i[1])}return{scope:t,key:e,key2:n}},e.prototype.calculate=function(e,t,n){try{if("="===e)return t===n;if(-1!==["=","<",">",">=","<=","!="].indexOf(e))switch(e){case"=":return t===n;case"<":return t<n;case">":return t>n;case">=":return t>=n;case"<=":return t<=n;case"!=":return t!==n}else{if(-1!==["in","contains"].indexOf(e))return -1!==n.indexOf(t);if(-1!==["is not null","is null"].indexOf(e))return"is null"===e?null==t:null!=t;if(-1!==["startswith","endswith"].indexOf(e)){if("startswith"===e)return 0===t.indexOf(n);var i=t.length-n.length;return t.substr(i,n.length)===n}}}catch(e){return this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message}),!1}},e}(),ty="undefined"!=typeof window?(window.LogPluginObject||(window.LogPluginObject={}),window.LogPluginObject):null,tb=function(){function e(){}return e.prototype.apply=function(e,t){this._plugin={},this.config=t,this.collect=e,this.channel=t.channel||"cn",this.loadExtend()},e.prototype.loadExtend=function(){var e=this;try{this.collect.remotePlugin.forEach(function(t,n){if("sdk"===t){if(ew.hasOwnProperty(n)){var i=ew[n].object,r=""+ew[n].src[e.channel];e.exist(n,i,r)}}else"object"==typeof t&&(t.src?e.exist(n,t.call,t.src):e.process(n,t.instance,"INSTANCE"))})}catch(e){this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}},e.prototype.exist=function(e,t,n){var i=this;ty[t]?this.process(e,ty[t]):this.loadPlugin(e,n,function(){i.process(e,ty[t])},function(){})},e.prototype.process=function(e,t,n){try{if(n){var i=new t;i.apply&&i.apply(this.collect,this.config)}else t&&t(this.collect,this.config)}catch(e){this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}},e.prototype.loadPlugin=function(e,t,n,i){var r=this;try{var o=document.createElement("script");o.src=t,this._plugin[e]||(this._plugin[e]=[]),this._plugin[e].push(n),o.onerror=function(){i(t)},o.onload=function(){r._plugin[e].forEach(function(e){e()})},document.getElementsByTagName("head")[0].appendChild(o)}catch(e){this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message})}},e}(),tE=function(){function e(){this.autotrack=!1,this.spa=!1,this.cache={},this.allowHash=!1}return e.prototype.apply=function(e,t){if(t.spa||t.autotrack){var n=e.Types;this.collect=e,this.config=t,this.appid=t.app_id,this.allowHash=t.allow_hash,this.fncArray=new Map,this.setKey(),this.setLocation(),this.hack(),this.init(),this.listener(),e.emit(n.RouteReady)}},e.prototype.setKey=function(){var e=this.collect.adapters.storage;this.storage=new e(!1),this.cache_key="__tea_cache_refer_"+this.appid,this.cache={refer_key:"",refer_title:document.title||location.pathname,refer_manual_key:"",routeChange:!1},this.config.autotrack&&"object"==typeof this.config.autotrack&&this.config.autotrack.page_manual_key&&(this.cache.refer_manual_key=this.config.autotrack.page_manual_key),this.storage.setItem(this.cache_key,this.cache)},e.prototype.hack=function(){var e=this,t=window.history.pushState;history.pushState=function(n){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];"function"==typeof history.onpushstate&&history.onpushstate({state:n});var o=t.call.apply(t,A([history,n],i));if(e.lastLocation!==location.href){var a=e.getPopStateChangeEventData();return e.setReferCache(e.lastLocation),e.lastLocation=location.href,e.sendPv(a,"pushState"),o}};var n=history.replaceState;history.replaceState=function(t){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];"function"==typeof history.onreplacestate&&history.onreplacestate({state:t});var o=n.call.apply(n,A([history,t],i));if(e.lastLocation!==location.href){var a=e.getPopStateChangeEventData();return e.setReferCache(e.lastLocation),e.lastLocation=location.href,e.sendPv(a),o}}},e.prototype.setLocation=function(){"undefined"!=typeof window&&(this.lastLocation=window.location.href)},e.prototype.getLocation=function(){return this.lastLocation},e.prototype.init=function(){var e=this.getPopStateChangeEventData();this.collect.emit("route-change",{config:e,init:!0})},e.prototype.listener=function(){var e=this,t=null;window.addEventListener("hashchange",function(n){if(e.lastLocation!==window.location.href&&(clearTimeout(t),e.allowHash)){e.setReferCache(e.lastLocation),e.lastLocation=window.location.href;var i=e.getPopStateChangeEventData();e.sendPv(i)}}),window.addEventListener("popstate",function(n){e.lastLocation!==window.location.href&&(t=setTimeout(function(){e.setReferCache(e.lastLocation),e.lastLocation=window.location.href;var t=e.getPopStateChangeEventData();e.sendPv(t)},10))})},e.prototype.getPopStateChangeEventData=function(){var e=this.pageConfig();return e.is_back=0,e},e.prototype.pageConfig=function(){try{var e=this.storage.getItem(this.cache_key)||{},t=!1,n=this.storage.getItem("__tea_cache_first_"+this.appid);return t=!n||1!=n,{is_html:1,url:location.href,referrer:this.handleRefer(),page_key:location.href,refer_page_key:this.handleRefer(),page_title:document.title||location.pathname,page_manual_key:this.config.autotrack&&this.config.autotrack.page_manual_key||"",refer_page_manual_key:e&&e.refer_manual_key||"",refer_page_title:e&&e.refer_title||"",page_path:location.pathname,page_host:location.host,is_first_time:""+t}}catch(e){return this.collect.emit(V.DEBUGGER_MESSAGE,{type:V.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message}),{}}},e.prototype.sendPv=function(e,t){this.collect.emit("route-change",{config:e,init:!1})},e.prototype.handleRefer=function(){var e="";try{var t=this.storage.getItem()||{};e=t.routeChange?t.refer_key:this.collect.configManager.get("referrer")}catch(t){e=document.referrer}return e},e.prototype.setReferCache=function(e){var t=this.storage.getItem(this.cache_key)||{};t.refer_key=e,t.routeChange=!0,this.storage.setItem(this.cache_key,t)},e}();ek.usePlugin(tb,"extend"),ek.usePlugin(tf,"tracer"),ek.usePlugin(ez,"ab"),ek.usePlugin(eU,"stay"),ek.usePlugin(th,"autotrack"),ek.usePlugin(eP,"et"),ek.usePlugin(ej,"profile"),ek.usePlugin(tv,"cep"),ek.usePlugin(eV,"heartbeat"),ek.usePlugin(eK,"monitor"),ek.usePlugin(tE,"route"),ek.usePlugin(tf,"tracer");var tw=new ek("default"),tS={CN:3053,OVERSEA:3297},tk=function(e){function t(t){var n,i,r,o,a,s,c=this,u=t.test,l=t.TEAChannelDomain,h=void 0===l?"":l,p=t.mode,f=t.TEAChannel,d=t.TEAChannelType;return t.tracker=h||d||f?(i=(n={isTest:u||"test"===p,channel_domain:h,channel_type:d,channel:f}).isTest,r=n.channel_domain,o=n.channel_type,a=n.channel,s=/snssdk|zijieapi/g.test(r)&&/ttp|tcpy/g.test(o)&&/va|sg|in/g.test(a)?tS.CN:tS.OVERSEA,tw.init({app_id:s,channel_type:o,channel:a,channel_domain:r}),tw.config({_staging_flag:+!!i,enable_et_test:i}),tw.start(),tw.event.bind(tw)):function(){},e.call(this,t)||this}return r(t,e),t}(E);t.default=tk},924218:function(e,t,n){n.d(t,{Intl:function(){return U}});var i,r,o,a,s=n(281821),c=n(553688),u=function(){return(u=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function l(e,t,n){function i(e){return e&&e.indexOf("###")>-1?e.replace(/###/g,"."):e}function r(){return!e||"string"==typeof e}void 0===n&&(n=null);for(var o="string"!=typeof t?[].concat(t):t.split(".");o.length>1;){if(r())return{};var a=i(o.shift());!e[a]&&n&&(e[a]=new n),e=e[a]}return r()?{}:{obj:e,k:i(o.shift())}}(i=o||(o={})).keepRaw="keepRaw",i.replaceAnyway="replaceAnyway",o.replaceAnyway;var h={memorize:!1,memoizeFallback:!1,bindI18n:!1,bindI18nStore:!1,onParseError:o.replaceAnyway},p=function(){function e(){this.mem={}}return e.staticInit=function(t){e._i18nextInstance=t},e.prototype.init=function(t,n){var i=this;void 0===t&&(t=e._i18nextInstance);var r={};if((null==t?void 0:t.options)&&(t.options.i18nFormat&&(r=t.options.i18nFormat),r.onParseError=t.options.onParseError,r.missingInterpolationHandler=t.options.missingInterpolationHandler,r.icuConfig=t.options.icuConfig,r.ignoreWarning=!!t.options.ignoreWarning),this.options=Object.assign(h,n,r),this.formats=this.options.formats,t){var o=this.options,a=o.bindI18n,s=o.bindI18nStore,u=o.memorize;t.IntlMessageFormat=c.default,this.IntlMessageFormat=c.default,t.ICU=this,u&&(a&&t.on(a,function(){return i.clearCache()}),s&&t.store.on(s,function(){return i.clearCache()}))}this.options.localeData&&("[object Array]"===Object.prototype.toString.apply(this.options.localeData)?this.options.localeData.forEach(function(e){return i.addLocaleData(e)}):this.addLocaleData(this.options.localeData))},e.prototype.addLocaleData=function(e){("[object Array]"===Object.prototype.toString.apply(e)?e:[e]).forEach(function(e){e&&e.locale&&c.default.__addLocaleData(e)})},e.prototype.addUserDefinedFormats=function(e){this.formats=this.formats?u(u({},this.formats),e):e},e.prototype.checkMissingInterpolation=function(e,t,n,i,r){if(!1===(this.options.icuConfig||{}).strict)return n;for(var a={},s=0;s<e.length;s++){var c=e[s];if(1===c.type){var u=c.value;if(null===n[u]||void 0===n[u]){if("function"==typeof this.options.missingInterpolationHandler){var l=this.options.missingInterpolationHandler({key:r,text:t,locale:i,interpolation:{key:u,val:n[u]}});if("string"==typeof l){a[u]=l;continue}}switch(this.options.onParseError){case o.keepRaw:throw Error();case o.replaceAnyway:a[u]="{"+u+"}";continue}if("function"==typeof this.options.onParseError){var h=this.options.onParseError(t,u,i,this.IntlMessageFormat);if(!0===h)throw Error();a[u]="string"==typeof h?h:"{"+u+"}"}else this.options.ignoreWarning,a[u]="{"+u+"}"}}}return Object.assign({},n,a)},e.prototype.parse=function(e,t,n,i,r,o){var a,s,c,u,h=o&&o.resolved&&o.resolved.res,p=this.options.memorize&&n+"."+i+"."+r.replace(/\./g,"###");!h&&t.thirdParamFallback&&t.fallbackText&&(e=t.fallbackText),this.options.memorize&&(u=function(e,t){var n=l(e,t),i=n.obj,r=n.k;if(i)return i[r]}(this.mem,p));try{return!u&&(u=new this.IntlMessageFormat(e,n,this.formats,(this.options.icuConfig||{}).formatOptions),this.options.memorize&&(this.options.memoizeFallback||!o||h))&&(a=this.mem,s=u,(c=l(a,p,Object)).obj[c.k]=s),u.format(this.checkMissingInterpolation(u.getAst(),e,t||{},n,r))}catch(t){return e}},e.prototype.addLookupKeys=function(e,t,n,i,r){return e},e.prototype.clearCache=function(){this.mem={}},e.type="i18nFormat",e._i18nextInstance=null,e}();p.name;var f=n(76345),d=function(){return(d=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},g=/^\s*\[\[__starling_(\d+)_(.*)__\]\]\s*$/;function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function m(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function v(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,E(i.key),i)}}function y(e,t,n){return t&&v(e.prototype,t),n&&v(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function b(e){return function(e){if(Array.isArray(e))return _(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||w(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function w(e,t){if(e){if("string"==typeof e)return _(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}"undefined"!=typeof window&&(window.__STARLING_INCONTEXT_GLOBAL__HOOK__=d({},window.__STARLING_INCONTEXT_GLOBAL__HOOK__||{payload:{}}));for(var S=["AFN","EUR","ALL","DZD","USD","AOA","XCD","ARS","AMD","AWG","AUD","AZN","BSD","BHD","BDT","BBD","BYN","BZD","XOF","BMD","INR","BTN","BOB","BOV","BAM","BWP","NOK","BRL","BND","BGN","BIF","CVE","KHR","XAF","CAD","KYD","CLP","CLF","CNY","COP","COU","KMF","CDF","NZD","CRC","HRK","CUP","CUC","ANG","CZK","DKK","DJF","DOP","EGP","SVC","ERN","ETB","FKP","FJD","XPF","GMD","GEL","GHS","GIP","GTQ","GBP","GNF","GYD","HTG","HNL","HKD","HUF","ISK","IDR","XDR","IRR","IQD","ILS","JMD","JPY","JOD","KZT","KES","KPW","KRW","KWD","KGS","LAK","LBP","LSL","ZAR","LRD","LYD","CHF","MOP","MKD","MGA","MWK","MYR","MVR","MRO","MUR","XUA","MXN","MXV","MDL","MNT","MAD","MZN","MMK","NAD","NPR","NIO","NGN","OMR","PKR","PAB","PGK","PYG","PEN","PHP","PLN","QAR","RON","RUB","RWF","SHP","WST","STD","SAR","RSD","SCR","SLL","SGD","XSU","SBD","SOS","SSP","LKR","SDG","SRD","SZL","SEK","CHE","CHW","SYP","TWD","TJS","TZS","THB","TOP","TTD","TND","TRY","TMT","UGX","UAH","AED","USN","UYU","UYI","UZS","VUV","VEF","VND","YER","ZMW","ZWL","XBA","XBB","XBC","XBD","XTS","XXX","XAU","XPD","XPT","XAG"],k={},A=0;A<S.length;A++)k[S[A]]={style:"currency",currency:S[A]};var D={number:k},T="languageTransformer";function R(e){return function(t){return t.type===e}}function O(e,t){var n=e;return(t||[]).map(function(t){n=t.process(e)||n}),n}var M={lng:"zh-CN",fallbackLng:["en-US"],inContext:!0},C={icu:p,inContext:{name:"inContext",type:"postProcessor",process:function(e,t,n,i){if(!(window&&document.getElementById("INCONTEXT-KEY-MATCH"))||n.__STARLING_INCONTEXT_FLAG__)return e;window.__STARLING_INCONTEXT_GLOBAL_I18N__||(window.__STARLING_INCONTEXT_GLOBAL_I18N__=i),delete n.keySeparator,delete n.lngs;var r=0;if(t=t.toString(),g.test(t)){var o=t.match(g);o[0];var a=o[1],s=o[2];r=a,t=s}if(g.test(e)){var o=e.match(g);o[0];var a=o[1],s=o[2];e=s}return window.__STARLING_INCONTEXT_GLOBAL__HOOK__.payload[t]?r=window.__STARLING_INCONTEXT_GLOBAL__HOOK__.payload[t].push({options:n,default:e})-1:(window.__STARLING_INCONTEXT_GLOBAL__HOOK__.payload[t]=[{options:n,default:e}],r=0),"[[__starling_"+r+"_"+t+"__]]"}},renderReport:f.registerKeyRenderReportPlugin},I=[C.icu,C.inContext,C.renderReport],G=function(){function e(t,n){var i,r;if(m(this,e),r=[],(i=E(i="_waitingToAddResourceBundle"))in this?Object.defineProperty(this,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[i]=r,null!=t&&t.copiedI18nextInstance){this.instance=t.copiedI18nextInstance;return}this._handlePlugins(n),this._handleConfigs(t),this.instance=s.default.createInstance(),this.instance.isInitialized=!1,this.KRRList=f.KRRList}return y(e,[{key:"_handlePlugins",value:function(e){var t,n;if((null===(t=this.config)||void 0===t?void 0:null===(n=t.icuConfig)||void 0===n?void 0:n.open)===!1){var i=I.findIndex(function(e){return"IES_INTL_ICU_PLUGIN"===e.name});i>-1&&I.splice(i,1)}this.plugins=Array.isArray(e)?e.concat(I):I}},{key:"_handleConfigs",value:function(e){this.userLng=(null==e?void 0:e.lng)||null,this.config=Object.assign({},M,e||{})}},{key:"language",get:function(){return(this.instance||{}).language}},{key:"createInstance",value:function(){var e=this;return new Promise(function(t,n){"undefined"!=typeof window&&!window.CocosEngine&&e.config.inContext&&(e.config.postProcess=[].concat(["inContext","keyRender"],e.config.postProcess||[]),window.__STARLING_DEVTOOLS_I18N=e.instance),e.plugins.map(function(t){"IES_INTL_ICU_PLUGIN"===t.name&&t.staticInit(e.instance),t===C.renderReport?e.instance.use(t(e.config.keyRenderReportConfig)):e.instance.use(t)});var i=e.config;e.config.formats=Object.assign({},e.config.formats,D);var r=O(i.lng,e.plugins.filter(R(T)));e.instance.init(Object.assign({},i,{lng:r,i18nFormat:Object.assign({},i.i18nFormat||{},{formats:e.config.formats})}),function(i,r){try{var o,a=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=w(e))){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(e._waitingToAddResourceBundle);try{for(a.s();!(o=a.n()).done;){var s,c=o.value;(s=e.instance).addResourceBundle.apply(s,b(c))}}catch(e){a.e(e)}finally{a.f()}e._waitingToAddResourceBundle=[]}catch(e){}i||(e._updateLanguages(),t({t:r,err:i})),e.init=!0,n({t:r,err:i})})})}},{key:"_updateLanguages",value:function(){this.languages=this.instance?Array.from(new Set([this.instance.language].concat(b(this.instance.languages)))):null}},{key:"getLanguages",value:function(){return this.languages}},{key:"changeLanguage",value:function(e,t){var n=this;this.config.lng=e,this.instance.changeLanguage(e,function(e,i){e||n._updateLanguages(),t&&t(e,i)})}},{key:"changeLanguageWithPromise",value:function(e){var t=this;return new Promise(function(n,i){t.config.lng=e,t.instance.changeLanguage(e,function(e,r){e&&i({err:e,t:r}),t._updateLanguages(),n({err:e,t:r})})})}},{key:"getDir",value:function(e){return this.instance.dir(e)}},{key:"t",value:function(e,t,n){var i=Array.isArray(e)?Array.from(e).map(function(){return" "}).join(""):Array(e.length).fill(" "),r=Object.assign({keySeparator:i,nsSeparator:i},t);return"thirdParamFallback"in this.config&&this.config.thirdParamFallback&&(r.thirdParamFallback=!0),this.instance.t(e,n,r)}},{key:"addResourceBundle",value:function(e,t,n,i,r){return this.instance.isInitialized?this.instance.addResourceBundle(e,t,n,i,r):(this._waitingToAddResourceBundle.push([e,t,n,!!i,!!r]),this.instance)}},{key:"cloneInstance",value:function(t,n){var i=this.instance.cloneInstance(t,n),r=new e({copiedI18nextInstance:i});return r.t=this.t.bind(r),r.config=this.config,r.plugins=this.plugins,r.languages=this.languages,r.init=i.isInitialized||!!this.init,r.userLng=this.userLng,i.on("initialized",function(){r.init=!0}),r}}])}(),x="Starling_intl:",N={warn:function(){for(var e,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];(e=console).warn.apply(e,["".concat(x," [WARNING]")].concat(n))},error:function(){for(var e,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];(e=console).error.apply(e,["".concat(x," [ERROR]")].concat(n))}};function z(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function P(){}function B(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}(r=a||(a={})).intl3rdParty="intl3rdParty",r.backend="backend",r.logger="logger",r.languageDetector="languageDetector",r.postProcessor="postProcessor",r.i18nFormat="i18nFormat",r["3rdParty"]="3rdParty";var L=null,U=function(){function e(t){var n;m(this,e),this.plugins=[],this.i18nInstance=null!==(n=null==t?void 0:t.i18nInstance)&&void 0!==n?n:new G}return y(e,[{key:"use",value:function(e){return this.plugins.includes(e)?N.warn("Plugin: ".concat(e.name," has beeninit installed.")):this.plugins.push(e),this}},{key:"init",value:function(e,t){try{var n=this;return n.ignoreWarning=e.ignoreWarning,n.i18nInstance._handleConfigs(e),n.i18nInstance._handlePlugins(n.plugins),z(function(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}(function(){return z(n.i18nInstance.createInstance(),function(e){var i,r=e.err,o=e.t,s=n.plugins.filter(function(e){return e.type===a.intl3rdParty});return z((i=s.map(B(function(e){if(e&&"function"==typeof e.init){var t,i;return(t=(e.init instanceof Promise?e.init:B(function(t){return Promise.resolve(e.init(t))}))(n))&&t.then?t.then(P):Promise.resolve()}})),new Promise(function(e,t){if(Array.isArray(i)||(i=Array.from(i)),i.length<=0)return e([]);var n=[];(i=i.map(function(r,o){return function(){("function"==typeof r?new Promise(r):Promise.resolve(r)).then(function(t){n[o]=t,o===i.length-1?e(n):i[o+1]()},t)}}))[0]()})),function(){return"function"==typeof t&&t(r,o),{err:r,t:o}})})},function(e){return N.error("The instance init error: ".concat(e)),{err:e,t:function(e){return e}}}))}catch(e){return Promise.reject(e)}}},{key:"language",get:function(){return(this.i18nInstance||{}).language}},{key:"setLang",value:function(e,t){var n=O(e,this.plugins.filter(R(T)));this.i18nInstance.changeLanguage(n,t)}},{key:"getLanguages",value:function(){return this.i18nInstance.getLanguages()}},{key:"setLangWithPromise",value:function(e){var t=O(e,this.plugins.filter(R(T)));return this.i18nInstance.changeLanguageWithPromise(t)}},{key:"dir",value:function(e){return this.i18nInstance.getDir(e)}},{key:"t",value:function(e,t,n){var i=null;if(!(i=void 0===this?L:this).ignoreWarning&&(!i.i18nInstance||!i.i18nInstance.init)){try{var r="The instance has not been initialized: i18n.t('".concat(e,"'").concat(t?","+JSON.stringify(t):"",");");N.error(r)}catch(e){}return null!=n?n:Array.isArray(e)?e[0]:e}return e&&("string"!=typeof e||e.trim())?i.i18nInstance.t(e,t,n):""}},{key:"addResourceBundle",value:function(e,t,n,i,r){return this.i18nInstance.addResourceBundle(e,t,n,i,r)}},{key:"cloneInstance",value:function(t){var n=new e({i18nInstance:this.i18nInstance.cloneInstance(t)});return n.t=this.t.bind(n),n.plugins=this.plugins,n.ignoreWarning=this.ignoreWarning,n}}])}(),j=L=new U;j.t=j.t.bind(j)}}]);