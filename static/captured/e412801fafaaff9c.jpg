"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["92322"],{366959:function(e,t,n){var a,i;n.d(t,{ContentType:function(){return s},Protocol:function(){return o}});let s=((a={})[a.Unknown=0]="Unknown",a[a.Podcast=1]="Podcast",a[a.Story=2]="Story",a[a.DeepResearch=3]="DeepResearch",a[a.File=4]="File",a[a.Message=5]="Message",a[a.Link=6]="Link",a[a.UserPrompt=7]="UserPrompt",a),o=((i={})[i.Unknown=0]="Unknown",i[i.Stream=1]="Stream",i[i.Normal=2]="Normal",i)},904629:function(e,t,n){n.d(t,{getAIPodcastReplyTextContent:function(){return p},isAIPodcastMessage:function(){return r},isAIPodcastMessageGenerated:function(){return g}});var a=n(226982),i=n(778816),s=n(458524),o=n(366959),l=n(292335);let r=e=>{var t,n;return(null==e?void 0:e.content_type)===a.ContentType.SamanthaAiPodcastOutput||(null==e?void 0:e.content_type)===s.ContentType.Widget&&(null===(t=e.content_obj)||void 0===t?void 0:t.applet_id)===i.FpaBizAppletId.Podcast&&(null===(n=e.content_obj)||void 0===n?void 0:n.widget_id)===i.FPAPodcastWidgetId.AIPodcast},d=e=>{if(!r(e))return;let t=null==e?void 0:e.content_obj,n=l.SafeJson.parse(null==t?void 0:t.widget_data);return l.SafeJson.parse(null==n?void 0:n.data)},u=e=>{var t,n,a;let i=null==e?void 0:null===(n=e.episodeList)||void 0===n?void 0:null===(t=n.episodes)||void 0===t?void 0:t[0];return(null==i?void 0:null===(a=i.meta)||void 0===a?void 0:a.protocol)===o.Protocol.Normal},g=e=>u(d(e)),p=e=>{let t=d(e);return u(t)?null==t?void 0:t.waiting_reply:void 0}},752673:function(e,t,n){n.d(t,{useThreadShareStore:function(){return I}});var a=n(952259),i=n(321647),s=n(817635),o=n(436041),l=n(253099),r=n(14390),d=n(156032),u=n(226982),g=n(629006),p=n(904629),c=n(698392),h=n(831566),v=n(645298),y=n(458524),S=n(710733),m=n(178230),L=n(630768),T=n(637319);let f=[y.ContentType.Text,y.ContentType.Music,y.ContentType.Video,y.ContentType.Image,y.ContentType.File,y.ContentType.PluginSearchResult,y.ContentType.Composite,y.ContentType.Nested,y.ContentType.CopilotCard,y.ContentType.LyricsToSongMusic,y.ContentType.LyricsToSongLyric,y.ContentType.LyricsToSongsMusic,y.ContentType.PagesCard,y.ContentType.Outline,u.ContentType.SamanthaText,u.ContentType.SamanthaMusic,u.ContentType.SamanthaImageOutput,u.ContentType.SamanthaSearchCard,u.ContentType.SamanthaMusicGenOutput,u.ContentType.SamanthaSearchText,u.ContentType.SamanthaCodeAssistantInput,u.ContentType.SamanthaCodeAssistantOutput,u.ContentType.SamanthaVideoGenerationInput,u.ContentType.SamanthaVideoGenerationOutput,u.ContentType.SamanthaWriteArtifactOutput,u.ContentType.SamanthaWriteOutlineOutput,u.ContentType.SamanthaWritePagesCardOutput,u.ContentType.SamanthaBlockSuperTask,u.ContentType.SamanthaWritingGenerateInput],I=(0,i.create)()((0,a.subscribeWithSelector)((e,t)=>({scene:void 0,isSelectMode:!1,messageIndexList:[],contentTypeWhiteListInitialized:!1,contentTypeWhiteList:f,preShareId:"",shareToken:"",preMessageIndexList:[],preShareType:S.ShareType.All,preShareVisibility:S.ShareVisibility.Default,shareType:S.ShareType.All,shareActionPosition:"dropdown",shareTitle:"",extraInfo:{},setContentTypeWhiteList:t=>{e({contentTypeWhiteListInitialized:!0,contentTypeWhiteList:t})},enterSelectMode:async n=>{var a,i,s,o,l,r,d,u,g,p,v,y,m,L;let{scene:T,extraInfo:f={},data:I,justUpdateInfo:x}=n,{isSelectMode:C,scene:_}=t();if(C&&T===_&&!x)return;let M=await (0,c.getAsyncChatStore)("chatMessageBoxLayoutStore");M.getState().updateSendMessageBoxConfig({containerDataAttr:"select-mode"}),M.getState().updateReceiveMessageBoxConfig({containerDataAttr:"select-mode"}),null===(a=M.getState().getLayoutSetter())||void 0===a||a.setLayoutAreaInVisible("bottom"),null===(i=M.getState().getLayoutSetter())||void 0===i||i.setLayoutAreaInVisible("top"),null===(s=M.getState().getLayoutSetter())||void 0===s||s.setLayoutAreaInVisible("right"),null===(o=M.getState().getLayoutSetter())||void 0===o||o.setLayoutAreaVisible("left"),e({extraInfo:f,scene:T,isSelectMode:!0,preShareId:(null==I?void 0:I.pre_share_id)||(null==I?void 0:null===(l=I.share_info)||void 0===l?void 0:l.share_id)||"",shareToken:null!==(y=null==I?void 0:I.share_token)&&void 0!==y?y:"",preMessageIndexList:(null==I?void 0:null===(r=I.share_info)||void 0===r?void 0:r.share_status)===2&&null!==(m=null==I?void 0:null===(d=I.share_info)||void 0===d?void 0:d.message_index_list)&&void 0!==m?m:[],preShareType:(null==I?void 0:null===(u=I.share_info)||void 0===u?void 0:u.share_type)||S.ShareType.All,preShareVisibility:null!==(L=null==I?void 0:null===(g=I.share_info)||void 0===g?void 0:g.share_visibility)&&void 0!==L?L:S.ShareVisibility.Default,shareType:(null==I?void 0:null===(p=I.share_info)||void 0===p?void 0:p.share_type)||S.ShareType.All,shareTitle:null==I?void 0:null===(v=I.share_info)||void 0===v?void 0:v.share_name}),h.DeprecatedChatEvent.emit("chat.share.select",{scene:T,isSelectMode:!0})},exitSelectMode:async()=>{var n,a,i,s;if(!t().isSelectMode)return;let o=await (0,c.getAsyncChatStore)("chatMessageBoxLayoutStore");o.getState().updateSendMessageBoxConfig({containerDataAttr:""}),o.getState().updateReceiveMessageBoxConfig({containerDataAttr:""}),null===(n=o.getState().getLayoutSetter())||void 0===n||n.setLayoutAreaVisible("bottom"),null===(a=o.getState().getLayoutSetter())||void 0===a||a.setLayoutAreaVisible("top"),null===(i=o.getState().getLayoutSetter())||void 0===i||i.setLayoutAreaInVisible("right"),null===(s=o.getState().getLayoutSetter())||void 0===s||s.setLayoutAreaInVisible("left"),e({scene:void 0,isSelectMode:!1,messageIndexList:[],preShareId:"",shareToken:"",preMessageIndexList:[],extraInfo:{}}),h.DeprecatedChatEvent.emit("chat.share.select",{scene:void 0,isSelectMode:!1})},toggleMessage:n=>{var a;let{conversationId:i,messageIndex:l,state:r}=n,{messageIndexList:d,getIsCheckboxDisabled:u,findMessageByIndex:g}=t(),p=d.includes(l),c=g({conversationId:i,state:r,messageIndex:l}),h=(0,T.findSendAndAllReplyMessageIndexListSelector)(r,i,null!==(a=null==c?void 0:c.message_id)&&void 0!==a?a:""),[y,...S]=h,m=l===y;if(p)return!m&&S.filter(e=>d.includes(e)).length>1?e({messageIndexList:(0,s.default)(d,l)}):e({messageIndexList:(0,s.default)(d,...h)}),t().messageIndexList;if(u({conversationId:i,messageIndex:l,state:r}))return t().messageIndexList;let L=h.filter(e=>!u({conversationId:i,messageIndex:e,state:r}));return d.length+L.length>v.defaultShareThreadMaxMessageNumber?e({messageIndexList:[...d,l].sort((e,t)=>e-t)}):e({messageIndexList:(0,o.default)([...d,...L]).sort((e,t)=>e-t)}),t().messageIndexList},selectAll:n=>{let{_getSelectAllIndexList:a}=t();return e({messageIndexList:a(n)}),t().messageIndexList},deselectAll:()=>{e({messageIndexList:[]})},findMessageByIndex:e=>{var t,n;let{conversationId:a,state:i,messageIndex:s}=e,o=i.messageMap[a],l=i.messageLinkMap[a];if(!o||!l)return;let r=Number(null===(t=o[null===(n=l[0])||void 0===n?void 0:n.messageId])||void 0===t?void 0:t.index),d=l[s-r];if(d){let e=(0,T.getMessageSelector)(i,a,d);if((null==e?void 0:e.index)===s)return e}let u=Object.keys(o).find(e=>{var t;return Number(null===(t=o[e])||void 0===t?void 0:t.index)===s});if(u)return o[u]},_getSelectAllIndexList:e=>{var n,a,i,s,o,u;let{conversationId:g,state:p,lastMessageIndex:c}=e,{getIsCheckboxDisabled:h}=t(),v=p.messageMap[g],y=p.messageLinkMap[g];if(!v||!y)return[];let S=Number(null===(n=v[null===(a=y[0])||void 0===a?void 0:a.messageId])||void 0===n?void 0:n.index),m=Number(null===(i=v[null===(s=y[y.length-1])||void 0===s?void 0:s.messageId])||void 0===i?void 0:i.index);return m<y.length&&(m=null!==(u=(0,l.default)(null===(o=(0,L.findLatestBatchMessages)(g))||void 0===o?void 0:o.map(e=>Number(e.index))))&&void 0!==u?u:y.length),(0,r.default)(1,c+1).filter(e=>!(0,d.default)(e,S,m+1)||!h({conversationId:g,messageIndex:e,state:p}))},getIsSelectAllChecked:e=>{let{messageIndexList:n,_getSelectAllIndexList:a}=t(),i=a(e);return n.length>0&&n.length>=i.length},getIsCheckboxDisabled:e=>{let{conversationId:n,state:a,messageIndex:i}=e,{messageIndexList:s,findMessageByIndex:o,_isMessageDisableSelect:l,contentTypeWhiteList:r}=t();if(s.includes(i))return!1;let d=o({state:a,messageIndex:i,conversationId:n}),u=l(d);if(u){var g;m.logger.persist.info({eventName:"thread_share_checkbox_disabled",meta:{messageIndex:null==d?void 0:d.index,messageId:null==d?void 0:d.message_id,messageStatus:null==d?void 0:d.status,messageContentType:null==d?void 0:d.content_type,contentTypeWhiteList:r,isOnboarding:null==d?void 0:null===(g=d.ext)||void 0===g?void 0:g.onboarding,listLength:s.length}})}return u},_isMessageDisableSelect:e=>{var n;let{messageIndexList:a,contentTypeWhiteList:i,contentTypeWhiteListInitialized:s}=t();return s||m.logger.persist.info({eventName:"thread_share_checkbox_disabled",meta:{whiteListInit:"0"}}),!!(!e||(0,g.isAIPPTOutlineMessage)(e)||(0,g.isAIPPTOutlineLoadingMessage)(e))||e.status===y.PushMessageStatus.InVisible||(null===(n=e.ext)||void 0===n?void 0:n.onboarding)==="1"||a.length>=v.defaultShareThreadMaxMessageNumber||((0,p.isAIPodcastMessage)(e)?!(0,p.isAIPodcastMessageGenerated)(e):!(e.content_type&&i.includes(e.content_type)))},updateMessageIndexList:n=>{let{messageIndexList:a,_isMessageDisableSelect:i}=t(),s=[];for(let e of Object.values(n))-1!==a.indexOf(Number(e.index))&&i(e)&&s.push(Number(e.index));e({messageIndexList:a.filter(e=>!s.includes(e))})},setShareType:t=>{e({shareType:t})}})))}}]);