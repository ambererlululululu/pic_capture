"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["98222"],{595222:function(e,t){t.default={"samantha-tooltip":"samantha-tooltip-YTiKBB",samanthaTooltip:"samantha-tooltip-YTiKBB"}},214902:function(e,t,n){n.d(t,{SamanthaTooltip:function(){return d}});var a=n(713738),i=n(812650),r=n.n(i),l=n(504694),u=n(595222),s=n(345660);let o=()=>(0,s.jsx)("svg",{width:"6",height:"16",viewBox:"0 0 6 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"semi-tooltip-icon-arrow",children:(0,s.jsx)("path",{d:"M1.99309 11.5617L5.15916 8.74741C5.60668 8.34962 5.60668 7.65038 5.15916 7.25259L1.99309 4.4383C0.725344 3.31142 -6.25239e-07 1.69619 -6.99382e-07 0L-3.49691e-07 8L0 16C-7.41428e-08 14.3038 0.725345 12.6886 1.99309 11.5617Z",fill:"currentColor"})}),c=()=>(0,s.jsx)("svg",{width:"17",height:"6",viewBox:"0 0 17 6",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"semi-tooltip-icon-arrow",children:(0,s.jsx)("path",{d:"M4.9383 1.99309L7.75259 5.15916C8.15038 5.60668 8.84962 5.60668 9.24741 5.15916L12.0617 1.99309C13.1886 0.725344 14.8038 0 16.5 0L8.5 0L0.5 0C2.19619 0 3.81142 0.725345 4.9383 1.99309Z",fill:"currentColor"})}),d=a.forwardRef(function(e,t){let{position:n="top",showArrow:a=!0}=e;return(0,s.jsx)(l.default,{ref:t,...e,className:r()(u.default["samantha-tooltip"],e.className),showArrow:!!a&&(n.includes("left")||n.includes("right")?(0,s.jsx)(o,{}):(0,s.jsx)(c,{})),children:e.children})})},883393:function(e,t,n){n.d(t,{DefaultBreakpoints:function(){return s},useAppSizeType:function(){return o}});var a=n(713738),i=n(217957),r=n(161284),l=n(992528);let u=(e,t)=>(0,i.default)(e)?"lg":e<=t.sm?"sm":e<=t.md?"md":"lg",s={sm:599,md:899},o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,[t,n]=(0,a.useState)(),i=(0,a.useRef)(null),{getRootContainer:o}=(0,l.useChat)({optionalProvider:!0});if(i.current||(i.current=(null==o?void 0:o())||("undefined"!=typeof window?document.getElementById("root"):null)),(0,r.useResizeObserver)({ref:i,onResize:t=>{let{width:a}=t;n(u(a,e))}}),void 0===t){var c;return u(null===(c=i.current)||void 0===c?void 0:c.getBoundingClientRect().width,e)}return t}},876187:function(e,t,n){n.d(t,{useTeaVarWithFeatureGating:function(){return u}});var a=n(713738),i=n(353590),r=n(186767),l=n(666196);let u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],{autoRefresh:n=!0}=e,u=(0,l.useChatService)("chatTeaService"),s=(0,l.useChatService)("chatConfigService"),[o=e.defaultValue,c]=(0,i.default)(`libra_setting_${e.key}`,{defaultValue:e.defaultValue}),d=(0,a.useCallback)(async()=>{c(await (0,r.getTeaVar)({key:e.key,defaultValue:null==e?void 0:e.defaultValue,featureGatingKey:null==e?void 0:e.featureGatingKey,chatTeaService:u,chatConfigService:s}))},[e.key,e.defaultValue]);return(0,a.useEffect)(()=>{d()},t),(0,a.useEffect)(()=>{if(n)return u.onAbComplete(d)},[n]),o}},781313:function(e,t,n){n.d(t,{isLocalConversation:function(){return i}});var a=n(230932);function i(e){let{localConversationMap:t}=a.useFeedStore.getState();return e in t}},847448:function(e,t,n){n.d(t,{useSendAttachmentsStatus:function(){return d}});var a=n(713738),i=n(144993),r=n(640784),l=n(777422),u=n(915299),s=n(910214),o=n(722038),c=n(231149);function d(e){var t,n;let{attachmentStates:d,trackParams:h,scene:g}=e,p=(0,u.useTranslateFn)(),{data:_,enableUltraLongText:v}=(0,r.useFetchUserSetting)(),m=d.length>0,{data:S}=(0,c.default)(async()=>{if(m){var e,t;return null!==(t=null===(e=(await s.samanthaApiService.CheckUltraLongTextQuota()).data)||void 0===e?void 0:e.has_quota)&&void 0!==t&&t}},{refreshDeps:[m]}),C=Number((null==_?void 0:null===(t=_.ai_reader)||void 0===t?void 0:t.max_char_count)||1e5),y=Number((null==_?void 0:null===(n=_.ai_reader)||void 0===n?void 0:n.ult_max_char_count)||1e5);return(0,a.useMemo)(()=>{if(0===d.length)return{success:!0};if(d.some(e=>e.status===i.AttachmentStatus.Retry))return{success:!1,tips:p("file_upload_failed")};if(d.some(e=>e.status===i.AttachmentStatus.Uploading))return{success:!1,tips:p("file_uploading_cant_sent")};if(d.filter(f).some(e=>e.parseState===o.ParseState.ParseState_Failed))return{success:!1,tips:p("multi_files_parse_failed")};if(d.filter(f).some(e=>{let{parseState:t=o.ParseState.ParseState_Default}=e;return[o.ParseState.ParseState_Default,o.ParseState.ParseState_Processing].includes(t)}))return{success:!1,tips:p("skill_read_parsing")};let e=d.reduce((e,t)=>{var n;return e+(null!==(n=t.parsedCharCount)&&void 0!==n?n:0)},0),t=1===d.length,n=e>C,a=n?(C/e*100).toFixed(1):"100";return("attachmentArea"===g&&(0,l.trackEvent)("upload_parse",{all_token_length:e,single_file_token_length:d.map(e=>{let{parsedCharCount:t}=e;return t||0}).join(","),is_long_file:+!!n,file_cnt:d.length,success_cnt:d.length,...h}),t)?{success:!0,tips:n?p("single_file_exceed_limit",{postProcess:"sprintf",sprintf:["\u8C46\u5305",`${a}%`]}):void 0}:{success:!n,tips:n?p("multi_files_exceed_limit_alert",{postProcess:"sprintf",sprintf:["\u8C46\u5305",`${a}%`]}):void 0}},[d,p,C,v,S,y])}function f(e){return"file"===e.type||"directory"===e.type||e.isRepo}},44502:function(e,t,n){n.d(t,{getDisplaySkills:function(){return s},useActiveSkill:function(){return l},useActiveSkillType:function(){return r},useDisplaySkills:function(){return o}});var a=n(913821),i=n(698392);let r=e=>(0,i.useChatSlice)("chatInputStore",t=>t.activeSkillTypeMap[e]),l=e=>(0,i.useChatSlice)("chatInputStore",t=>{let n=t.activeSkillTypeMap[e],{skillMap:a}=t;return n?null==a?void 0:a[n]:void 0}),u=e=>{var t,n;return null!==(n=null===(t=e.inputSkills)||void 0===t?void 0:t.map(t=>{if(t.skill_type)return{...t,...e.skillMap[t.skill_type]}}).filter(Boolean))&&void 0!==n?n:[]},s=()=>u((0,i.getChatSlice)("chatInputStore")),o=()=>(0,i.useChatSlice)("chatInputStore",u,a.default)},588549:function(e,t,n){n.d(t,{ExitSkillScene:function(){return i},trackExitSkill:function(){return r}});var a=n(777422);let i=Object.freeze({Keyboard:"keyboard",Click:"click"}),r=function(){let{exitScene:e,trackParams:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.trackEvent)("skill_module_close",{exit_scene:e,...t}),(0,a.trackEvent)("exit_skill",{exit_scene:e,...t})}},10597:function(e,t,n){n.d(t,{useChatGuestLogin:function(){return _},useGuestInputInteract:function(){return m},useGuestInteract:function(){return v}});var a=n(865607),i=n(4137),r=n(845647),l=n(876187),u=n(922851),s=n(269249),o=n(230932),c=n(971857),d=n(631122),f=n(831566),h=n(915299),g=n(198660),p=n(178230);let _=e=>{let{source:t,eventName:n,meta:a,chatType:i}=e,l=(0,s.useChatType)(),o=null!=i?i:l,c=(0,d.useToast)();return{chatGuestLogin:function(){let{toastContent:e,type:i,source:l}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e&&c.error(e),(0,g.getIsLoggedIn)()||(n&&p.logger.persist.info({eventName:n,meta:{...a,type:i}}),f.DeprecatedChatEvent.emit("chat.guest.login",{source:l||t,bot:o===r.ChatType.Bot}),(0,u.getChatService)("chatNavigateService").then(e=>null==e?void 0:e.navigateToLoginPage(l||t)))}}},v=e=>{let{checkNewGuidanceAb:t,...n}=e,{chatGuestLogin:a}=_(n),i=(0,l.useTeaVarWithFeatureGating)({key:"new_guest_guidance_type",defaultValue:"normal",featureGatingKey:"enableGuestSendSkill"})||"normal";return{onClickGuestDisabled:async function(){let{source:e,checkNewGuidanceAb:r=t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!!r&&!!i||(await (0,g.getLoginLoadingPromise)(),!!(0,g.getIsLoggedIn)()||(a({source:e||n.source}),!1))}}},m=function(){let{chatId:e,activeSkillType:t,checkNewGuidanceAb:n,...u}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{chatGuestLogin:d}=_(u),f=(0,s.useChatViewConfig)(),p=e||(null==f?void 0:f.chatId),v=u.chatType||(null==f?void 0:f.chatType),[m,S,C,y]=(0,o.useFeedStore)(e=>[e.chatNotReachLimitMap,e.guestReachCreateThreadLimit,e.guestReachSendMessageLimit,e.guestSendMessageLimit],a.shallow),{threadLinks:k}=(0,c.useThreadList)(),w=(0,l.useTeaVarWithFeatureGating)({key:"new_guest_guidance_type",defaultValue:"normal",featureGatingKey:"enableGuestSendSkill"})||"normal";return{onBeforeSendMessage:async function(){let{checkNewGuidanceAb:e=n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(await (0,g.getLoginLoadingPromise)(),!(0,g.getIsLoggedIn)()){if(e&&t&&!w)return d(),!1;if([r.ChatType.NewThread,r.ChatType.ThreadLocalConversation,r.ChatType.SharedThreadContinueChat].includes(v)&&(S||C||!o.useFeedStore.getState().guestCanChat))return d({toastContent:C&&0===k.length?void 0:(0,h.getUnreactiveTranslate)("touristMode_chat_count_limitation_toast"),type:"create_thread_limit"}),!1;if(p){let e=m[p];if(!(0,i.default)(e)&&!e||(0,i.default)(e)&&C)return d({toastContent:y>0?(0,h.getUnreactiveTranslate)("touristMode_message_count_limitation_withParam_toast").replace("{s_messageCount}",y.toString()):void 0,type:"send_message_limit"}),!1}}return!0}}}}}]);