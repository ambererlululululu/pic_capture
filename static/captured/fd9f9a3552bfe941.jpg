"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["94680"],{72516:function(e,r,t){t.d(r,{genUserDefaultProfile:function(){return S},getProfileInfo:function(){return v},resetProfile:function(){return E},resetUserInfos:function(){return w},updateUserInfo:function(){return f},updateUserInfoLoaded:function(){return m},updateUserProfile:function(){return h}});var n=t(4137),a=t(910214),o=t(769783),i=t(177048),s=t(643404),_=t(47563),l=t(856392),u=t(178230),c=t(797840),g=t(369269),d=t(886941),p=t(193907);let f=e=>{var r;return((0,d.updateWorkspaceParams)({type:null!==(r=e.passport_enterprise_user_type)&&void 0!==r?r:p.PassportEnterpriseUserTypeEnum.Normal}),c.useFlowAccountStore.setState({userInfo:e,userInfoLoaded:!0}),null==e?void 0:e.user_id_str)?v(e.user_id_str):Promise.reject(Error("user_id_str is empty"))},m=()=>{c.useFlowAccountStore.setState({userInfoLoaded:!0})},v=async(e,r)=>{if(!e)return Promise.reject(Error("user_id_str is empty"));let t=(0,l.createReportEvent)({eventName:"get_profile_info",meta:{user_id:e}});try{let{data:r}=await a.profileApiService.ProfileInfo({visit_id:e});if(r){var n;return c.useFlowAccountStore.setState({userProfile:{...null==r?void 0:r.profile_brief,loaded:!0,botCount:Number(null==r?void 0:null===(n=r.profile_bot_info)||void 0===n?void 0:n.total)||0}}),t.success(),null==r?void 0:r.profile_brief}t.error({reason:"no data"})}catch(n){if((0,o.isApiError)(n)&&n.errorOption.code===i.ErrorCodes.USER_NOT_EXISTED.toString()){if(u.logger.persist.info({eventName:"gen_user_profile_for_user_stay_on_chat_page",meta:{user_id:e}}),r)throw Error("get profile only get");0!==await h({entity_id:e,avatar_url:"",nickname:"",user_name:""})&&(c.useFlowAccountStore.setState({userProfile:{loaded:!0}}),t.error({reason:"with update fail",error:n}))}else t.error({reason:"unhandle catch",error:n instanceof Error?n:Error(String(n))})}},h=async e=>{let r=(0,l.createReportEvent)({eventName:"update_user_profile",meta:{user_id:e.entity_id}});try{r.addDurationPoint("start");let{code:t,msg:n,data:o}=await a.profileApiService.UpdateProfile(e);if(0===t&&(null==o?void 0:o.entity_id))return r.addDurationPoint("success"),r.success(),await v(null==o?void 0:o.entity_id),0;return n&&_.SamanthaToast.error(n),0===t?-1001:Number(t)}catch(t){if(r.error({reason:"update_user_profile_failed",error:t instanceof Error?t:Error(String(t))}),(0,o.isApiError)(t)&&(e.nickname||!e.entity_id))return t.errorOption.message&&_.SamanthaToast.error(t.errorOption.message),(0,n.default)(t.errorOption.code)?-1002:parseInt(t.errorOption.code,10);try{let t=await (0,s.retryAsync)(()=>v(e.entity_id,!0),3,e=>800*e,(e,t)=>{r.updateMeta({retry:t,[`retry${t}`]:e})});if(null==t?void 0:t.entity_id)return r.updateMeta({retrySuccess:1}),0;throw Error("retry not entity_id")}catch(e){r.updateMeta({retrySuccess:0,retryFail:e})}return -1003}},w=()=>{c.useFlowAccountStore.setState({userInfo:g.defaultFlowAccountStore.userInfo,userProfile:g.defaultFlowAccountStore.userProfile})},E=()=>{c.useFlowAccountStore.setState({userProfile:g.defaultFlowAccountStore.userProfile})},S=async e=>{try{var r,t;let n=await Promise.all([a.profileApiService.UpdateProfile({entity_id:e,avatar_url:"",nickname:"",user_name:""}),a.profileApiService.UserHitProfileRegister()]);return(null==n?void 0:null===(t=n[1])||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.profile_enable)||!1}catch(e){return u.logger.persist.error({eventName:"gen_user_default_profile_error",message:"[genUserDefaultProfile] genUserDefaultProfile failed",error:e instanceof Error?e:Error(String(e))}),!1}}},876500:function(e,r,t){t.d(r,{PassportApiError:function(){return i},PassportErrorCodes:function(){return o},isAccountError:function(){return c},isAccountErrorResponse:function(){return g},isCloseCaptchaError:function(){return u},isPassportApiError:function(){return s},isPassportApiSwitchAccountCheckError:function(){return l},isPassportApiWorkspaceSelectError:function(){return _}});var n,a=t(217957);let o=((n={})[n.NOT_LOGGED_IN=13]="NOT_LOGGED_IN",n[n.APP_NO_ACCESS=16]="APP_NO_ACCESS",n[n.ALREADY_BIND_CONFLICT=1041]="ALREADY_BIND_CONFLICT",n[n.TARGET_BIND_CONFLICT=1030]="TARGET_BIND_CONFLICT",n[n.NO_BIND_MOBILE=1342]="NO_BIND_MOBILE",n[n.LAST_PASSPORT=1038]="LAST_PASSPORT",n[n.PHONE_BIND_CONFLICT=1057]="PHONE_BIND_CONFLICT",n[n.PHONE_ALREADY_REGISTERED=1001]="PHONE_ALREADY_REGISTERED",n[n.VERIFY_CODE_EXCEED=1206]="VERIFY_CODE_EXCEED",n[n.CSRF_TOKEN_ERROR=2035]="CSRF_TOKEN_ERROR",n[n.BIND_TOO_OFTEN=2068]="BIND_TOO_OFTEN",n[n.DOUBAO_NON_CN_MOBILE_REGISTRY_BAN=0x128bf1a21]="DOUBAO_NON_CN_MOBILE_REGISTRY_BAN",n[n.DOUBAO_APPLE_REGISTRY_BAN=0x128bf1a22]="DOUBAO_APPLE_REGISTRY_BAN",n);class i extends Error{static from(e){var r,t;let n=null==e?void 0:null===(r=e.data)||void 0===r?void 0:r.description,a=null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.error_code,o=null==e?void 0:e.data;return new i(a,n?String(n):void 0,o)}constructor(e,r,t){super(r),this.code=e,this.description=r,this.raw=t}}let s=e=>e instanceof i,_=e=>s(e)&&1454===e.code,l=e=>s(e)&&2002===e.code,u=e=>"CLOSE_CAPTCHA"===e,c=e=>!(0,a.default)(null==e?void 0:e.description)&&!(0,a.default)(null==e?void 0:e.error_code),g=e=>(null==e?void 0:e.message)==="error"},369682:function(e,r,t){t.d(r,{FLOW_WEB_LOGIN_KEY:function(){return a},isStorageLogined:function(){return s},setStorageHasLogined:function(){return o},setStorageNotLogined:function(){return i}});var n=t(38848);let a="flow_web_has_login",o=()=>{n.FlowLocalStorage.setItem(a,"true")},i=()=>{n.FlowLocalStorage.removeItem(a)},s=()=>"true"===n.FlowLocalStorage.getItem(a)},105802:function(e,r,t){t.d(r,{onAccountChange:function(){return _}});var n=t(996080),a=t(970106),o=t(100161),i=t(992847),s=t(910214);let _=()=>{o.FGStoreManager.instance().loadSource(i.FGBuiltinNames.serverAB,!0),window[n.PromiseName.GuestLayoutMode]&&(window[n.PromiseName.GuestLayoutMode]=s.samanthaApiService.GetSetting({ab_param:{ab_request:a.AbRequestParams}}))}},780464:function(e,r,t){t.d(r,{notifyLoginStatusChange:function(){return o}});var n=t(712980),a=t(178230);function o(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e){let{extId:r}=(0,n.parseHashOrQuery)(location.search),t={...e,body:{...null==e?void 0:e.body,originContext:"web"}};if(r)try{var o,i;return null===(i=chrome)||void 0===i?void 0:null===(o=i.runtime)||void 0===o?void 0:o.sendMessage(r,e)}catch(e){a.logger.persist.error({message:"[ext-helper] sendMessage via chrome.runtime.sendMessage error",error:e})}try{window.postMessage(t,location.origin)}catch(e){a.logger.persist.error({message:"[ext-helper] sendMessage error, retry via window.postMessage",error:e})}}({name:"update-auth-info",body:{isLogin:e}})}},393454:function(e,r,t){t.d(r,{deprecatedCheckLoginWithPrefetchForInjectScript:function(){return s},prefetchThirdLoginKeys:function(){return l}});var n=t(996080),a=t(690619),o=t(876500),i=t(178230);let s=async()=>{if(!window.accountInfoPromise)return(0,a.getFlowAccount)().passportApi.checkLogin();try{let e=await window.accountInfoPromise;if(delete window.accountInfoPromise,"success"===e.message)return i.logger.persist.log({eventName:"check_login_preload_success"}),e.data;throw e.data}catch(e){if(13!==e.error_code)return i.logger.persist.log({eventName:"check_login_preload_fail",meta:{code:e.error_code}}),(0,a.getFlowAccount)().passportApi.checkLogin();throw o.PassportApiError.from(e)}},_="object"==typeof window&&"object"==typeof window[n.PromiseName.Launch]?window[n.PromiseName.Launch]:void 0,l=_?async()=>{let{data:e}=await _||{},{login:r}=e||{};return(null==r?void 0:r.order)||[]}:void 0},970106:function(e,r,t){t.d(r,{AbRequestParams:function(){return n}});let n={show_deep_thinking_btn:{parmas:["rich_media_with_text","loading","deep_think_show"],ignore_login_status:!0},deep_thinking_btn_memo:{parmas:["rich_media_with_text","loading","deep_think_memory"],ignore_login_status:!0},deep_thinking_auto:{parmas:["rich_media_with_text","loading","deep_thinking_auto"],ignore_login_status:!0},trim_landing_page_skills:{parmas:["guidance_skills_upgrade","trim_skills"],ignore_login_status:!0},trim_landing_page_skill_names:{parmas:["guidance_skills_upgrade","compact_name"],ignore_login_status:!0},trim_landing_page_nav_new_doc_name:{parmas:["guidance_skills_upgrade","nav_new_doc_name"],ignore_login_status:!0},guidance_input_skill_behaivior:{parmas:["guidance_input_skill_behaivior","value"],ignore_login_status:!0},new_ui_landing_page_rollback:{parmas:["guidance_skills_upgrade","landing_page_rollback"],ignore_login_status:!0},new_ui_force_image_skill_tag:{parmas:["guidance_skills_upgrade","force_image_skill_tag"],ignore_login_status:!0},new_ui_colorful_skill_icons:{parmas:["guidance_skills_upgrade","colorful_skill_icons"],ignore_login_status:!0},new_ui_increase_contrast_level_1:{parmas:["guidance_skills_upgrade","increase_contrast_level_1"],ignore_login_status:!0},new_ui_increase_contrast_level_2:{parmas:["guidance_skills_upgrade","increase_contrast_level_2"],ignore_login_status:!0},age_gate:{parmas:["guest_mode","pop_out"],is_login:!1},new_guidance_type:{parmas:["new_guidance_type","value"],is_login:!0},new_guest_guidance_type:{parmas:["new_guest_guidance_type","value"],is_login:!1},samantha_ci_interpreter:{parmas:["samantha_ci_interpreter","enable_nova_chat"],is_login:!1,ignore_login_status:!0},show_upgrade:{parmas:["samantha_skill","image","show_upgrade"],is_login:!0},enable_super_task:{parmas:["supertask","enable_supertask"],is_login:!0,ignore_login_status:!0},enable_super_task_mode_switch:{parmas:["supertask","route_flow_pc_flag"],is_login:!0,ignore_login_status:!0},enable_im_platform:{parmas:["enable_im_platform","value"],ignore_login_status:!0},aispace_revert:{parmas:["aispace_revert_v2","enable_ai_space"],is_login:!0,ignore_login_status:!0},aispace_rename:{parmas:["aispace_rename","name_type"],is_login:!0,ignore_login_status:!0},enable_code_dev_mode:{parmas:["code_assist_dev_mode","enable"],ignore_login_status:!0},show_deep_thinking_binary_mode:{parmas:["deep_thinking_switch","value"],ignore_login_status:!0},doc_new_tab_home:{parmas:["flowpc_web","otter_page_ui","new_tab_home"],ignore_login_status:!0},doc_new_tag:{parmas:["flowpc_web","otter_page_ui","new_tag"],ignore_login_status:!0},doc_new_home:{parmas:["flowpc_web","otter_page_ui","new_home"],ignore_login_status:!0},sidebar_avatar:{parmas:["ui_version","avatar"],ignore_login_status:!0},doc_needs_guidance:{parmas:["flowpc_web","otter_page_ui","needs_guidance"],ignore_login_status:!0}}},837689:function(e,r,t){t.d(r,{setUserLanguageCode:function(){return p},getSettingLanguageListWithCache:function(){return u},isAllowLanguage:function(){return s},getDefaultLanguage:function(){return c},getUserLanguageCode:function(){return d}});var n=t(816295),a=t(910214),o=t(242212),i=t(38848);let s=(e,r)=>null==e?void 0:e.map(e=>e.language_code).includes(r),_=()=>{let e=i.FlowLocalStorage.getItem("setting_language_list");if(!e)return null;try{return JSON.parse(e)}catch(e){return null}},l=async()=>{try{var e;let r=await a.samanthaApiService.GetSetting(),t=null===(e=r.data)||void 0===e?void 0:e.language_list;if(!t)return null;return i.FlowLocalStorage.setItem("setting_language_list",JSON.stringify(t)),t}catch(e){return null}},u=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=_();return r?(e&&(0,n.afterAppInitLazyExec)(()=>{l()}),Promise.resolve(r)):l()},c=()=>"zh",g=function e(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{maxAge:n=1/0}=t,a=(0,o.default)(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return{value:r(...t),timestamp:Date.now()}});return function(){for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];let _=a(...i);return Date.now()-_.timestamp>n?(a.cache.delete(i),e(r,t)(...i)):_.value}}(()=>a.samanthaApiService.GetUserPreference(),{maxAge:3e3}),d=async()=>{var e;return null===(e=(await g()).data)||void 0===e?void 0:e.lang},p=async e=>(await a.samanthaApiService.SetUserPreference({lang:e})).code},829175:function(e,r,t){t.d(r,{reloadForLanguageChange:function(){return u}});var n=t(761637),a=t(667095),o=t(820791),i=t(81752),s=t(856392),_=t(178230),l=t(837689);let u=async()=>{if("undefined"!=typeof window){let e=(0,s.createReportEvent)({eventName:"check_language_changed"}),r=(0,n.getUnreactiveLanguage)();e.updateMeta({i18nLanguage:r});let[t,u]=await Promise.all([(0,l.getSettingLanguageListWithCache)(!1),(0,l.getUserLanguageCode)()]),c=u;c&&c!==a.BROWSER_LANGUAGE_CODE||(c="zh");let g=(0,o.convertDetectedLanguage)(c),d=g;if((0,l.isAllowLanguage)(t,g)||(d=(0,l.getDefaultLanguage)()),e.updateMeta({userLanguageCode:u,realCode:c,coverted:g,finalLanguage:d}),d!==r){(0,i.setLocalUserLanguageCode)(d),(0,i.setI18nextLng)(d),_.logger.persist.info({eventName:"loginLanguageReload",meta:{userLanguageCode:u,navigatorLanguage:navigator.language,i18nLanguage:r}}),await (0,i.changeLanguage)(d),e.success({meta:{changed:1}}),window.location.reload();return}e.success({meta:{changed:0}})}}},776140:function(e,r,t){t.d(r,{handleServerReportChannels:function(){return m},reportOCPC:function(){return c},reportUetWebRegisterEvent:function(){return g}});var n=t(340002),a=t(696557),o=t(257029),i=t(910214),s=t(712980),_=t(178230);let l=e=>{try{return!!new URL(e).searchParams.get("channel")}catch(e){return!1}},u=()=>["ug_apk_token","ug_utm_source"].some(e=>(0,s.getUrlParams)(e)),c=async e=>{let r="download"===e,t=r?location.href:(0,a.loadTeaLandingUrl)();if(!r&&!l(t)||r&&!u())return;let{tea_uuid:n}=await d({needUid:!1});i.notifyApiService.ReportOCPCEvent({landing_page_url:t,app_id:"482431",event_name:e,event_ts:String(Math.floor(Date.now()/1e3))},{overrideParams:{device_id:n}}).catch(e=>{_.logger.persist.error({message:"error when report ocpc",error:e})})};function g(e){try{let r=e.new_user,t="1"===n.default.get("is_microsoft_channel");r&&t&&window.uetq.push("event","web_register",{})}catch(e){_.logger.persist.error({error:e,eventName:"uetq_web_register_event_error"})}}let d=e=>{let{needUid:r=!0}=e;return new Promise(e=>{let t=setInterval(()=>{let n=(0,o.getUuidAndWebIdFromTeaConfig)().uuid,a=(0,o.getUidFromTeaConfig)();n&&(a||!r)&&(clearInterval(t),e({tea_uid:String(a),tea_uuid:String(n)}))},500);setTimeout(()=>{clearInterval(t)},1e4)})},p=["channel","360_xxl","wangyi","bilibili_xxl","bilibili_xxl_hy","bilibili_xxl_ly","baidu_xxl","360","baidu_sem","gdt_sem","gdt_xxl","zhihu_xxl","youku_xxl"],f=(e,r)=>e.filter(e=>e===r).length>0,m=(e,r)=>{if(f(e,r))try{let e=new URLSearchParams(window.location.search).get("channel");e&&p.includes(e)&&c(r)}catch(e){_.logger.persist.error({error:e,eventName:"server_report_ocpc_event_error"})}}}}]);