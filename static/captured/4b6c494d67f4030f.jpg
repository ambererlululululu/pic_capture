"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["32179"],{501108:function(e,t,r){r.d(t,{useParams:function(){return o}});var n=r(915317),a=r(532430);let o=()=>(0,a.getFromInstance)("useParams",n.useParams)()},728319:function(e,t,r){r.d(t,{DefaultErrorFallback:function(){return u}});var n=r(713738),a=r(533389),o=r(178230),l=r(560174),i=r(345660);let u=e=>{let{error:t}=e,r="ChunkLoadError"===t.name;return(0,n.useEffect)(()=>{o.logger.persist.error({eventName:"boundary_default_error_fallback",error:t,meta:{is_package:1}})},[]),(0,i.jsx)(a.NoSSR,{children:(0,i.jsx)(l.CommonErrorPage,{showReloadBtn:!0,showHomeBtn:!r,from:"ErrorFallback"})})}},659896:function(e,t,r){r.d(t,{BaseSlotsProvider:function(){return l},useOptionalBaseSlots:function(){return u}});var n=r(713738),a=r(40680);let o=(0,n.createContext)(null),l=o.Provider,i=(0,n.createContext)({});i.Provider;let u=()=>{let e=(0,n.useContext)(o),t=(0,n.useContext)(i);return(0,a.default)(t,e)}},559613:function(e,t,r){r.d(t,{createBizWithSlots:function(){return o}});var n=r(713738),a=r(345660);let o=(e,t)=>{let r=(0,n.forwardRef)(function(r,n){let o={...r,...t};return(0,a.jsx)(e,{...o,ref:n})});return r.displayName=`${e.displayName||e.name}ComposedSlots`,r}},761473:function(e,t,r){r.d(t,{useDeprecatedChatEventEffect:function(){return l},useDeprecatedChatEventValue:function(){return i}});var n=r(713738),a=r(297547),o=r(831566);let l=(e,t)=>{let r=(0,a.default)(t);(0,n.useEffect)(()=>(o.DeprecatedChatEvent.on(e,r),()=>{o.DeprecatedChatEvent.off(e,r)}),[])},i=(e,t)=>{let r=(0,n.useRef)(null),[a,l]=(0,n.useState)(t);return r.current||(r.current=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return l(t[0])},o.DeprecatedChatEvent.addListener(e,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return l(t[0])})),(0,n.useEffect)(()=>()=>void o.DeprecatedChatEvent.removeListener(e,r.current),[]),a}},767231:function(e,t,r){r.d(t,{useDragOver:function(){return l}});var n=r(713738),a=r(441259);let o=(e,t)=>{var r,n,o;let{canSendFile:l=!1,canSendImage:i=!1}=t||{};return(!!l||!!i)&&((0,a.isAppleWebkit)()?(null===(o=e.dataTransfer)||void 0===o?void 0:null===(n=o.types)||void 0===n?void 0:n.every(e=>"Files"===e))||!1:[...(null===(r=e.dataTransfer)||void 0===r?void 0:r.items)||[]].every(e=>"file"===e.kind))},l=e=>{let{closeDelay:t=100,canSendFile:r,canSendImage:a}=e,[l,i]=(0,n.useState)(!1);return{isOver:l,divProps:(0,n.useMemo)(()=>{let e;return{onDragEnter:t=>{e&&clearTimeout(e),o(t,{canSendFile:r,canSendImage:a})&&i(!0)},onDragOver:t=>{e&&clearTimeout(e),o(t,{canSendFile:r,canSendImage:a})&&(i(!0),t.preventDefault())},onDragLeave:n=>{e&&clearTimeout(e),o(n,{canSendFile:r,canSendImage:a})&&(t?e=window.setTimeout(()=>i(!1),t):i(!1))},onDrop:t=>{e&&clearTimeout(e),o(t,{canSendFile:r,canSendImage:a})&&(i(!1),t.preventDefault())}}},[i,t,r])}}},603110:function(e,t,r){r.d(t,{ChatMessageLifeCycleEventBus:function(){return n}});class n{on(e,t){var r;this.listeners[e]||(this.listeners[e]=[]),t&&(null===(r=this.listeners[e])||void 0===r||r.push(t))}off(e,t){var r,n;if(!this.listeners[e])return;let a=null===(r=this.listeners[e])||void 0===r?void 0:r.filter(e=>e!==t);this.listeners[e]=[],a&&(null===(n=this.listeners[e])||void 0===n||n.push(...a))}get(e){return this.listeners[e]||[]}constructor(){var e,t,r;t=void 0,(e="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e="listeners","string"))?r:r+"")in this?Object.defineProperty(this,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):this[e]=t,this.listeners={}}}},364756:function(e,t,r){r.d(t,{withChatRefProviderContext:function(){return u}});var n=r(713738),a=r(666196),o=r(248155),l=r(788498),i=r(345660);function u(e){let t=(0,n.forwardRef)((t,r)=>{var u,s;let{children:d,className:c,style:v,...f}=t,h=(0,n.useRef)(null),C=(0,n.useRef)(null),m=(0,n.useRef)(null),p=(0,n.useRef)(null),g=(0,n.useRef)(null),S=null===(s=(0,a.useChatService)("chatConfigService"))||void 0===s?void 0:null===(u=s.localFeatureConfig)||void 0===u?void 0:u.enableMessageDebug;return(0,i.jsx)(l.ChatRefProvider,{scrollRef:h,chatInputRef:C,chatViewRef:m,chatDropTargetRef:p,chatPageTargetRef:g,children:(0,i.jsx)(o.DebugMessageProvider,{enableMessageDebug:S,children:(0,i.jsx)(e,{ref:r,className:c,style:v,...f,children:d})})})});return t.displayName=`ChatRefProviderWrapped${e.displayName||e.name}`,t}},615747:function(e,t,r){r.d(t,{ChatPage:function(){return m},ChatPageUI:function(){return f}});var n=r(713738),a=r(812650),o=r.n(a),l=r(783147),i=r(273643),u=r(604889),s=r(767231),d=r(426156),c=r(441259),v=r(345660);let f=(0,n.forwardRef)(function(e,t){let{className:r,style:a,headerClassName:l,interClassName:i,canSendFile:d,canSendImage:f,children:h,renderChatHeader:C,renderChatFooter:m}=e,{scrollRef:p,chatViewRef:g,chatInputRef:S,chatPageTargetRef:_,chatDropTargetRef:E}=(0,u.useChatRef)(),{isOver:y,divProps:b}=(0,s.useDragOver)({canSendFile:d,canSendImage:f});return(0,n.useImperativeHandle)(t,()=>({scrollRef:p,chatViewRef:g,chatInputRef:S,chatPageTargetRef:_,chatDropTargetRef:E}),[]),(0,v.jsxs)("div",{ref:_,...b,className:o()("container-pQp8GY","flex-1 min-w-0",r,{"dragover-M7nHQ1":y,"ipad-MhoeKz":(0,c.getIsIPad)()}),style:a,children:[(0,v.jsx)("div",{className:o()("header-bZwrab",l),children:null==C?void 0:C()}),(0,v.jsx)("div",{className:o()("inter-rWzItm",i),children:h({chatViewRef:g})}),(0,v.jsx)("div",{className:"footer-Wl2Pj7",children:null==m?void 0:m()}),(0,v.jsx)("div",{ref:E,className:"drop-area-UShWp0"})]})}),h=(0,n.forwardRef)(function(e,t){let{chatId:r,chatType:n}=e,a=(0,l.useBotSendFileEnabled)(null!=r?r:"",n),o=(0,l.useBotSendImageEnabled)(null!=r?r:"",n);return(0,v.jsx)(f,{ref:t,canSendFile:a,canSendImage:o,...e})}),C=(0,n.forwardRef)(function(e,t){let{chatViewConfig:r,className:n,style:a,children:o,ChatViewSlot:l,ChatHeaderSlot:u,ChatPageEmptySkeletonSlot:s,ChatInputSlot:d,...c}=e;return r?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(h,{ref:t,...r,...c,className:n,style:a,renderChatHeader:()=>u&&(0,v.jsx)(u,{...r}),renderChatFooter:()=>(0,v.jsx)(i.ChatFooter,{...r,ChatInputSlot:d}),children:e=>{let{chatViewRef:t}=e;return(0,v.jsx)(l,{ref:t,...r})}}),o]}):s&&(0,v.jsx)(s,{})}),m=(0,n.forwardRef)(function(e,t){let{ErrorFallbackSlot:r,...n}=e;return(0,v.jsx)(d.ErrorBoundary,{errorBoundaryName:"conversation_error",FallbackComponent:r,children:(0,v.jsx)(C,{ref:t,...n})})})},788498:function(e,t,r){r.d(t,{ChatProvider:function(){return u},ChatRefProvider:function(){return s}});var n=r(913821),a=r(992528),o=r(604889),l=r(460821),i=r(345660);let u=e=>{let{children:t,...r}=e,o=(0,l.useCompareMemo)(r,n.default);return(0,i.jsx)(a.ChatContext.Provider,{value:o,children:t})},s=e=>{let{children:t,...r}=e,a=(0,l.useCompareMemo)(r,n.default);return(0,i.jsx)(o.ChatRefContext.Provider,{value:a,children:t})}},651159:function(e,t,r){r.d(t,{useLocalThreadSendMessage:function(){return p},useSubscribeLocalConversationCreation:function(){return g}});var n=r(713738),a=r(743893),o=r(762707),l=r(4137),i=r(918952),u=r(101874),s=r(845647),d=r(698392),c=r(721118),v=r(230932),f=r(971857),h=r(831566),C=r(227587),m=r(856392);let p=e=>{let{chatType:t}=e,r=(0,C.useLocation)();return(e,n)=>{let l=(0,c.localConversationSelector)(v.useFeedStore.getState(),e);if(l){v.useFeedStore.getState().updateLocalConversationLocal(e,{createStatus:i.CreateConversationStatus.Creating});let d=(0,c.mainConvBotIdSelector)(v.useFeedStore.getState());return(0,a.default)(n).map(n=>{var a,i,c,v;return{...n,reportParams:{...null==n?void 0:n.reportParams,from:(null==n?void 0:null===(a=n.reportParams)||void 0===a?void 0:a.from)||"",enter_from:null==r?void 0:null===(i=r.state)||void 0===i?void 0:i.enter_from,conversation_type:u.PcchatExprConversationType.CocoWebSub},localConversationId:e,conversationId:"0",botId:d,chatType:null!=t?t:s.ChatType.NewThread,botType:"Main",extraExt:{...null==n?void 0:n.extraExt,...(null==l?void 0:null===(c=l.local)||void 0===c?void 0:c.relatedShareId)?{related_share_id:null==l?void 0:null===(v=l.local)||void 0===v?void 0:v.relatedShareId}:{},need_create_thread:"1"},reportEvents:{create_conversation_by_message:(0,m.createReportEvent)({eventName:"create_conversation_by_message",meta:{scene:"new_thread"}}),new_thread_message_full:(0,m.createReportEvent)({eventName:"new_thread_message_full",meta:{...(0,o.default)(n,["scene"]),...(0,o.default)(null==n?void 0:n.reportParams,["send_source"])}})}}})}return n}},g=e=>{let t=(0,f.useLocalConversation)(e);(0,n.useEffect)(()=>{if(t&&e)return v.useFeedStore.subscribe(t=>t.localConversationMap[e],t=>{var r,n,a,o,u,s,c,v;!(0,l.default)(t)&&((null===(r=t.local)||void 0===r?void 0:r.createStatus)===i.CreateConversationStatus.Done&&(null===(n=t.local)||void 0===n?void 0:n.newConversationId)?(null===(s=t.local)||void 0===s||null===(u=s.reportEvent)||void 0===u||u.success(),setTimeout(()=>{var r;(0,d.getChatStore)("chatViewCoreStore").setState({needSkipChatKey:e}),h.DeprecatedChatEvent.emit("chat.thread.created",{localConversationId:e,newConversationId:(null===(r=t.local)||void 0===r?void 0:r.newConversationId)||""})})):(null===(a=t.local)||void 0===a?void 0:a.createStatus)===i.CreateConversationStatus.Failed&&(null===(o=t.local)||void 0===o?void 0:o.failReason)===i.CreateConversationFailReason.ReachLimit&&(null==t||null===(v=t.local)||void 0===v||null===(c=v.reportEvent)||void 0===c||c.error({reason:"guest_reach_limit"}),setTimeout(()=>h.DeprecatedChatEvent.emit("chat.guest.login",{backToRoot:!0}))))},{fireImmediately:!0})},[t,e])}},690743:function(e,t,r){r.d(t,{useSyncChatViewConfig:function(){return u}});var n=r(713738),a=r(913821),o=r(698392),l=r(239686);let i=e=>{(0,a.default)((0,o.getChatSlice)("chatViewCoreStore").currentChatViewConfig,e)||(0,o.getChatStore)("chatViewCoreStore").setState({currentChatViewConfig:e})},u=e=>{let t=(0,n.useRef)(!1);(!t.current||(null==e?void 0:e.chatKey))&&(t.current=!0,i(e)),(0,l.default)(()=>{let t=(0,o.getChatSlice)("chatViewCoreStore").currentChatViewConfig;(null==t?void 0:t.chatId)===(null==e?void 0:e.chatId)&&(null==t?void 0:t.chatType)===(null==e?void 0:e.chatType)&&i(void 0)}),(0,n.useEffect)(()=>{i(e)},[e])}},845362:function(e,t,r){r.d(t,{chatViewMessageEventBus:function(){return n}});let n=new(r(603110)).ChatMessageLifeCycleEventBus}}]);