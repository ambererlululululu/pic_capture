"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["38122"],{191360:function(e,t,r){r.d(t,{createStorage:function(){return C},createPersistOptions:function(){return V},createDefaultPersistStorage:function(){return k}});var a=r(459735),o=r(217957),n=r(228261),s=r.n(n),u=r(178230),i=r(150010),l=r(351415);let c=0,p=(0,l.default)(()=>{u.logger.persist.info({eventName:"l1_storage_persist_count",meta:{count:c}})},1e4,{leading:!1,trailing:!0}),d=()=>{c++,p()},m=0,g=(0,l.default)(()=>{u.logger.persist.info({eventName:"l1_storage_instance_reuse_count",meta:{count:m}})},1e4,{leading:!1,trailing:!0}),f=()=>{m++,g()};var v=r(4137),S=r(519428);let h=e=>{let{storeName:t,action:r,fn:a}=e;return async function(){for(var e,o,n=arguments.length,l=Array(n),c=0;c<n;c++)l[c]=arguments[c];try{return await a.apply(null,l)}catch(l){let a=l instanceof Error?l:Error(String(l)),n={};if("undefined"!=typeof navigator&&"function"==typeof(null===(o=navigator)||void 0===o?void 0:null===(e=o.storage)||void 0===e?void 0:e.estimate)){let[{usage:e,quota:o},u,l]=await Promise.all([(0,i.getStorageQuotaInfo)(),navigator.storage.persist().catch(()=>!1),navigator.storage.persisted().catch(()=>!1)]);Object.assign(n,{usageSpace:`${null!=e?e:0} MB`,quotaSpace:`${null!=o?o:0} MB`,persist:u,persisted:l,driver:s().driver(),driverSupported:s().supports(s().driver()),errorAction:r,storeName:t,errType:a.message.includes("timeout")?"timeout":a.message})}u.logger.persist.error({eventName:"l1_storage_storePersistErrorBoundary",message:`[${t}] persist storage action error: ${r} failed`,error:a,meta:n})}}},w=e=>{let{persistStorage:t,storeName:r}=e,{getItem:a,setItem:o,removeItem:n}=t;return t.setItem=(0,l.default)(h({storeName:r,action:"setItem",fn:o}),1e3),t.getItem=h({storeName:r,action:"getItem",fn:a}),t.removeItem=h({storeName:r,action:"removeItem",fn:n}),t},y=e=>void 0!==e&&"undefined"!=typeof window,_=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"samantha-web",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["undefined-chat-voice-store"];if(!y(e))return;let a="undefined";try{for(let o of(await e.keys()))if(o.includes(a)){if(r.includes(o)){let r=await e.getItem(o);await e.setItem(o.replace(a,t),r)}e.removeItem(o)}}catch(e){}},I=null,M=()=>(I?f():I=s().createInstance({name:"samantha-web",storeName:"store"}),I);function k(e){let t="undefined"==typeof window?{getItem:()=>Promise.resolve(null),setItem:()=>Promise.resolve(null),removeItem:()=>Promise.resolve(null)}:M();return _(t),{getItem:async e=>new Promise((r,a)=>{var o;let n=(()=>{let t=setTimeout(()=>{a(Error(`getItem ${e} timeout, timeout after 10000ms`))},1e4);return()=>clearTimeout(t)})();null===(o=t.getItem(e))||void 0===o||o.then(r,a).finally(()=>{n()})}),setItem:async(r,a)=>{var o;let n=null!==(o=null==e?void 0:e(a))&&void 0!==o?o:a;await t.setItem(r,n)},removeItem:async e=>{await t.removeItem(e)}}}let C=e=>{let{filterFn:t,storageFn:r,storeName:a}=e;return(0,i.logUseage)(null!=a?a:"createStorage"),w({storeName:a||"samantha-web",persistStorage:(null==r?void 0:r())||k(t)})},V=e=>{d();let{version:t,name:r,prefix:n,storage:s,merge:i,onRehydrateStorage:l,filterFn:c,...p}=e,m=u.logger.createLoggerWith({ctx:{namespace:"persist",meta:{version:null!=t?t:"unknown",name:null!=r?r:"unknown",prefix:null!=n?n:"unknown"}}});return m.persist.info({eventName:"l1_storage_createPersistOptions",message:`[${r}] persist storage createPersistOptions`}),{name:`${n}-${e.name.replace("undefined","deprecated")}`,storage:C({storeName:r,filterFn:c,storageFn:()=>s}),version:null!=t?t:1,merge:null!=i?i:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"samantha-web-store";return(t,r)=>{try{let e=(0,v.default)(t)?{}:t;return{...(0,S.default)(r),...e}}catch(t){t instanceof Error&&u.logger.persist.error({eventName:"l1_storage_getDefaultMerge_eror",message:`[${e}], persist merge error`,error:t})}return r}}(r||"samantha-web-store"),onRehydrateStorage:l?e=>(m.persist.info({eventName:"l1_storage_custom_onRehydrateStorage",message:`[${r}] persist storage hydration enter`}),l(e)):e=>{let t=`[${r}] persist storage hydration`;return m.console.info({message:`${t} started`,meta:{state:e}}),(e,r)=>{r?m.persist.error({eventName:"l1_storage_onRehydrateStorage_error",message:`${t} error`,error:r instanceof Error?r:Error(String(r))}):m.console.info({eventName:"l1_storage_onRehydrateStorage_finish",message:`${t} finished`,meta:{state:e}})}},...(0,a.default)(p,o.default)}}},830599:function(e,t,r){r.d(t,{ChatInputModeEnum:function(){return a},SuperTaskModeEnum:function(){return o},SuperTaskModelEnum:function(){return n}});var a={Base:0,SuperTask:1},o={Simple:0,Complex:1},n={Doubao:0,Claude:1}},42869:function(e,t,r){r.d(t,{initSuperTaskStore:function(){return f},useSuperTaskStore:function(){return g},getSuperTaskStore:function(){return v}});var a=r(642220),o=r(580296),n=r(830599);let s=()=>({switchValueConvMap:{},taskModeValue:0,guidanceSwitchValue:{switchValue:n.ChatInputModeEnum.Base},overloadStatusMap:{},model:n.SuperTaskModelEnum.Doubao,taskAbConfig:{}}),u=e=>!e||e.startsWith("local"),i=e=>u(e)?"local":e,l=[n.ChatInputModeEnum.Base,n.ChatInputModeEnum.SuperTask],c=[n.SuperTaskModeEnum.Simple,n.SuperTaskModeEnum.Complex],p=(e,t)=>({...s(),isSuperTaskEnableByConvId:e=>t().getSuperTaskSwitchByConvId(e)===n.ChatInputModeEnum.SuperTask,getSuperTaskSwitchByConvId:e=>{let r=t().getStatusByConvId(e).switchValue;return l.includes(r)?r:n.ChatInputModeEnum.Base},setSuperTaskSwitchByConvId:(e,r)=>{t().setStatusByConvId(e,{switchValue:r})},getTaskModeByConvId:e=>{let r=t().getStatusByConvId(e).taskModeValue;return c.includes(r)?r:n.SuperTaskModeEnum.Simple},setTaskModeByConvId:(e,r)=>{t().setStatusByConvId(e,{taskModeValue:r})},getStatusByConvId:e=>{let{switchValueConvMap:r,taskModeValue:a,guidanceSwitchValue:o,taskAbConfig:s}=t(),l=r[i(e)],c="object"==typeof l?{...l}:{switchValue:l||n.ChatInputModeEnum.Base,taskModeValue:n.SuperTaskModeEnum.Simple};return u(e)&&(c.taskModeValue=a,!1===s.enable_guidance_switch_memo&&(c.switchValue=o.switchValue||n.ChatInputModeEnum.Base)),c},setStatusByConvId:(r,a)=>{let{switchValueConvMap:o,getStatusByConvId:n,taskModeValue:s,guidanceSwitchValue:l,taskAbConfig:c}=t(),p=(null==c?void 0:c.enable_guidance_switch_memo)===!1&&u(r)?{}:{[i(r)]:{...n(r),...a,lastUpdate:Date.now()}};e({switchValueConvMap:{...o,...p},taskModeValue:u(r)&&void 0!==a.taskModeValue?a.taskModeValue:s,guidanceSwitchValue:u(r)&&void 0!==a.switchValue?{localChatId:r,switchValue:a.switchValue}:l})},updateOverloadMessageToastMap:(r,a)=>{let o=t().overloadStatusMap;!1!==o[r]&&e({overloadStatusMap:{...o,[r]:a}})},setSuperTaskAbConfig:t=>{e({taskAbConfig:t})}});var d=r(198827);let m=()=>(0,o.create)()((0,a.persist)(p,(0,d.getPersistStorageOptions)())),g=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return g.prototype._useSuperTaskStore||f(),g.prototype._useSuperTaskStore(...t)};function f(){let{_useSuperTaskStore:e}=g.prototype||{};if(!e){let e=m();Object.setPrototypeOf(g.prototype,e),Object.defineProperties(g,{...Object.getOwnPropertyDescriptors(e)}),g.prototype._useSuperTaskStore=e}}let v=function(){return g.prototype._useSuperTaskStore||f(),g.prototype._useSuperTaskStore}},198827:function(e,t,r){let a;r.d(t,{getPersistStorageOptions:function(){return i},getPersistStorageState:function(){return u}});var o=r(191360),n=r(178230);let s=e=>{try{return{switchValueConvMap:e.switchValueConvMap||{},guidanceViewShown:e.guidanceViewShown||!1}}catch(e){return n.logger.persist.error({message:"[@super-task-store] persist state limit error",error:e instanceof Error?e:Error(String(e))}),{}}},u=async()=>{let{storage:e,name:t}=i(),r=await (null==e?void 0:e.getItem(t));return null==r?void 0:r.state},i=()=>{if(!a){let e=(0,o.createDefaultPersistStorage)(),t=e.setItem;e.setItem=async(e,r)=>{let a=await u();Object.entries((null==a?void 0:a.switchValueConvMap)||{}).forEach(e=>{let[t,a]=e;r.state.switchValueConvMap=r.state.switchValueConvMap||{};let o=r.state.switchValueConvMap[t];(void 0===o||"object"==typeof o&&"object"==typeof a&&o.lastUpdate&&a.lastUpdate&&o.lastUpdate<a.lastUpdate)&&(r.state.switchValueConvMap[t]=a)}),Object.entries(r.state.switchValueConvMap||{}).forEach(e=>{let[t,a]=e;if("object"==typeof a&&a.markDelete){var o;null===(o=r.state.switchValueConvMap)||void 0===o||delete o[t]}}),t(e,r)},a=(0,o.createPersistOptions)({name:"super-task-store",prefix:"samantha-web",partialize:s,version:1.5,storage:e})}return a}}}]);