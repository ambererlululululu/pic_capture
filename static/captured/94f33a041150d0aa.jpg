"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["83519"],{671940:function(e,t,i){i.d(t,{default:function(){return n}}),i(713738);var r=i(430261),a=i(345660),n=(0,r.IconFactory)((0,a.jsx)(e=>(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24",...e,children:(0,a.jsx)("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.035 15.956a1.29 1.29 0 0 0 1.821-.004l6.911-6.911a3.15 3.15 0 0 0 0-4.457l-.034-.034a3.15 3.15 0 0 0-4.456 0l-7.235 7.234a5.031 5.031 0 0 0 7.115 7.115l6.577-6.577a1.035 1.035 0 0 1 1.463 1.464l-6.576 6.577A7.1 7.1 0 0 1 4.579 10.32l7.235-7.234a5.22 5.22 0 0 1 7.382 0l.034.034a5.22 5.22 0 0 1 0 7.383l-6.91 6.91a3.36 3.36 0 0 1-4.741.012l-.006-.005-.012-.011a3.346 3.346 0 0 1 0-4.732L12.76 7.48a1.035 1.035 0 0 1 1.464 1.463l-5.198 5.198a1.277 1.277 0 0 0 0 1.805z",clipRule:"evenodd"})}),{}))},548203:function(e,t,i){i.d(t,{fetchAISpaceHomepageData:function(){return _},fetchAISpaceNodeInfo:function(){return p},fetchAISpaceShareHistory:function(){return m},fetchAISpaceShareNodeInfo:function(){return f},fetchLatestUsing:function(){return S},fetchfetchAISpaceSearchData:function(){return v},handleAiSpaceApiErrorToast:function(){return g}});var r=i(217957),a=i(229079),n=i(231976),l=i(910214),o=i(177048),s=i(769783),c=i(47563),u=i(178230);function d(e){var t;if(!e)return!1;let{node_type:i}=e||{},a=null===(t=e.content)||void 0===t?void 0:t.directory_type;return!(0,r.default)(a)&&i===n.NodeType.Directory&&a!==n.DirectoryType.Default}async function p(e){let t;try{let{data:i}=await l.samanthaApiService.AISpaceNodeInfo(e);if(!i)return Promise.reject(Error("FetchNodeInfoApiDataNotFound"));let{children:r}=i;i.children=null==r?void 0:r.filter(e=>!d(e)),t=i}catch(e){return u.logger.persist.error({message:"FetchNodeInfoApiError",error:e}),Promise.reject(e)}return t}async function _(e){let t;try{let{data:i}=await l.samanthaApiService.AISpaceHomepage(e);if(!i)return Promise.reject(Error("FetchAISpaceHomepageDataApiDataNotFound"));let{children:r}=i;i.children=null==r?void 0:r.filter(e=>!d(e)),t=i}catch(e){return u.logger.persist.error({message:"FetchNodeInfoApiError",error:e}),Promise.reject(e)}return t}async function f(e){let t;try{let{data:i}=await l.samanthaApiService.AISpaceShareNodeInfo(e);if(!i)return Promise.reject(Error("FetchNodeInfoApiDataNotFound"));t=i}catch(e){return u.logger.persist.error({message:"FetchNodeInfoApiError",error:e}),Promise.reject(e)}return t}async function m(e){try{let{data:t}=await l.samanthaApiService.AISpaceShareHistory(e);if(!t)throw Error("FetchAISpaceShareHistoryDataNotFound");return t}catch(e){throw u.logger.persist.error({message:"FetchAISpaceShareHistoryApiError",error:e}),e}}let h={[o.ErrorCodes.AI_SPACE_NODE_COUNT_EXCEED_ERROR]:"aispace_operation_failed_exceeds_file_number_limit_of_folder",[o.ErrorCodes.AI_SPACE_TREE_DEPTH_EXCEED_ERROR]:"aispace_current_directory_cannot_add_more_subfolders",[o.ErrorCodes.AI_SPACE_NODE_SIZE_EXCEED_ERROR]:"aispace_exceeds_maximum_single_file_size_of_100M",[o.ErrorCodes.AI_SPACE_STORAGE_EXCEED_ERROR]:"aispace_cannot_upload_exceeds_space_capacity_limit",[o.ErrorCodes.AI_SPACE_NODE_NOT_EXIST_ERROR]:"aispace_node_does_not_exist",[o.ErrorCodes.AI_SPACE_NODE_UNDER_REVIEW_ERROR]:"aispace_content_reviewing_visitor"},g=e=>{let{t,error:i,defaultTip:r}=e;if((0,s.isApiError)(i)){let{code:e}=i.errorOption,{msg:r}=i.errorOption.response||{};if(String(e)===String(o.ErrorCodes.SECURITY_RESOURCE_REJECTED)&&r&&"string"==typeof r){c.SamanthaToast.error(r);return}let n=e&&(0,a.default)(h,e);if(n)return c.SamanthaToast.error(t(n))}if(r)return c.SamanthaToast.error(r)},v=async e=>{let t;try{let{data:i}=await l.samanthaApiService.AISpaceAttachmentSearch(e);if(!i)return Promise.reject(Error("FetchAISpaceSearchDataApiDataNotFound"));t=i}catch(e){return u.logger.persist.error({message:"FetchAISpaceSearchDataApiError",error:e}),Promise.reject(e)}return t},S=async e=>{let t,{fileTypes:i,limit:r}=e;try{let{data:e}=await l.samanthaApiService.AISpaceAttachmentLatestUsed({file_types:i,limit:r});if(!e)return Promise.reject(Error("FetchAISpaceLatestUsingApiDataNotFound"));t=e}catch(e){return u.logger.persist.error({message:"FetchLatestUsingApiError",error:e}),Promise.reject(e)}return t}},397358:function(e,t,i){i.d(t,{fetchUrlByUriWithCache:function(){return l}});var r=i(762707),a=i(910214);let n={};async function l(e,t){if(!e.length)return;let i=e.filter(e=>!n[e]);if(null==i?void 0:i.length){var l;let{data:e}=await a.resourceApiService.GetFileURL({uris:i,type:t});null==e||null===(l=e.file_urls)||void 0===l||l.forEach(e=>{let{main_url:t,back_url:i,uri:r}=e,a=t||i;r&&a&&(n[r]=a)})}return(0,r.default)(n,e)}},663292:function(e,t,i){i.d(t,{AISpaceForInputPopoverContent:function(){return y}});var r=i(816651),a=i(557298),n=i(713738),l=i(812650),o=i.n(l),s=i(915299),c=i(712980),u=i(48766),d=i(640380),p=i(227587),_=i(41207),f=i(837485),m=i(548203),h=i(568985),g=i.p+"static/image/guide.1814be5b.png",v=i(345660);let S=e=>(0,v.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:12,height:13,fill:"none",viewBox:"0 0 12 13",...e,children:[(0,v.jsx)("path",{fill:"url(#arrow_svg__a)",fillRule:"evenodd",d:"M6.396 2.205a.5.5 0 0 1 .708 0l3.75 3.75a.5.5 0 0 1 0 .707l-3.75 3.75a.5.5 0 1 1-.708-.707l2.897-2.896H1.5a.5.5 0 1 1 0-1h7.793L6.396 2.912a.5.5 0 0 1 0-.707",clipRule:"evenodd"}),(0,v.jsx)("defs",{children:(0,v.jsxs)("linearGradient",{id:"arrow_svg__a",x1:11,x2:-.474,y1:10.559,y2:7.378,gradientUnits:"userSpaceOnUse",children:[(0,v.jsx)("stop",{stopColor:"#35A8FF"}),(0,v.jsx)("stop",{offset:1,stopColor:"#4373FF"})]})})]});function E(e){let{onNavigateToAISpace:t}=e,i=(0,d.useNavigate)(),r=(0,p.useLocation)(),n="undefined"!=typeof window&&r.pathname===window.location.pathname,l=(0,s.useTranslateFn)();return(0,v.jsxs)("div",{className:"ai-space-guide-wrapper-fxHG4E",children:[(0,v.jsx)("img",{src:(0,a.filterUrlModule)(g,null,{logType:"js.href/src",reportOnly:"false",blackConfig:"{}",configMode:"merge",isCloseSSRReport:!1,bid:"flow_web",region:"cn",urlLimit:"-1",htmlLimit:"-1",isSaveValidUrl:!1,isRuntimeLog:!1,isDOMParser:!0,escapeRule:"escape-report",reportUrl:"https://mon.zijieapi.com/monitor_browser/collect/batch/security/?bid=flow_web",scmBranch:"release_train_samantha_2025-10-14_552097",scmName:"$20xN*Rt%j$P$E5h$jBsMldr-z$N$mx0%m5aWldFcH$aRmhO%FE9PQ",scmVersion:"1.0.5.6233",webpackPluginVersion:"3.4.5",filename:"$ERJNWQy%kRP$EJo$jJSc1kyaz$hb%l5T$hkaF-zaHNXRE5D-%dSSFozWmpNMHBx$ERKT2RscEhWWFZa-m13d1dsZFJk$0l6%201T%1scHpZak5qZ*xwd*$IWmtl$E$6$2xkSmRHSlhPWFZpTTBwc1kw-zRkb%5I%m1waE1rWn$Xb*hOZ*xSR$R-%lNi$lpvWk$o$2$WcFRPWHBo%jBaN$dsZFJkb*x--TNSak0wSm9X$EpWZEZre%9-b*F$emw2WTIxTmRscElTbkJr-lZWMFdtMXNjMXB%T$hw-$-zaHNX$E5TZ*1OcE9Xc*lNak-zWWpJMWJHSn$$bnBNTTBKMlkw-z$NbHBZ%1hSWk1qbDFaRWRXZFdSRE9-Qmli$kpzWl$NM%1HTXphR2hq-ldReFkz-zlQ%T09"}),className:"ai-space-guide-pic-xhaN5x"}),(0,v.jsx)("div",{className:"ai-space-guide-title-rlBqOT",children:l("aispace_addMenu_sectionHeader")}),(0,v.jsx)("div",{className:"ai-space-guide-subtitle-iUqj3N",children:l("aispace_addMenu_sectionDesc")}),(0,v.jsx)("div",{className:"ai-space-guide-button-ZTdTHA",children:(0,v.jsxs)("span",{className:"guide-button-text-wrapper-iZdAzK",onClick:()=>{let e="chatbox_attachment_onboarding";n?i("/chat/drive",{state:{enter_from:e}}):"undefined"!=typeof window&&window.location.assign((0,a.filterUrlModule)((0,c.toURL)(`${window.location.origin}/chat/drive/`,{from:e}),null,{logType:"js.window.location",reportOnly:"false",blackConfig:"{}",configMode:"merge",isCloseSSRReport:!1,bid:"flow_web",region:"cn",urlLimit:"-1",htmlLimit:"-1",isSaveValidUrl:!1,isRuntimeLog:!1,isDOMParser:!0,escapeRule:"escape-report",reportUrl:"https://mon.zijieapi.com/monitor_browser/collect/batch/security/?bid=flow_web",scmBranch:"release_train_samantha_2025-10-14_552097",scmName:"$20xN*Rt%j$P$E5h$jBsMldr-z$N$mx0%m5aWldFcH$aRmhO%FE9PQ",scmVersion:"1.0.5.6233",webpackPluginVersion:"3.4.5",filename:"$ERJNWQy%kRP$EJo$jJSc1kyaz$hb%l5T$hkaF-zaHNXRE5D-%dSSFozWmpNMHBx$ERKT2RscEhWWFZa-m13d1dsZFJk$0l6%201T%1scHpZak5qZ*xwd*$IWmtl$E$6$2xkSmRHSlhPWFZpTTBwc1kw-zRkb%5I%m1waE1rWn$Xb*hOZ*xSR$R-%lNi$lpvWk$o$2$WcFRPWHBo%jBaN$dsZFJkb*x--TNSak0wSm9X$EpWZEZre%9-b*F$emw2WTIxTmRscElTbkJr-lZWMFdtMXNjMXB%T$hw-$-zaHNX$E5TZ*1OcE9Xc*lNak-zWWpJMWJHSn$$bnBNTTBKMlkw-z$NbHBZ%1hSWk1qbDFaRWRXZFdSRE9-Qmli$kpzWl$NM%1HTXphR2hq-ldReFkz-zlQ%T09"})),null==t||t()},children:[(0,v.jsx)("span",{className:"ai-space-button-text-XeUq7q",children:l("aispace_addMenu_linkText_upload")}),(0,v.jsx)(S,{className:"text-12"})]})}),(0,v.jsx)("div",{className:"w-full flex-1"})]})}let y=e=>{let{titleClassName:t,itemClassName:i,fileTitleClassName:a,title:l,onOpenFileListModal:c,onNavigateToAISpace:d,onAddFileToAttachment:p,fileTypes:g,latestFileCount:S,onDataLoaded:y,onOverrideClickFile:w}=e,F=(0,s.useTranslateFn)(),[x,N]=(0,n.useState)([]),[T,I]=(0,n.useState)(!1),A=(0,_.useAddAISpaceFileInAttachment)(),k=null!=w?w:A;if((0,n.useEffect)(()=>{I(!0),(0,m.fetchLatestUsing)({fileTypes:g.map(e=>`.${e}`),limit:S||5}).then(e=>{var t;let i=null==e?void 0:null===(t=e.nodes)||void 0===t?void 0:t.map(e=>{let t=(0,f.transformRemoteNodeInfoToLocal)(e);return t?{fileInfo:(0,f.transformNodeInfoIntoFileInfo)(t),nodeInfo:t}:null}).filter(Boolean);(null==i?void 0:i.length)&&N(i)}).finally(()=>{I(!1),null==y||y()})},[]),!(null==x?void 0:x.length)&&!T)return(0,v.jsx)(E,{onNavigateToAISpace:d});let R=(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:t,children:null!=l?l:F("aispace_addMenu_sectionHeader_space")}),T?(0,v.jsx)("div",{className:"flex h-104 w-full items-center justify-center",children:(0,v.jsx)(u.default,{})}):(0,v.jsxs)(v.Fragment,{children:[x.map((e,t)=>{let{name:r}=e.fileInfo;return(0,v.jsxs)("div",{className:i,onClick:()=>k([e.nodeInfo],()=>null==p?void 0:p(e.nodeInfo)),children:[(0,v.jsx)("div",{className:`
                    flex h-20 w-20 flex-shrink-0 items-center justify-center overflow-hidden
                  `,children:(0,v.jsx)(h.AISpaceFileIcon,{file:e.fileInfo,className:"text-20"})}),(0,v.jsx)("span",{className:o()("text-ellipsis whitespace-nowrap overflow-hidden",a),children:r})]},t)}),(0,v.jsxs)("div",{className:i,onClick:()=>c(),children:[(0,v.jsx)("div",{className:"flex h-20 w-20 items-center justify-center overflow-hidden",children:(0,v.jsx)(r.default,{className:"text-16"})}),F("aispace_addMenu_option_moreFile")]})]})]});return(0,v.jsx)(v.Fragment,{children:R})}},41207:function(e,t,i){i.d(t,{useAddAISpaceFileInAttachment:function(){return m}});var r=i(713738),a=i(865607),n=i(845322),l=i(746167),o=i(666196),s=i(698392),c=i(761835),u=i(785926),d=i(230932),p=i(334312),_=i(231976),f=i(397358);function m(){let[e]=(0,r.useState)(Date.now()),t=(0,o.useChatService)("chatTeaService"),{chatId:i,chatType:m}=(0,s.useChatSlice)("chatViewCoreStore",e=>{var t,i;return{chatId:null===(t=e.currentChatViewConfig)||void 0===t?void 0:t.chatId,chatType:null===(i=e.currentChatViewConfig)||void 0===i?void 0:i.chatType}},a.shallow),h=(0,s.useChatSlice)("chatInputStore",e=>i?e.activeSkillTypeMap[i]:void 0),{addAttachmentDirectly:g}=(0,c.useAttachmentActions)({chatId:null!=i?i:"",skillType:h}),v=(0,n.useFilterValidUploadFilesInSamanthaBot)(!0,!0);return async(r,a)=>{if(!(null==r?void 0:r.length))return;let n=r.map(e=>{let t=null==e?void 0:e.nodeType,i="";switch(t){case _.NodeType.File:i="file";break;case _.NodeType.Image:i="image";break;case _.NodeType.Link:i="link";break;case _.NodeType.UnKnown:default:i=""}if(i&&(null==e?void 0:e.key))return{type:i,...e}}).filter(Boolean),o=(0,c.getAttachmentStates)({chatId:null!=i?i:""}),s={conversation_id:i,conversation_type:(0,u.conversationTypeByIdSelector)(d.useFeedStore.getState(),i)||1,module_actionid:e,chat_type:m,skill_name:(0,p.getSkillTeaNameByType)(h),skill_id:String(h),duration:"0",upload_way:"input_ai_space",upload_collection_way:n.length+o.length>1?"multi":"single",collection_id:"",upload_token_length:"",upload_from:l.ChatTeaUploadFrom.UPLOAD_FROM_DRIVE},S={},E=[],y=!1;n.forEach(e=>{if(!e)return;let{id:t,type:i,size:r,name:a}=e;if(S[t]=e,i&&"link"!==i){let e={size:r?Number(r):0,name:a,type:i,id:t};E.push(e)}else"link"===i&&(y=!0)});let w=(await v(E,o,{trackParams:s,hasLink:y})).map(e=>e.id),F=n.filter(e=>{var t;return!!((null==e?void 0:e.nodeType)===_.NodeType.Link||w.includes(null!==(t=null==e?void 0:e.id)&&void 0!==t?t:""))});if(!(null==F?void 0:F.length))return;let x=F.filter(e=>(null==e?void 0:e.type)==="image").map(e=>null==e?void 0:e.key).filter(Boolean),N=await (0,f.fetchUrlByUriWithCache)(x,"image");F.forEach(e=>{e&&(g({type:null==e?void 0:e.type,fileName:null==e?void 0:e.name,from:"ai-space",fileKey:null==e?void 0:e.key,size:(null==e?void 0:e.size)?Number(null==e?void 0:e.size):0,blobUrl:(null==e?void 0:e.key)&&(null==e?void 0:e.type)==="image"?null==N?void 0:N[null==e?void 0:e.key]:void 0,url:(null==e?void 0:e.type)==="link"?null==e?void 0:e.key:void 0}),null==t||t.trackEvent("upload_status",{...s,upload_type:null==e?void 0:e.type,status:1,collection_id:null==e?void 0:e.key}))}),null==a||a()}}},547338:function(e,t,i){i.d(t,{useUploadSupportedFileTypesInSamantha:function(){return l}});var r=i(18244),a=i(949932),n=i(345698);function l(e){let t=(0,n.useUploadImageFeature)(),{supportedCodeFileTypesInFree:i}=(0,r.useSupportCommonCodeTypes)();return(e||(i=[]),t)?[...a.allowedExtensions,...i,"png","jpeg","jpg","webp"]:[...a.allowedExtensions,...i]}},845322:function(e,t,i){i.d(t,{useFilterValidUploadCodeFiles:function(){return T},useFilterValidUploadFilesInSamanthaBot:function(){return N},useValidateUploadFilesInSamanthaBot:function(){return x}});var r=i(713738),a=i(453157),n=i(214071),l=i(666196),o=i(698392),s=i(300841),c=i(761835),u=i(212183),d=i(971857),p=i(631122),_=i(645298),f=i(204454),m=i(18244),h=i(777422),g=i(915299),v=i(949932),S=i(249254),E=i(296493),y=i(345698),w=i(547338);let F=e=>{var t;return!!e&&(null==e?void 0:null===(t=e.type)||void 0===t?void 0:t.indexOf("image"))!==-1};function x(e,t){var i;let r=(0,g.useTranslateFn)(),a=(0,y.useUploadImageFeature)(),{clearAttachments:o}=(0,c.useAttachmentActions)({chatId:null!=e?e:""}),s=(0,p.useToast)(),u=(0,l.useChatService)("chatConfigService"),{loginSource:d}=null!==(i=null==u?void 0:u.chatReportParams)&&void 0!==i?i:{};return(e,i,l)=>{let{maxFileCount:c,maxImageCount:u,enableImageVlm:p,trackParams:f,hasLink:m}=l;if((0,n.default)(e))return!1;let g=i.some(e=>"link"===e.type)||m,E=i.some(e=>"directory"===e.type);if(!a&&e.length+i.length>_.MAX_IMG_COUNT&&(e.find(e=>F(e))||i.find(e=>"image"===e.type)))return e.find(e=>!F(e))||i.find(e=>"image"!==e.type)?s.warning(r("multi_upload_toast_mixedtype")):s.warning(r("image_upload_toast_maxNum",{s_number:_.MAX_IMG_COUNT})),!1;if(e.length+i.length>c)return s.error(r("file_token_limit",{postProcess:"sprintf",sprintf:["\u8C46\u5305",c.toString()]})),e.forEach(e=>{(0,h.trackEvent)("upload_status",{...f,status:"0",error_code:"over_file_numberlimit",collection_name:e.name,upload_type:F(e)?"pic":"pdf",upload_file_type:(0,v.getFileType)((0,v.getFileExt)((0,S.pickAsString)("name")(e))),upload_file_size:String(e.size),...d?{previous_page:d}:{}})}),!1;if(p){let t=e.filter(F),a=i.filter(e=>{let{type:t}=e;return"image"===t});if(t.length+a.length>u)return s.error(r("image_upload_toast_maxNum",{s_number:u})),e.forEach(e=>{(0,h.trackEvent)("upload_status",{...f,status:"0",error_code:"over_image_numberlimit",collection_name:e.name,upload_type:F(e)?"pic":"pdf",upload_file_type:(0,v.getFileType)((0,v.getFileExt)((0,S.pickAsString)("name")(e))),upload_file_size:String(e.size)})}),!1}if(g){if(!t)return s.warning(r("skill_pdf_error_exclusive")),!1;null==o||o({})}if(E){if(!t)return s.warning(r("skill_pdf_error_exclusive")),!1;null==o||o({})}return!0}}function N(e,t){let i=(0,g.useTranslateFn)(),n=(0,p.useToast)(),{chatId:l,chatType:_}=(0,o.useChatSlice)("chatViewCoreStore",e=>{var t,i;return{chatId:null===(t=e.currentChatViewConfig)||void 0===t?void 0:t.chatId,chatType:null===(i=e.currentChatViewConfig)||void 0===i?void 0:i.chatType}},a.shallow),m=(0,u.getBotIdByConversationId)(l),y=x(l,t),N=T(),I=(0,d.useIsSamantha)(l||"",_),A=(0,w.useUploadSupportedFileTypesInSamantha)(e),{uploadFileAllowedTypes:k,uploadFileMaxSize:R,enabledSendMultiFileMessage:$,enableImageVlm:b,uploadMultiEntityConf:{maxFileCount:C,maxFileSize:j,maxImageCount:z,maxImageSize:W}}=(0,c.useAttachmentUploadConfig)(),B=(0,r.useMemo)(()=>I?A:(0,s.isLongCtxBot)(m)?v.SupportedFileExtsInLongCtxBot:k,[I,A,m,k]),P=$||f.isBetaEnv,U=I&&P?j:Number(R),D=(0,r.useMemo)(()=>I&&P||(0,s.isLongCtxBot)(m)?null!=C?C:50:C?1:50,[I,P,m,C]),M=(0,r.useCallback)(e=>{let t=(0,v.getFileExt)(e.name);return B.includes(t)},[B]);return async(e,t,r)=>{let{trackParams:a,hasLink:l}=r;if(!y(e,t,{maxFileCount:D,maxImageCount:z,trackParams:a,enableImageVlm:b,hasLink:l}))return[];let o=e.filter(e=>!M(e)),s=e.filter(e=>!o.includes(e)),c=s.filter(e=>b&&F(e)?e.size>W:e.size>U),u=s.filter(e=>!c.includes(e));if(o.forEach(e=>{n.error(i("read_file_type_error",{postProcess:"sprintf",sprintf:[e.name]}))}),c.forEach(e=>{let t=b&&F(e)?W:U;n.error(i("file_size_over_limit",{postProcess:"sprintf",sprintf:[e.name,(0,E.convertBytes)(t)]}))}),c.forEach(e=>{(0,h.trackEvent)("upload_status",{...a,status:"0",error_code:b&&F(e)?`image_is_over_${W}`:"file_is_over_50mb",collection_name:e.name,upload_type:F(e)?"pic":"pdf",upload_file_type:(0,v.getFileType)((0,v.getFileExt)((0,S.pickAsString)("name")(e))),upload_file_size:String(e.size)})}),!I)return u;{let{filterFileList:e}=await N({fileList:u,attachmentStates:t,toastImmediately:!0,isFree:!0});return e}}}let T=()=>{let e=(0,g.useTranslateFn)(),t=(0,p.useToast)();return async i=>{let{fileList:r,attachmentStates:a,toastImmediately:n=!1,isFree:l=!1,trackParams:o}=i,s=[],c=[],u=[],d=[],p=[],_={abort:!1,warningList:d,filterFileList:[],errorList:p};if(await (0,m.preloadCodeFileExtList)(),r=r.filter(e=>{let t;if(!(t=l?(0,m.assertCodeFileSyncInFree)(e.name):(0,m.assertCodeFileSync)(e.name))&&l)return!0;let i=!0;return t?e.size<=0?(i=!1,o&&(0,h.trackEvent)("upload_status",{...o,status:"0",error_code:"empty_file",collection_name:e.name,upload_file_type:(0,v.getFileType)((0,v.getFileExt)((0,S.pickAsString)("name")(e))),upload_file_size:String(e.size)}),c.push(e)):e.size>204800&&(i=!1,o&&(0,h.trackEvent)("upload_status",{...o,status:"0",error_code:"file_is_over_200kb",collection_name:e.name,upload_file_type:(0,v.getFileType)((0,v.getFileExt)((0,S.pickAsString)("name")(e))),upload_file_size:String(e.size)}),u.push(e)):(s.push(e),i=!1),i}),null==s?void 0:s.length){let i=s.length>1?e("cici_web_ai_coding_file_type_limit_multiple",{postProcess:"sprintf",sprintf:[s[0].name,s.length]}):e("cici_web_ai_coding_file_type_limit_single",{postProcess:"sprintf",sprintf:[s[0].name]});d.push(i),n&&t.warning(i)}if(c.length>0){let i=1===c.length?e("cici_web_ai_coding_file_null_limit",{postProcess:"sprintf",sprintf:[c[0].name]}):e("cici_web_ai_coding_file_null_limit_mutiple",{postProcess:"sprintf",sprintf:[c[0].name,c.length]});d.push(i),n&&t.warning(i)}if(r.length+a.length>50){let i=e("cici_web_ai_coding_file_num_limit");t.error(i),p.push(i),_.abort=!0}if(1===u.length){let i=e("cici_web_ai_coding_file_size_limit_single");d.push(i),n&&t.warning(i)}if(u.length>1){let i=u.length>1?e("cici_web_ai_coding_file_size_limit_multiple",{postProcess:"sprintf",sprintf:[u[0].name,u.length]}):`${u[0].name}${e("cici_web_ai_coding_file_size_limit_single")}`;d.push(i),t.warning(i)}return r.length||(_.abort=!0),_.filterFileList=r,_}}}}]);