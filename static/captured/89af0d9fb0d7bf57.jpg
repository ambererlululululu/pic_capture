"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["39335"],{950810:function(e,l,t){let i;t.d(l,{VideoCardWithPlayer:function(){return H}});var r,n=t(828438),o=t(713738),a=t(95569),d=t(996406),u=t(576931),s=t(233486),c=t(788427),v=t(990064),p=t(177786),f=t(723306),_=t(656568),m=t(806767),h=t(716840),g=t(741906),y=t(529525),w=t(351415),x=t(812650),S=t.n(x),b=t(441259),P=t(326878),T=t(147899),j=t(38848),V=t(996776),A=t(398356),E=t(698115);let C=((r={}).VideoPlay="video_play",r.VideoPlayFinish="video_play_finish",r.VideoPlayTime="video_play_time",r.SwipeVideo="swipe_video",r.VideoVolumeChange="video_volume_change",r.VideoPlaySpeedChange="video_play_speed_change",r.VideoPause="video_pause",r);var N=t(345660);let k=e=>(0,N.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:22,height:22,fill:"currentColor",viewBox:"0 0 22 22",...e,children:(0,N.jsx)("path",{d:"m4.343 13.555 6.026-6.159A.86.86 0 0 1 11 7.114q.174 0 .332.074.158.067.282.208l6.035 6.16q.24.24.24.589 0 .223-.107.415a.8.8 0 0 1-.3.29.8.8 0 0 1-.414.108.81.81 0 0 1-.598-.24L10.593 8.69h.805l-5.885 6.026a.78.78 0 0 1-.59.241.85.85 0 0 1-.423-.108.8.8 0 0 1-.29-.29.83.83 0 0 1-.108-.415q0-.183.066-.324a1 1 0 0 1 .175-.266"})}),R=e=>(0,N.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:22,height:22,fill:"currentColor",viewBox:"0 0 22 22",...e,children:(0,N.jsx)("path",{d:"M11 15.58a.89.89 0 0 1-.63-.273L4.342 9.139a1 1 0 0 1-.175-.257.8.8 0 0 1-.066-.324.8.8 0 0 1 .108-.415.8.8 0 0 1 .29-.299.85.85 0 0 1 .424-.108.82.82 0 0 1 .59.241l5.884 6.026h-.805l5.877-6.026a.87.87 0 0 1 .598-.24.8.8 0 0 1 .415.107.8.8 0 0 1 .299.3.8.8 0 0 1 .108.414.8.8 0 0 1-.241.581l-6.035 6.16a.9.9 0 0 1-.282.215.85.85 0 0 1-.332.067"})}),D=e=>(0,N.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:17,height:17,fill:"none",viewBox:"0 0 17 17",...e,children:[(0,N.jsx)("g",{clipPath:"url(#loading_svg__a)",children:(0,N.jsx)("path",{stroke:"url(#loading_svg__b)",strokeLinecap:"round",strokeWidth:1.778,d:"M15.61 8.5A7.111 7.111 0 0 0 2.097 5.405"})}),(0,N.jsxs)("defs",{children:[(0,N.jsxs)("linearGradient",{id:"loading_svg__b",x1:2.096,x2:15.611,y1:8.5,y2:8.5,gradientUnits:"userSpaceOnUse",children:[(0,N.jsx)("stop",{stopColor:"#fff",stopOpacity:0}),(0,N.jsx)("stop",{offset:.399,stopColor:"#fff",stopOpacity:.5}),(0,N.jsx)("stop",{offset:1,stopColor:"#fff"})]}),(0,N.jsx)("clipPath",{id:"loading_svg__a",children:(0,N.jsx)("path",{fill:"#fff",d:"M.5.5h16v16H.5z"})})]})]}),L=[{LANG:"zh",TEXT:{MEDIA_ERR_SRC_NOT_SUPPORTED:"\u4E0D\u652F\u6301\u7684\u97F3\u9891/\u89C6\u9891\u683C\u5F0F \u6216 \u8BBE\u5907\u65E0\u7F51\u7EDC"}}],U=null,O=()=>(U||(U=E.Mp4Preloader.registerPreloader({preloadTime:5,segmentMinDuration:5,preloadCacheType:0,preloadMaxCacheCount:5,isOpenPreload:!0,minBufferLength:5,reqOptions:{credentials:"include"}},null)),U);t(91010);var M=t(740391),F={modal:"modal-xSd0bZ","video-info":"video-info-yfPit6",name:"name-OJQ7II",captions:"captions-VRCXni","play-btn-wrapper":"play-btn-wrapper-hS_Q3o","play-btn":"play-btn-FlrRku","play-btn-disabled":"play-btn-disabled-h5qJNn",loading:"loading-fOEUSp","loading-icon":"loading-icon-mBEbU7"};let I=async()=>{if(i)return i;let e=await (0,M.fetchBasePlayerResource)();return i=e.BaseXgPlayer,e.I18N.extend(L),i},q=s.ToastFactory.create({getPopupContainer:()=>document.querySelector(".play-wrapper")}),B=e=>{let{showList:l,setShowListList:t,onVideoPlay:r,videoParams:n,setOpen:d,open:u,limitSize:s,onTrackEvent:c,currentPlay:v}=e,x=(0,o.useRef)([]),{current:L}=(0,o.useRef)({isScroll:!0,scrollTime:null,timer:null,interval:1e3,distance:20,delay:1e3}),[U,M]=(0,o.useState)(0),[B,H]=(0,o.useState)(0),[z,Y]=(0,o.useState)(""),[G,$]=(0,o.useState)({offset:10,hasMore:!0}),[K,X]=(0,o.useState)(!1),[J,Q]=(0,o.useState)(0),[W,Z]=(0,o.useState)(250),[ee,el]=(0,o.useState)(!1),[et,ei]=(0,o.useState)(!0),er=O(),en=(0,b.getIsIPhoneOrIPad)(),eo=(0,o.useRef)(0),ea=(0,o.useRef)(-1),ed=(0,o.useRef)(""),eu=(0,o.useRef)(""),es=(0,o.useRef)(0),ec=(0,o.useRef)(et),ev=(0,o.useRef)("others"),ep=e=>l.findIndex(l=>l.vid===e),ef=(e,l,t)=>{null==c||c(e,{position:ea.current,is_inner_video:ep(l)===ea.current?"0":"1",channel_id:"414",group_type:"video",video_id:l,...t})},e_=async e=>{let{offset:i=0,init:o=!1}=e;if(r&&!K){if(o)$({offset:(null==n?void 0:n.offset)||s,hasMore:(null==n?void 0:n.has_more)||!1}),(null==n?void 0:n.has_more)&&e_({offset:n.offset}),setTimeout(()=>{var e,t;eb();let i=l.findIndex(e=>e.item_id===v);-1===i&&(i=0),M(i),ea.current=i,ex(i);let r=em({url:null===(e=l[i])||void 0===e?void 0:e.media_url,vid:null===(t=l[i])||void 0===t?void 0:t.vid},i,!0);eT(r),null==r||r.setUserActive(!0,en),x.current[i]=r,r.focus()},200);else{var d,u;if(!G.hasMore)return;X(!0);let e=await r({offset:i,limit:s,query:null==n?void 0:n.query,search_id:null==n?void 0:n.search_id,source_from:Number(null===(d=(0,a.default)(l))||void 0===d?void 0:d.source_from)});X(!1),(null==e?void 0:e.video_list)&&(e.video_list=null==e?void 0:null===(u=e.video_list)||void 0===u?void 0:u.map(e=>{var l;return{...e,media_url:null===(l=e.media_url)||void 0===l?void 0:l.replace(/http:\/\//,"https://")}})),t(l=>{var t;let i=o?[]:[...l],r=new Set;return i.forEach(e=>{e.item_id&&r.add(e.item_id)}),null==e||null===(t=e.video_list)||void 0===t||t.forEach(e=>{e.item_id&&!r.has(e.item_id)&&(i.push(e),r.add(e.item_id))}),i}),$({offset:(null==e?void 0:e.offset)||0,hasMore:(null==e?void 0:e.has_more)||!1})}}},em=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new i({root:document.body,el:document.querySelectorAll(".play-wrapper")[l],autoplay:t,ignores:["fullscreen","mobile"],defaultDefinition:0,width:"100%",height:"100%",lang:"zh",disableBodyTrigger:!0,plugins:[f.default,h.default,_.default,m.default,p.default,g.default,E.default],controls:{mode:"normal"},closeVideoDblclick:!0,closeVideoClick:!0,keyShortcut:!1,marginControls:!0,cssFullScreen:{target:document.body},commonStyle:{playedColor:"#ffffff",volumeColor:"#0066FF"},start:{isShowPause:!0,isShowEnd:!1,disableAnimate:!0},loop:!0,...e})},eh=e=>{let{currentTime:l}=e,t=0;l-5>=0&&(t=l-5),e.currentTime=t},eg=e=>{let{currentTime:l,duration:t}=e,i=l;i=l+5<=t?l+5:t,e.currentTime=i},ey=e=>{Math.max(-1,Math.min(1,-e.detail||-e.deltaY))>0?eS(U-1,"pre"):eS(U+1,"next")},ew=()=>new Date().getTime();(0,P.useKeyboardEvent)(!0,e=>{var l;e.preventDefault();let t=null===(l=x.current)||void 0===l?void 0:l[U];if(null==t?void 0:t.state){if("Space"===e.code)return t.paused?(null==c||c("click_video_player",{to_status:"play"}),t.play()):(null==c||c("click_video_player",{to_status:"paused"}),ef(C.VideoPause,ed.current),t.pause());"ArrowUp"===e.code&&eS(U-1,"pre"),"ArrowDown"===e.code&&eS(U+1,"next"),"ArrowLeft"===e.code&&eh(t),"ArrowRight"===e.code&&eg(t)}},[U],{event:"keydown"});let ex=e=>{Q(-(null!=e?e:U)*document.querySelectorAll(".play-wrapper")[0].clientHeight),Z(0)};(0,T.default)("wheel",e=>{let l=ew(),t=e.detail||e.deltaY;L.scrollTime&&l-L.scrollTime>L.interval&&Math.abs(t)>=L.distance&&(ey(e),L.timer&&(clearTimeout(L.timer),L.timer=null),L.isScroll=!1,L.scrollTime=l),L.isScroll&&(ey(e),L.scrollTime=ew(),L.isScroll=!1),L.timer&&clearTimeout(L.timer),L.timer=setTimeout(()=>{L.isScroll=!0},L.delay)},{passive:!1}),(0,T.default)("touchstart",e=>{var l;(null===(l=x.current[U])||void 0===l?void 0:l.state)&&H(e.changedTouches[0].clientY)},{passive:!1}),(0,T.default)("touchend",e=>{let l=e.changedTouches[0].clientY-B;H(0),!(60>=Math.abs(l))&&(l>0?eS(U-1,"pre"):l<0&&eS(U+1,"next"))},{passive:!1}),(0,T.default)("click",e=>{var l,t,i,r,n;if(z){q.destroyAll(),Y("");return}return(null==e?void 0:null===(l=e.target)||void 0===l?void 0:l.nodeName)==="VIDEO"&&(null==x?void 0:null===(t=x.current[U])||void 0===t?void 0:t.state)&&!B?(null===(i=x.current[U])||void 0===i?void 0:i.paused)?(null==c||c("click_video_player",{to_status:"play"}),null===(n=x.current[U])||void 0===n?void 0:n.play()):(null==c||c("click_video_player",{to_status:"paused"}),ef(C.VideoPause,ed.current),null===(r=x.current[U])||void 0===r?void 0:r.pause()):void 0},{passive:!1}),(0,T.default)("resize",()=>ex(),{passive:!1}),(0,T.default)("visibilitychange",()=>{ei("visible"===document.visibilityState)},{passive:!1}),(0,T.default)("pagehide",()=>{ev.current="close_tab",es.current&&ef(C.VideoPlayTime,ed.current,{duration:ew()-es.current,is_background_play:ec.current?"0":"1",leave_method:ev.current})},{passive:!1});let eS=function(e){var t,i,r,n,o,a,d,u;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pre";if(l[e]){if((null===(t=l[e])||void 0===t?void 0:t.vid)&&ef(C.SwipeVideo,l[e].vid,{is_inner_video:e===ea.current?"0":"1",video_id:null===(i=l[e])||void 0===i?void 0:i.vid,to_group_id:null===(r=l[e])||void 0===r?void 0:r.vid,from_group_id:null===(n=l["pre"===s?e+1:e-1])||void 0===n?void 0:n.vid,status:"pre"===s?"up":"down"}),G.hasMore&&(l.length<10||e===l.length-4)&&e_({offset:G.offset}),z&&q.destroyAll(),M(e),Z(250),"pre"===s){let t=document.querySelectorAll(".play-wrapper")[e+1].clientHeight;Q(e=>e+t),x.current[e+2]&&l[e+2]&&(null===(a=x.current[e+2])||void 0===a||a.destroy(),x.current[e+2]=null),null===(o=x.current[e+1])||void 0===o||o.pause()}else{let t=document.querySelectorAll(".play-wrapper")[e-1].clientHeight;Q(e=>e-t),e-2>=0&&x.current[e-2]&&l[e-2]&&(null===(u=x.current[e-2])||void 0===u||u.destroy(),x.current[e-2]=null),null===(d=x.current[e-1])||void 0===d||d.pause()}setTimeout(()=>{var t,i;let r=x.current[e]||em({vid:null===(t=l[e])||void 0===t?void 0:t.vid,url:null===(i=l[e])||void 0===i?void 0:i.media_url},e);for(let l in x.current[e]||(x.current[e]=r,eT(r)),r.setUserActive(!0,en),r.config.autoplay=!0,r.focus(),r.seek(0),r.play(),x.current)if(Number(l)!==e){let e=x.current[l];e&&null!==e&&(null==e||e.pause(),null==e||e.setUserActive(!1,!0),e.config.autoplay=!1,null==e||e.blur())}let n=(l||[]).slice(e+2).map((e,l)=>({order:l,data:{payload:[{url:e.media_url}],vid:String(e.vid),definition:0}}));er.removeAllPreloadTask(),er.attachPlayer(x.current[e]),er.addPreloaderList(n)},200)}},eb=()=>{!j.FlowLocalStorage.getItem("isFirstShowVideo")&&!(l.length<2)&&(Y(q.info({duration:15,content:(0,N.jsxs)("div",{className:"text",children:[(0,N.jsx)("div",{style:{marginBottom:8},children:"\u6309\u4E0B\u300C\u952E\u76D8\u4E0B\u952E\u300D\u6216\u6ED1\u52A8\u300C\u9F20\u6807\u6EDA\u8F6E\u300D\u67E5\u770B\u66F4\u591A\u89C6\u9891"}),(0,N.jsx)("div",{children:"\u540C\u65F6\u652F\u6301\u70B9\u51FB\u5C4F\u5E55\u4E0A\u7684\u300C\u4E0A\u4E0B\u6309\u94AE\u300D\u5207\u6362\u89C6\u9891"})]})})),j.FlowLocalStorage.setItem("isFirstShowVideo","1"))};(0,o.useEffect)(()=>{I(),!(l.length<1)&&(eo.current=ew(),e_({init:!0}))},[]),(0,o.useEffect)(()=>{if(!ee){es.current&&(ef(C.VideoPlayTime,eu.current,{duration:ew()-es.current,is_background_play:ec.current?"0":"1",leave_method:ev.current}),es.current=0);return}return es.current?ec.current!==et&&(ef(C.VideoPlayTime,ed.current,{duration:ew()-es.current,is_background_play:ec.current?"0":"1",leave_method:ev.current}),es.current=ew(),ec.current=et):(es.current=ew(),ec.current=et),()=>{es.current&&"close_tab"===ev.current&&ef(C.VideoPlayTime,ed.current,{duration:ew()-es.current,is_background_play:ec.current?"0":"1",leave_method:ev.current})}},[et,ee]);let eP=(0,w.default)(e=>ef(C.VideoPlayFinish,e),3e3,{leading:!0,trailing:!1}),eT=e=>{e.on(y.PLAY,()=>{ed.current=e.config.vid,el(!0),ef(C.VideoPlay,e.config.vid)}),e.on(y.PAUSE,()=>{ev.current="pause",eu.current=e.config.vid,ed.current="",el(!1)}),e.on(y.ENDED,()=>{ev.current="pause",eu.current=e.config.vid,ed.current="",el(!1)}),e.on(y.ERROR,()=>{ev.current="pause",eu.current=e.config.vid,ed.current="",el(!1)}),e.on(y.VOLUME_CHANGE,()=>{e.config.vid===ed.current&&ef(C.VideoVolumeChange,e.config.vid,{to_status:e.muted?"off":"on",volumn_value:100*e.volume})}),e.on(y.RATE_CHANGE,()=>{e.config.vid===ed.current&&ef(C.VideoPlaySpeedChange,e.config.vid,{speed_value:e.playbackRate})}),e.on(y.TIME_UPDATE,()=>{e.config.vid===ed.current&&e.duration-e.currentTime<1&&eP(e.config.vid)})};return(0,N.jsxs)(V.default,{visible:u,footer:null,fullScreen:!0,className:F.modal,onCancel:()=>{for(let l in ev.current="close_tab",null==c||c("leave_video_layer",{cnt:U+1,duration:ew()-eo.current}),x.current){var e;null===(e=x.current[l])||void 0===e||e.destroy(),x.current[l]=null}t(l.slice(0,s)),d(!1),M(0),Y("")},children:[(0,N.jsx)("div",{className:"slide-wrapper",children:(0,N.jsx)("div",{className:"slide-list",style:{transform:`translate3d(0px,${J}px, 0px)`,transitionDuration:`${W}ms`},children:l.map((e,l)=>(0,N.jsx)("div",{className:S()("play-wrapper xgplayer",{active:U===l,"xgplayer-nostart":U!==l}),children:(0,N.jsxs)("div",{className:F["video-info"],children:[(0,N.jsx)("div",{className:F.name,children:e.artist_name?`@${e.artist_name}`:null}),(0,N.jsx)("div",{className:F.captions,children:e.song_name})]})},l))})}),(0,N.jsxs)("div",{className:F["play-btn-wrapper"],children:[(0,N.jsx)(A.default,{className:S()(F["play-btn"],{[F["play-btn-disabled"]]:!l[U-1]}),svg:(0,N.jsx)(k,{}),onClick:e=>{e.stopPropagation(),eS(U-1,"pre")}}),(0,N.jsx)(A.default,{className:S()(F["play-btn"],{[F["play-btn-disabled"]]:!l[U+1]}),svg:K?(0,N.jsx)("div",{className:F.loading,children:(0,N.jsx)(D,{className:F["loading-icon"]})}):(0,N.jsx)(R,{}),onClick:e=>{e.stopPropagation(),eS(U+1,"next")}})]})]})},H=e=>{var l;let{videoContent:t,onVideoPlay:i,inView:r,onTrackEvent:p,onClick:f,onShow:_,currentPlay:m,playErrorTitle:h="This video is unavailable",useNewShow:g=!1,videoCardClassName:y}=e,[w,x]=(0,n.useInView)();(0,o.useEffect)(()=>{x&&(null==_||_())},[x]);let[S,b]=(0,o.useState)([]),P=(null===(l=t.video_list)||void 0===l?void 0:l.find(e=>e.item_id===m))||(0,a.default)(t.video_list),{latestFileUrls:T}=(0,v.useLatestFileUrls)({fileUrls:[(null==P?void 0:P.album_image)||""],enable:x}),j=(null==T?void 0:T[0])||(null==P?void 0:P.album_image)||"",{latestFileUrls:V}=(0,v.useLatestFileUrls)({fileUrls:[(null==P?void 0:P.source_app_icon)||""],enable:x}),A=(null==V?void 0:V[0])||(null==P?void 0:P.source_app_icon)||"",[E,C]=(0,o.useState)(!1),[k,R]=(0,o.useState)(!1),[D,L]=(0,o.useState)(),[U,O]=(0,o.useState)(""),M=(0,o.useRef)(0),F=async()=>{if(i){R(!0),b([]);try{var e,l,r;let n=await i({item_ids:null==t?void 0:null===(e=t.video_list)||void 0===e?void 0:e.map(e=>e.item_id)});if((null==n?void 0:n.video_list)&&(n.video_list=null==n?void 0:null===(r=n.video_list)||void 0===r?void 0:r.map(e=>{var l;return{...e,media_url:null===(l=e.media_url)||void 0===l?void 0:l.replace(/http:\/\//,"https://")}})),b((null==n?void 0:n.video_list)||[]),R(!1),O(""),n&&L({offset:t.offset,search_id:t.search_id,query:t.query,has_more:!0}),E&&!(null==n?void 0:null===(l=n.video_list)||void 0===l?void 0:l.length))return s.default.error(h)}catch(l){let e=h;(0,d.default)(l)&&l instanceof c.ApiError&&(e=l.errorOption.message||h),O(e)}}};return((0,o.useEffect)(()=>{r&&!M.current&&(null==p||p("video_card_show",{},{key:`${null==P?void 0:P.item_id}`}));let e=new Date().getTime();r&&(!M.current||e-M.current>=5e4)&&(F(),M.current=new Date().getTime())},[r]),P)?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(u.VideoCard,{videoItem:{...P,album_image:j,source_app_icon:A},useVideoV2:g,onClick:e=>{if(null==f||f(),e.stopPropagation(),C(!0),null==p||p("enter_video_player"),M.current&&Date.now()-M.current>=5e4&&!k){b([]),F(),M.current=Date.now();return}if(M.current&&!(null==S?void 0:S.length)){s.default.error(h);return}if(U){s.default.error(U);return}},className:y,ref:w}),(null==S?void 0:S.length)&&E?(0,N.jsx)(B,{videoParams:D,onVideoPlay:i,showList:S,setShowListList:b,setOpen:C,open:E,limitSize:10,onTrackEvent:p,currentPlay:m}):null]}):null}},740391:function(e,l,t){t.d(l,{fetchBasePlayerResource:function(){return i}});let i=async()=>await Promise.all([t.e("21246"),t.e("24726"),t.e("64041"),t.e("66037"),t.e("62645"),t.e("23786"),t.e("74408"),t.e("57121")]).then(t.bind(t,963041))}}]);