"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["83094"],{571091:function(e,l,t){t.d(l,{default:function(){return s}}),t(713738);var i=t(430261),r=t(345660),s=(0,i.IconFactory)((0,r.jsx)(e=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24",...e,children:(0,r.jsx)("path",{fill:"currentColor",d:"M3.113 11.357a7.07 7.07 0 0 0 4.807 6.116.17.17 0 0 1 .107.107l.554 1.663c.25.75.953 1.257 1.744 1.257h3.35c.791 0 1.494-.506 1.744-1.257l.554-1.663a.17.17 0 0 1 .107-.107 7.07 7.07 0 0 0 4.807-6.116L21 10a9 9 0 1 0-18 0zm10.963 5.59-.518 1.553h-3.117l-.517-1.552a2.17 2.17 0 0 0-1.372-1.372 5.07 5.07 0 0 1-3.446-4.385L5 9.921a7 7 0 0 1 14 0l-.106 1.27a5.07 5.07 0 0 1-3.446 4.385 2.17 2.17 0 0 0-1.372 1.372M10 21.5a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"})}),{}))},152835:function(e,l,t){t.r(l),t.d(l,{SidebarApplicationListInner:function(){return K}});var i=t(713738),r=t(4137),s=t(746479),n=t(812650),a=t.n(n),o=t(689368),d=t(239980),c=t(698392),u=t(334312),p=t(777422),v=t(198660),f=t(792642),m=t(178230),g=t(746904);let x=function(e){let{isOverflow:l,isOverflowPopover:t,isDragOverlay:i,position:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=(0,u.getSkillTeaNameByType)(e),n=e.toString();(0,p.trackEvent)("sidebar_skill_click",{skill_name:s,skill_id:null!=n?n:"",show_pos:"number"==typeof r&&r>=0?r:void 0,show_from:t?"more_hover":l?"more":"default"}),m.logger.persist.info({eventName:"sidebar_skill_click",meta:{skill_type:e,is_overflow:l,is_overflow_popover:t,is_drag_overlay:i,position:r}})},_=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(){let{resetLocalConversationId:t=!0,shouldTrackEvent:i=!0,closeMobileSidebar:r=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t&&(0,c.getChatStore)("chatViewCoreStore").setState({currentLocalConversationId:""}),r&&(0,f.getIsNarrowScreen)()&&((0,g.toggleMobileSidebarExpand)(),(0,c.getChatStore)("flowWebLayoutStore").setState({sidebarStatus:"closed"})),i&&e&&x(e,l)}},b=()=>!(0,v.useIsLoggedIn)(),h=e=>{var l,t;return{unfoldItems:null==e?void 0:null===(l=e.filter(e=>!e.collapsed&&e.skill_type))||void 0===l?void 0:l.map(e=>({id:e.skill_type,skillType:e.skill_type})),collapsedItems:null==e?void 0:null===(t=e.filter(e=>!!e.collapsed&&e.skill_type))||void 0===t?void 0:t.map(e=>({id:e.skill_type,skillType:e.skill_type}))}},y=(e,l)=>e.map(e=>({skill_type:e.skillType,collapsed:!1})).concat(l.map(e=>({skill_type:e.skillType,collapsed:!0})));var k=t(922851),w=t(910214),I=t(856392);let S=async e=>{let l=(0,I.createReportEvent)({eventName:"update_sidebar_skills",meta:{sidebar_skill:e}});try{await w.samanthaApiService.UpdateSkillsOrder({sidebar_skill:e});let t=await (0,k.getChatService)("chatGuidanceService");null==t||t.setSidebarSkills(e),l.addDurationPoint("success"),l.success()}catch(e){l.error({reason:"update_skills_order_error",error:e instanceof Error?e:Error(String(e))})}};var C=t(571091),D=t(680887),N=t(167838),j=t(295779),O=t(542737),E=t(915299),M=t(525029),T=t(386827),L=t(217957),A=t(751825),R=t(115279),P=t(505492),U=t(345660);function q(e){let{disableDrag:l,renderItem:t,indicatorClassName:r,item:s,pointerCoords:n,registerNode:o}=e,{id:d,disableDrag:c,isContainer:u}=s,{attributes:p,listeners:v,node:f,active:m,setNodeRef:g,isDragging:x}=(0,P.useDraggable)({id:d,disabled:l||c}),{setNodeRef:_,over:b}=(0,P.useDroppable)({id:d}),h=(0,i.useMemo)(()=>{if((null==b?void 0:b.id)===d&&n&&f.current&&!u){let e=f.current.getBoundingClientRect(),l=e.top+e.height/2;return n.y<l?"above":"below"}return null},[b,n,f,u]),y=()=>(0,U.jsx)("div",{className:a()("string"==typeof r?r:null==r?void 0:r("above"===h),"w-full h-2 rounded-2 bg-s-color-brand-primary-default")});return(0,U.jsxs)("div",{ref:e=>{g(e),_(e),o(d,e)},...p,...v,className:"relative",children:["above"===h&&y(),null==t?void 0:t({isDragging:x,isOver:(null==b?void 0:b.id)===d,activeId:null==m?void 0:m.id,hasDragging:!(0,L.default)(null==m?void 0:m.id),...s}),"below"===h&&y()]})}let B=e=>{let{items:l,disableDrag:t,renderItem:r,indicatorClassName:s,onChange:n,onContainerDrop:a}=e,[o,d]=(0,i.useState)(void 0),[c,u]=(0,i.useState)(void 0),p=(0,i.useRef)({}),v=(e,l)=>{p.current[e]=l},f=()=>{if(!o)return null;let e=l.find(e=>e.id===o);return e?null==r?void 0:r({hasDragging:!0,isDragging:!0,isOver:!1,isDragOverlay:!0,...e}):null},m=(0,P.useSensors)((0,P.useSensor)(P.MouseSensor,{activationConstraint:{distance:5}})),{run:g}=(0,A.default)(e=>{if(e.activatorEvent){let{clientX:l,clientY:t}=e.activatorEvent;u({x:l+e.delta.x,y:t+e.delta.y})}},{wait:100,leading:!0,trailing:!0});return(0,U.jsxs)(P.DndContext,{sensors:m,collisionDetection:P.closestCenter,onDragStart:e=>{d(e.active.id)},onDragMove:g,onDragEnd:e=>{let{active:t,over:i}=e;if(!i){d(void 0),u(void 0);return}let r=l.findIndex(e=>e.id===t.id),s=l[r],o=l.findIndex(e=>e.id===i.id),v=l[o];if(v.isContainer)null==a||a(v,s),d(void 0),u(void 0);else{let e=p.current[i.id],l="above";if(e&&c){let t=e.getBoundingClientRect(),i=t.top+t.height/2;l=c.y<i?"above":"below"}let t=o;"below"===l&&(t=o+1),r<t&&(t-=1),r!==t&&(null==n||n(e=>(0,R.arrayMove)(e,r,t)))}d(void 0),u(void 0)},onDragCancel:()=>{d(void 0),u(void 0)},children:[l.map(e=>(0,U.jsx)(q,{item:e,disableDrag:t,indicatorClassName:s,pointerCoords:c,registerNode:v,renderItem:r},e.id)),(0,T.createPortal)((0,U.jsx)(P.DragOverlay,{zIndex:1100,children:null==f?void 0:f()}),document.body)]})},F=e=>{let{className:l,sidebarSkillTypes:t=[],collapsedItems:i=[],onChangeCollapsedItems:r,isOver:s,activeId:n,activeCollapsedItemId:d,hasDragging:c,isExpand:u,NavLink:p,onClick:m}=e,g=b(),x=(0,E.useTranslateFn)(),h=(0,v.useIsLoggedIn)(),y=(0,f.useIsNarrowScreen)(),k=s&&d!==n,w=0===i.length,I=i.map(e=>e.skillType),S=u?D.default:N.default,T=()=>(0,U.jsx)(O.SidebarApplicationUI,{className:a()(l,"cursor-pointer",k&&!u&&"bg-s-color-brand-primary-transparent-1 border-dashed border border-s-color-brand-primary-default !p-7",w&&"border-dashed border border-s-color-text-quaternary !p-7"),"data-testid":"skill-page-item-more","data-expand":u,renderIcon:e=>{let{className:l}=e;return(0,U.jsx)(j.default,{className:a()(l,(u||w)&&"text-s-color-text-quaternary")})},titleClassName:u||w?"text-s-color-text-quaternary":void 0,text:w?x("sidebar_moreSkills_hide_placeholder"):u?x("sidebar_moreSkills_hide"):x("sidebar_moreSkills_showMore"),renderHint:()=>w?null:(0,U.jsx)(S,{className:"text-14 text-s-color-text-quaternary p-3"}),renderAfterTitle:()=>w?null:(0,U.jsx)("div",{className:"flex flex-1 items-center justify-end",children:(0,U.jsx)(S,{className:"p-3 text-14 text-s-color-text-quaternary"})}),onClick:()=>{null==m||m()}}),{pluginList:L}=(0,o.useSidebarApplicationPluginList)(I),A=(0,U.jsxs)("div",{className:"flex w-full flex-col p-4",children:[(0,U.jsx)(B,{disableDrag:g,items:i,renderItem:e=>{let{skillType:l,...i}=e;if(!l)return null;let r=L[I.indexOf(l)];if(!r)return null;let s=t.findIndex(e=>e===l);return(0,U.jsx)(r.Content,{NavLink:p,isOverflow:!0,isOverflowPopover:!0,...i,position:s,onClick:_(l,{isOverflow:!0,isOverflowPopover:!0,position:s,...i})})},indicatorClassName:"!w-[calc(100%-24px)] ml-12",onChange:r}),h&&(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("div",{className:"ml-12 h-1 w-[calc(100%-24px)] bg-s-color-border-quaternary"}),(0,U.jsxs)("div",{className:"flex items-center gap-8 py-8 pr-10 pl-12 text-s-color-text-quaternary",children:[(0,U.jsx)(C.default,{className:"text-16"}),(0,U.jsx)("span",{className:"s-font-xxs",children:x("sidebar_moreSkills_popMenu_sorting_tip")})]})]})]});return w&&!c?null:u||y?T():(0,U.jsx)(M.SamanthaPopover,{keepDOM:!1,content:A,position:"rightTop",spacing:8,clickToHide:!0,className:"max-w-320 min-w-158 !rounded-s-radius-xs",children:T()})};var H=t(50909),z=t(437877);let K=e=>{let{sidebarSkills:l,NavLink:t}=e,n=b(),c=l.map(e=>e.skill_type).filter(e=>!(0,r.default)(e)),{pluginList:u,loading:p}=(0,o.useSidebarApplicationPluginList)(c),[v,f]=(0,i.useState)(!1),{unfoldItems:m,collapsedItems:g}=(0,i.useMemo)(()=>h(l),[l]),[x,k]=(0,i.useState)(m),[w,I]=(0,i.useState)(g);(0,i.useEffect)(()=>{0===w.length&&f(!1)},[w]),(0,d.default)(()=>{k(m),I(g)},[m,g]);let C="object"==typeof window&&window.location.pathname,D=(0,i.useMemo)(()=>{let e=u.findIndex(e=>e&&(null==e?void 0:e.route)===C);if(-1!==e)return l[e].skill_type},[u,C,l]),N=w.find(e=>e.skillType&&e.skillType===D),j=(0,i.useMemo)(()=>[...x,...!v&&N?[N]:[],{id:z.MORE_ITEM_ID,disableDrag:!0,isContainer:!v},...v?w:[]],[x,w,v,N]),O=e=>{let{newUnfoldItems:l,newCollapsedItems:t}=e;l&&k(l),t&&I(t),S(y(null!=l?l:x,null!=t?t:w))},E=e=>{O({newCollapsedItems:"function"==typeof e?e(w):e})},M=()=>{f(!v)};return p||l.length&&!u.length?(0,U.jsx)(H.SidebarApplicationListFallback,{sidebarSkills:l}):(0,U.jsx)(B,{items:j,disableDrag:n,renderItem:e=>{var i;let{id:r,skillType:s,...n}=e;if(r===z.MORE_ITEM_ID)return(0,U.jsx)(F,{...n,NavLink:t,sidebarSkillTypes:c,collapsedItems:w,isExpand:v,activeCollapsedItemId:null==N?void 0:N.id,onChangeCollapsedItems:E,onClick:M});if(!s)return null;let a=u[c.indexOf(s)];if(!a)return null;let o=!!(null===(i=l.find(e=>e.skill_type===s))||void 0===i?void 0:i.collapsed),d=c.findIndex(e=>e===s);return(0,U.jsx)(a.Content,{NavLink:t,isOverflow:o,isOverflowPopover:!1,...n,position:d,onClick:_(s,{isOverflow:o,isOverflowPopover:!1,position:d,...n})})},indicatorClassName:e=>a()("!w-[calc(100%-16px)] ml-8",e?"mb-2":"mt-2"),onChange:e=>{let l="function"==typeof e?e(j):e,t=l.findIndex(e=>e.id===z.MORE_ITEM_ID);if(v)O({newUnfoldItems:l.slice(0,t),newCollapsedItems:l.slice(t+1)});else if(N){let e=l.findIndex(e=>e.skillType&&e.skillType===D);e+1===t?O({newUnfoldItems:l.slice(0,e)}):O({newUnfoldItems:l.slice(0,t),newCollapsedItems:w.filter(e=>e.skillType!==D)})}else O({newUnfoldItems:l.slice(0,t)})},onContainerDrop:(e,l)=>{e.id===z.MORE_ITEM_ID&&l.id!==(null==N?void 0:N.id)&&O({newUnfoldItems:(0,s.produce)(x,e=>{let t=e.findIndex(e=>e.id===l.id);-1!==t&&e.splice(t,1)[0]}),newCollapsedItems:[l,...w]})}})}}}]);