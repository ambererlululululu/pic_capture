"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["19439"],{141890:function(e,t,i){var s,a;i.d(t,{HandleInvitationAction:function(){return n},InvitationMethod:function(){return o}});let n=((s={})[s.Declined=0]="Declined",s[s.Accepted=1]="Accepted",s),o=((a={})[a.Phone=0]="Phone",a)},44015:function(e,t,i){var s;i.d(t,{WorkspaceType:function(){return a}});let a=((s={})[s.TeamWorkspace=0]="TeamWorkspace",s[s.PersonalWorkspace=1]="PersonalWorkspace",s)},29623:function(e,t,i){i.d(t,{WorkspaceAvatar:function(){return l}});var s=i(557298),a=i(713738),n=i(812650),o=i.n(n),r={icon:"icon-c86Fkp"},c=i(345660);let l=e=>{let{avatarURL:t,className:i,size:n=18}=e,l=Math.max(n,8),[u,d]=(0,a.useState)(0),[p,k]=(0,a.useState)(!1),v=async()=>{u<2?(await new Promise(e=>setTimeout(e,200)),d(e=>e+1)):k(!0)};return t&&!p?(0,c.jsx)("img",{src:(0,s.filterUrlModule)(t,null,{logType:"js.href/src",reportOnly:"false",blackConfig:"{}",configMode:"merge",isCloseSSRReport:!1,bid:"flow_web",region:"cn",urlLimit:"-1",htmlLimit:"-1",isSaveValidUrl:!1,isRuntimeLog:!1,isDOMParser:!0,escapeRule:"escape-report",reportUrl:"https://mon.zijieapi.com/monitor_browser/collect/batch/security/?bid=flow_web",scmBranch:"release_train_samantha_2025-10-14_552097",scmName:"$20xN*Rt%j$P$E5h$jBsMldr-z$N$mx0%m5aWldFcH$aRmhO%FE9PQ",scmVersion:"1.0.5.6233",webpackPluginVersion:"3.4.5",filename:"$ERJNWQy%kRP$EJo$jJSc1kyaz$hb%l5T$hkaF-zaHNXRE5D-%dSSFozWmpNMHBx$ERKT2RscEhWWFZa-m13d1dsZFJk$0l6%201T%1scHpZak5qZ*xwd*$IWmtl$E$6$2xkSmRHSlhPWFZpTTBwc1kw-zRkb%5I%m1waE1rWn$Xb*hOZ*xSR$R-%lNi$lpvWk$o$2$WcFRPWHBo%jBaN$dsZFJkb*x0-kRaT$dH%jJZMjEwZW1OSFJtc*F$emw2WTIxTmRsa3lPWFJq%npsM$ds-zFNR041T1ROa%0wcHlZek5D-%Zre$Z-%lpXRnBvWk$kR2$$d3liSFZh%jFZMFRHN$Nlb$ZI%m5s-%0xWj-"}),alt:"icon",className:o()(r.icon,i),style:{width:l,height:l},onError:v},u):(0,c.jsx)("img",{src:(0,s.filterUrlModule)("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAMAAADVRocKAAAAilBMVEUAAADE2v/C2v/D2v/D3//D2//D2v/D2v/D2//D2//D2//E2v/D2v/E3P/F2v/D2v/F2v/C2//C2f/E2v+/2v/l7v8AV/+syP/D2v85ff/U5P/i7P/H3P/L3//d6f/O4f/X5f/Z6P8OYf+ArP8dav9zov9Hhv+60v9yo/+ev/8rdP+Ptf9kmf9Wj/8VZRHBAAAAFXRSTlMA32BwECC/r5BA75/PXzDvYFCgzzA49ToPAAADnUlEQVRo3sWa23qiMBRGE+SstYeZwC8JIVir0zm8/+sNylA+i8EEyHRdeeGX5d472WASYoafrOJoQ1M0pDSM4lXik6XwvTVFg6iq4kJVlmjYrL1ggdFXIYBK1ZxdwaWqAIQzHUkIlIVkGqQqgeh5+o+nQMHZKLwQoB6ZwipFKZkBdTlFkdB2eCOktSKIICSzoBZYW5T7IUXBLCnMg/BjlJxZwwVi3yg9tP/51kEYpGmbQrKJSEG3d9MPwdlkuMDDncnfpn+6ocRqfPyKs1nwaszwgIrNptJnadvnZ16Wtrr5qamvdaUfb85Wvxt/vgHUJ0NiSLYQEjEZ4KFgi1Hg4UYB2IKUgzKswZcUcESOEtQnKbkSUMEWRtDrAOqlBfKqZdCSLU756PcBQI7Eml+jzEMwCED92Gef2b0bhvBRhWdtBcQhu8UPwxC6iRQJq/EbXo0MCP8tYu0a+J1p2CuzteC3JdYu4ksAb/kV7wfjEPi/Moe6Ep+yht+Dup/L/seszGGbIV28+VmQs8/szjOJmefIg3QlkHi69FHmSsCwbgSbyp2gooT4UO4ECj5JIN0JaiRkBe5C0K+EGOy+4HTcnXn9EOx3LcdfYtSAmETlfYE6dF2uE/TsRzufiEhoIMg/OnUrMO+t1TdCK4MI9l0XHQoa8tF5mhYGNRBtDd4GNWjMoxUvHgkKNmMWiZ9Zg9ILMFPA3rOGkyNB/50vFaRuBY+EVi4FFSUbE4F6fTuTWwvKkETCQNC1il/WgojEsGgVR1sBYqN2rTrBH61A364T1PdT9NbmaCcsBRKJ5SPTUqDgE0Ird4KmWxPyAncCrNsXL1cCCa8R+ChcCRSC9uXXhaB/+dWsBJXnr5enZP6Z8zPmZ/ux/45iQ/g5Q7ociX1mxeF0q1cH5EIINuCYWXK8+c7SkkC6ENR4HvkbezpkVuzFyN9YsoK8UWQrlGYRtPhpyeaiC6APYWFqeP9zO4cky29IeeSKaOkttTW5Jli2zoIGjrc1vf+/MUt8ulQZuBhuLbdlWGpzXHeUs4VYZnv/O9HgLXNA8eT+iGXMIFweEjV4c4+5nsgdtlTI6fM//f71R42Xw1LBJ6U/9okZ3oQgCqRPxJjgBaK2OyZFFBAbPNsj94Q0WCtqw+HTbvJbK8T9aw8AXflkIs8RIJQ2VbIogTAhcwi89uqJ/BQJr9urJ92Pn+d42aBBlN3lmUqgga49g9Ftrv+E3fWfjcX1n78uW2FDI964+AAAAABJRU5ErkJggg==",null,{logType:"js.href/src",reportOnly:"false",blackConfig:"{}",configMode:"merge",isCloseSSRReport:!1,bid:"flow_web",region:"cn",urlLimit:"-1",htmlLimit:"-1",isSaveValidUrl:!1,isRuntimeLog:!1,isDOMParser:!0,escapeRule:"escape-report",reportUrl:"https://mon.zijieapi.com/monitor_browser/collect/batch/security/?bid=flow_web",scmBranch:"release_train_samantha_2025-10-14_552097",scmName:"$20xN*Rt%j$P$E5h$jBsMldr-z$N$mx0%m5aWldFcH$aRmhO%FE9PQ",scmVersion:"1.0.5.6233",webpackPluginVersion:"3.4.5",filename:"$ERJNWQy%kRP$EJo$jJSc1kyaz$hb%l5T$hkaF-zaHNXRE5D-%dSSFozWmpNMHBx$ERKT2RscEhWWFZa-m13d1dsZFJk$0l6%201T%1scHpZak5qZ*xwd*$IWmtl$E$6$2xkSmRHSlhPWFZpTTBwc1kw-zRkb%5I%m1waE1rWn$Xb*hOZ*xSR$R-%lNi$lpvWk$o$2$WcFRPWHBo%jBaN$dsZFJkb*x0-kRaT$dH%jJZMjEwZW1OSFJtc*F$emw2WTIxTmRsa3lPWFJq%npsM$ds-zFNR041T1ROa%0wcHlZek5D-%Zre$Z-%lpXRnBvWk$kR2$$d3liSFZh%jFZMFRHN$Nlb$ZI%m5s-%0xWj-"}),className:o()(r.icon,i),style:{width:l,height:l}})}},152246:function(e,t,i){i.d(t,{useHandleInvitation:function(){return c}});var s=i(141890),a=i(910214),n=i(231149),o=i(47563),r=i(178230);let c=e=>{let{t}=e,{runAsync:i,loading:c}=(0,n.default)(async(e,i)=>{try{return await a.workspaceApiService.AGWWorkspaceHandleInvitation({invitation_id:e,action:i?s.HandleInvitationAction.Accepted:s.HandleInvitationAction.Declined}),!0}catch(e){var n;return r.logger.persist.error({eventName:"workspace_handle_invitation_error",error:e}),o.SamanthaToast.error((null===(n=e.errorOption)||void 0===n?void 0:n.message)||(i?t("enterprise_toast_inviteAcceptFail"):t("enterprise_toast_inviteDeclineFail"))),!1}},{manual:!0,debounceWait:1e3,debounceLeading:!0,debounceTrailing:!1});return{handleInvitation:i,handleInvitationLoading:c}}},582801:function(e,t,i){i.d(t,{useSwitchWorkspace:function(){return m}});var s=i(865607),a=i(915299),n=i(690619),o=i(886941),r=i(72516),c=i(231149),l=i(38848),u=i(48766),d=i(47563),p=i(178230),k=i(324612);let v=()=>Promise.resolve({canSwitch:!0});var g=i(233825),w=i(951252),_=i(345660);let m=()=>{let e=(0,a.useTranslateFn)(),{currentWorkspace:t}=(0,w.useWorkspaceUserStore)(e=>({workspaceList:e.workspaceList,currentWorkspace:e.currentWorkspace}),s.shallow),{runAsync:i,loading:m}=(0,c.default)(async function(i){let s=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if((null==t?void 0:t.workspace_id)===i.workspace_id)return;let{canSwitch:a}=await v();if(!a){p.logger.persist.warning({eventName:"switch_workspace_blocked_by_app"});return}if(i.workspace_scoped_sec_uid){let t=d.SamanthaToast.info({content:e("enterprise_changeSpace_toast_changing"),duration:5,icon:(0,_.jsx)(u.default,{size:"middle"})});p.logger.persist.info({eventName:"switch_workspace_start"});try{await (0,n.getFlowAccount)().passportApi.switchAccount({sec_user_id:i.workspace_scoped_sec_uid,onVerifyPhone:()=>d.SamanthaToast.close(t)}).then(e=>(l.FlowLocalStorage.setItem("flow_tea_user_id",String(i.workspace_scoped_uid)),(0,o.updateWorkspaceParams)({type:e.passport_enterprise_user_type}),e)),(0,r.resetProfile)(),await (0,k.timeoutPromise)(1e3),p.logger.persist.info({eventName:"switch_workspace",meta:{success:"1"}}),s&&window.location.reload()}catch(e){d.SamanthaToast.close(t),p.logger.persist.error({eventName:"switch_workspace",error:e,meta:{success:"0",targetWorkspaceId:i.workspace_id}})}}},{manual:!0,debounceWait:1e3,debounceLeading:!0,debounceTrailing:!1}),{runAsync:f,loading:h}=(0,c.default)(async function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];try{let s=await (0,g.getWorkspaceByWorkspaceId)(e);if(s)await i(s,t);else throw Error("Workspace not found")}catch(e){p.logger.persist.error({eventName:"switch_workspace_by_workspace_id_failed",error:e})}},{manual:!0,debounceWait:1e3,debounceLeading:!0,debounceTrailing:!1});return{switchWorkspace:i,switchLoading:m,switchWorkspaceByWorkspaceId:f,switchByWorkspaceIdLoading:h}}},115029:function(e,t,i){i.d(t,{useUpdateWorkspaceInfo:function(){return n}});var s=i(231149),a=i(843325);let n=()=>{let{run:e}=(0,s.default)(async e=>{await (0,a.updateWorkspaceInfo)({onlyList:e,throwError:!1})},{manual:!0});return{refreshWorkspaceList:e}}},173772:function(e,t,i){i.d(t,{useInitWorkspaceInfo:function(){return j}});var s=i(713738),a=i(865607),n=i(198660),o=i(797840),r=i(231149),c=i(121821),l=i(777422),u=i(915299),d=i(833268),p=i(178230),k=i(582801),v=i(324612),g=i(255753),w=i(951252),_=i(812650),m=i.n(_),f=i(404012),h=i(214902),W=i(559425),S=i(115029),I=i(152246),b=i(29623),A={"notice-content":"notice-content-xQsgQw",noticeContent:"notice-content-xQsgQw",info:"info-uL48AP",title:"title-DEsEJ9",name:"name-fUEs9A","button-group":"button-group-TJH1rR",buttonGroup:"button-group-TJH1rR",button:"button-IjLMVl","reject-button":"reject-button-BkGtd1",rejectButton:"reject-button-BkGtd1",disabled:"disabled-sPlwx2",rejected:"rejected-yGghj7",transition:"transition-Ivk1eG"},E=i(345660);let R=(e,t,i)=>{let[a,n]=(0,s.useState)(t[e]);return[a,t=>{i({[e]:t}),n(t)}]},N=e=>{let{t,className:i,title:s,avatarURL:a,invitationId:n,switchWorkspace:o,close:r,onHandled:c,state:u,setState:d}=e,{handleInvitation:p,handleInvitationLoading:k}=(0,I.useHandleInvitation)({t}),{refreshWorkspaceList:g}=(0,S.useUpdateWorkspaceInfo)(),[w,_]=R("isInTransition",u,d),[N,y]=R("isAccepting",u,d),[T,$]=R("isRejecting",u,d),[j,P]=R("hasRejected",u,d),[F,B]=R("hasAccepted",u,d),U=()=>{_(!0)},C=async()=>{(0,l.trackEvent)("click_business_space_invitation_notice",{button_name:"deny"}),$(!0),await p(n,!1),U(),P(!0),c("reject"),await (0,v.timeoutPromise)(3600),r(),await (0,v.timeoutPromise)(350),g()},Z=async()=>{F?o():((0,l.trackEvent)("click_business_space_invitation_notice",{button_name:"accept"}),y(!0),await p(n,!0)&&(U(),B(!0),await (0,v.timeoutPromise)(500),g(!0),c("accept")))},x=N&&k||F||j,H=T&&k||j;return(0,E.jsxs)("div",{className:m()(A["workspace-invite-notice"],i),children:[(0,E.jsxs)("div",{className:A["notice-content"],children:[(0,E.jsx)(b.WorkspaceAvatar,{avatarURL:a,size:36}),(0,E.jsxs)("div",{className:A.info,children:[(0,E.jsx)("div",{className:A.title,children:t("enterprise_space_invite_header")}),(0,E.jsx)(f.default.Text,{className:A.name,ellipsis:{showTooltip:{opts:{content:s},renderTooltip:(e,t)=>(0,E.jsx)(h.SamanthaTooltip,{position:"left",content:e,children:t})}},children:s})]})]}),(0,E.jsxs)("div",{className:A["button-group"],children:[(0,E.jsx)(W.SamanthaButton,{className:m()(A["reject-button"],A.button,j&&A.rejected,F&&w&&A.transition,x&&A.disabled),type:"quartary",loading:T&&k,disabled:x,onClick:C,children:t(j?"enterprise_space_invite_status_rejected":"enterprise_space_invite_btn_reject")}),(0,E.jsx)(W.SamanthaButton,{className:m()(A.button,j&&w&&A.transition),type:"primary",loading:N&&k,disabled:H,onClick:Z,children:t(F?"enterprise_space_invite_btn_enter":"enterprise_space_invite_btn_accept")})]})]})},y=e=>{let{disableNotification:t}=e||{},i=(0,u.useTranslateFn)(),{workspaceInvitationList:n,hiddenInvitations:o,visibleInvitations:r}=(0,w.useWorkspaceUserStore)(e=>({workspaceInvitationList:e.workspaceInvitationList,hiddenInvitations:e.hiddenInvitations,visibleInvitations:e.visibleInvitations}),a.shallow),{switchWorkspaceByWorkspaceId:_}=(0,k.useSwitchWorkspace)(),[m,f]=(0,s.useState)();(0,s.useEffect)(()=>{if(!n){p.logger.persist.info({eventName:"calc_workspace_invitation_list",meta:{workspace_invitation_count:0}});return}let[e,t]=(0,c.default)(n,e=>null==m?void 0:m.find(t=>t.id===String(e.invitation_id)));p.logger.persist.info({eventName:"calc_workspace_invitation_list",meta:{workspace_invitation_count:n.length,visible_invitation_count:t.length,hidden_invitation_count:e.length,hidden_invitation_in_storage_count:null==m?void 0:m.length}}),w.useWorkspaceUserStore.getState().setInvitations({hiddenInvitations:e,visibleInvitations:t})},[n,m]),(0,s.useEffect)(()=>{try{(null==m?void 0:m.length)&&(g.localStorageCross.setItem("workspace-invitation-hidden-v1",JSON.stringify(m)),p.logger.persist.info({eventName:"set_workspace_invitation_hidden_in_storage",meta:{success:"1"}}))}catch(e){p.logger.persist.error({eventName:"set_workspace_invitation_hidden_in_storage",error:e,meta:{error:null==e?void 0:e.message,success:"0"}})}},[m]),(0,s.useEffect)(()=>{(async()=>{let e=await g.localStorageCross.getItem("workspace-invitation-hidden-v1");try{let t=JSON.parse(e||"[]");(null==t?void 0:t.length)&&f(t),p.logger.persist.info({eventName:"get_workspace_invitation_hidden_in_storage",meta:{success:"1"}})}catch(e){p.logger.persist.error({eventName:"get_workspace_invitation_hidden_in_storage",error:e,meta:{error:null==e?void 0:e.message,success:"0"}})}})()},[]);let h=(0,s.useRef)([]);return(0,s.useEffect)(()=>{let{hasInitInvitationNotice:e,setHasInitInvitationNotice:s}=w.useWorkspaceUserStore.getState();!t&&(null==r?void 0:r.length)&&!e&&(s(!0),(async()=>{let e=await Promise.all(r.map(async(e,t)=>{await (0,v.timeoutPromise)(200*t);let s="",a="",n={isInTransition:!1,isAccepting:!1,isRejecting:!1,hasRejected:!1,hasAccepted:!1},o=(0,E.jsx)(N,{t:i,avatarURL:e.avatar_url,title:e.name,invitationId:String(e.invitation_id),switchWorkspace:()=>_(String(e.workspace_id)),close:()=>d.default.close(s),onHandled:e=>{a=e},state:n,setState:e=>{Object.assign(n,e)}},e.workspace_id);return s=d.default.open({className:"notification-xttdYl",title:o,duration:0,onCloseClick:()=>{a||((0,l.trackEvent)("click_business_space_invitation_notice",{button_name:"ignore"}),f(t=>[...t||[],{date:Date.now(),id:String(e.invitation_id)}]))},zIndex:1020})}));h.current=e})())},[r]),(0,s.useEffect)(()=>()=>{var e;null===(e=h.current)||void 0===e||e.forEach(e=>{d.default.close(e)})},[]),{hiddenInvitations:o}};var T=i(843325),$=i(858436);let j=e=>{let{disableInvitations:t}=e||{},[i,c]=(0,s.useState)(!1),l=(0,n.useIsLoggedIn)(),{userInfo:u}=(0,o.useFlowAccountStore)(e=>({userInfo:e.userInfo}),a.shallow),{workspaceList:d}=(0,w.useWorkspaceUserStore)(e=>({workspaceList:e.workspaceList}),a.shallow),{hiddenInvitations:p}=y();return(0,r.default)(async()=>{if(!l||!$.enableWorkspaceSSO)return;let{initWorkspaceStatus:e}=w.useWorkspaceUserStore.getState();("uninit"===e||"failed"===e)&&(w.useWorkspaceUserStore.getState().setInitWorkspaceStatus("loading"),await (0,T.updateWorkspaceInfo)({onlyList:null!=t&&t,throwError:!0}),w.useWorkspaceUserStore.getState().setInitWorkspaceStatus("initialed"))},{refreshDeps:[l],retryCount:10,onError:()=>{w.useWorkspaceUserStore.getState().setInitWorkspaceStatus("failed")}}),(0,s.useEffect)(()=>{if((null==u?void 0:u.user_id_str)&&(null==d?void 0:d.length)){var e;let t=d.find(e=>String(e.workspace_scoped_uid)===u.user_id_str);t&&t.workspace_id!==(null===(e=w.useWorkspaceUserStore.getState().currentWorkspace)||void 0===e?void 0:e.workspace_id)&&(w.useWorkspaceUserStore.getState().setCurrentWorkspace(t),c(!0))}},[u,d]),{isReady:i,hiddenInvitations:p}}},951252:function(e,t,i){i.d(t,{useWorkspaceUserStore:function(){return r}});var s=i(952259),a=i(321647),n=i(746479);let o={initWorkspaceStatus:"uninit",workspaceList:void 0,workspaceInvitationList:void 0,currentWorkspace:void 0,hiddenInvitations:void 0,visibleInvitations:void 0,hasInitInvitationNotice:!1},r=(0,a.create)()((0,s.subscribeWithSelector)(e=>({...o,setInitWorkspaceStatus:t=>{e((0,n.produce)(e=>{e.initWorkspaceStatus=t}))},setWorkspaceList:t=>{e((0,n.produce)(e=>{e.workspaceList=t}))},setWorkspaceInvitationList:t=>{e((0,n.produce)(e=>{e.workspaceInvitationList=t}))},setCurrentWorkspace:t=>{e((0,n.produce)(e=>{e.currentWorkspace=t}))},setInvitations:t=>{let{hiddenInvitations:i,visibleInvitations:s}=t;e((0,n.produce)(e=>{e.hiddenInvitations=i,e.visibleInvitations=s}))},setHasInitInvitationNotice:t=>{e((0,n.produce)(e=>{e.hasInitInvitationNotice=t}))}})))},233825:function(e,t,i){i.d(t,{checkIsTeamWorkspace:function(){return n},getWorkspaceByWorkspaceId:function(){return o}});var s=i(44015),a=i(910214);let n=e=>(null==e?void 0:e.workspace_type)===s.WorkspaceType.TeamWorkspace,o=async e=>{let{data:t}=await a.workspaceApiService.AGWGetWorkspaces();if(null==t?void 0:t.workspaces)return t.workspaces.find(t=>String(t.workspace_id)===e);throw Error("Empty workspace list")}},255753:function(e,t,i){i.d(t,{localStorageCross:function(){return s}});let s={getItem:e=>window.localStorage.getItem(e),setItem(e,t){window.localStorage.setItem(e,t)}}},324612:function(e,t,i){i.d(t,{timeoutPromise:function(){return s}});let s=e=>new Promise(t=>{setTimeout(t,e)})},843325:function(e,t,i){i.d(t,{updateWorkspaceInfo:function(){return c}});var s=i(44015),a=i(910214),n=i(886941),o=i(178230),r=i(951252);let c=async e=>{let{onlyList:t,throwError:i}=e;try{let{data:e}=await a.workspaceApiService.AGWGetWorkspaces();if(null==e?void 0:e.workspaces){var c;r.useWorkspaceUserStore.getState().setWorkspaceList(null==e?void 0:e.workspaces);let t=null===(c=e.workspaces.find(e=>e.workspace_type===s.WorkspaceType.PersonalWorkspace))||void 0===c?void 0:c.workspace_scoped_uid;t&&(0,n.updateWorkspaceParams)({cuid:String(t)}),o.logger.persist.info({eventName:"get_workspace_list",meta:{success:"1",workspace_count:null==e?void 0:e.workspaces.length}})}else throw Error("empty workspace list");!t&&(null==e?void 0:e.pending_workspaces)&&r.useWorkspaceUserStore.getState().setWorkspaceInvitationList(null==e?void 0:e.pending_workspaces)}catch(e){if(o.logger.persist.error({eventName:"get_workspace_list",error:e,meta:{success:"0"}}),i)throw e}}}}]);