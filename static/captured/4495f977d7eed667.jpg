"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["3986"],{55845:function(e,t,i){i.d(t,{default:function(){return a}}),i(713738);var r=i(430261),o=i(345660),a=(0,r.IconFactory)((0,o.jsx)(e=>(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24",...e,children:(0,o.jsx)("path",{fill:"currentColor",d:"M22 3v7a1 1 0 1 1-2 0V4h-6a1 1 0 1 1 0-2h7a1 1 0 0 1 1 1M11.005 21a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1v-7a1 1 0 0 1 2.002 0v6h6.003a1 1 0 0 1 1 1"})}),{}))},456602:function(e,t,i){i.d(t,{default:function(){return a}}),i(713738);var r=i(430261),o=i(345660),a=(0,r.IconFactory)((0,o.jsx)(e=>(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24",...e,children:(0,o.jsx)("path",{fill:"currentColor",d:"M9.218 17.41 19.83 6.796a.99.99 0 1 1 1.389 1.415c-3.545 3.425-4.251 4.105-11.419 11.074a.997.997 0 0 1-1.375.018c-1.924-1.801-3.709-3.568-5.573-5.43a.999.999 0 0 1 1.414-1.413z"})}),{}))},112774:function(e,t,i){var r,o,a,n,l,s;i.d(t,{CodeCompileStatus:function(){return d},CodeNodeContentReviewStatus:function(){return c},CodeResourceDownloadType:function(){return u},CodeType:function(){return p},GenerateSource:function(){return f},ResourceType:function(){return m}});let d=((r={})[r.StatusDefault=0]="StatusDefault",r[r.StatusCompiling=1]="StatusCompiling",r[r.StatusFail=2]="StatusFail",r[r.StatusSuccess=3]="StatusSuccess",r),c=((o={})[o.Init=0]="Init",o[o.Access=1]="Access",o[o.Reject=2]="Reject",o),u=((a={})[a.MultiFileContext=1]="MultiFileContext",a[a.DirectoryContext=2]="DirectoryContext",a[a.Artifacts=3]="Artifacts",a[a.SingleFileContext=4]="SingleFileContext",a),p=((n={})[n.CodeTypeArtifacts=1]="CodeTypeArtifacts",n[n.CodeTypeRaw=2]="CodeTypeRaw",n),f=((l={})[l.Default=0]="Default",l[l.CodeBlock=1]="CodeBlock",l[l.DevelopMode=2]="DevelopMode",l),m=((s={})[s.Repository=1]="Repository",s[s.File=2]="File",s[s.Directory=3]="Directory",s)},978114:function(e,t,i){i.d(t,{useValidRemoteGithubUrl:function(){return l}});var r=i(915299),o=i(710733),a=i(239358),n=i(631122);let l=()=>{let e=(0,n.useToast)(),t=(0,r.useTranslateFn)();return async function(i){var r,n,l,s;let d=!(arguments.length>1)||void 0===arguments[1]||arguments[1],c=await (0,a.getGithubRepoInfo)(i),u=null==c?void 0:null===(r=c.repository)||void 0===r?void 0:r.not_support_reason,p="",f=(null===(n=c.repository)||void 0===n?void 0:n.is_repo)===!0;if(f||(p=t("cici_web_ai_coding_repo_limit")),(null==c?void 0:c.code)===0x280de883&&(p=t("cici_web_ai_coding_zip_size_limit")),(u===o.SniffRepoNotSupportReason.NotPublicRepository||u===o.SniffRepoNotSupportReason.NotGitHubLink)&&(p=t("cici_web_ai_coding_repo_limit")),u===o.SniffRepoNotSupportReason.SizeOverLimit){let e=Number(null!==(s=null==c?void 0:null===(l=c.repository)||void 0===l?void 0:l.size_limit_kb)&&void 0!==s?s:40960)/1024;p=t("cici_web_ai_coding_zip_size_limit_2",{postProcess:"sprintf",sprintf:[`${e.toFixed()} MB`]})}p&&d&&e.error(p);let m=null==c?void 0:c.repository;return{valid:!!f,errorMessage:p,metaInfo:{...m,original_url:i,analysis_url:null==m?void 0:m.link}}}}},239358:function(e,t,i){i.d(t,{getGithubRepoInfo:function(){return o}});var r=i(910214);let o=(()=>{let e={};return async t=>{if(e[t])return e[t];try{var i,o,a,n;let l=await r.samanthaApiService.SniffLink({links:[t],with_content_type:!1,with_repository:!0}),s=(null===(o=l.data)||void 0===o?void 0:null===(i=o.results)||void 0===i?void 0:i.find(e=>e.url===t))||(null===(n=l.data)||void 0===n?void 0:null===(a=n.failed_urls)||void 0===a?void 0:a.find(e=>e.url===t));if(!s)return null;return e[t]=s,s}catch(e){return null}}})()},628338:function(e,t,i){i.d(t,{hasPreprocessTask:function(){return p},refContentsSelector:function(){return d},useEnableRefContents:function(){return u},useRefContents:function(){return c}});var r=i(713738),o=i(214071),a=i(913821),n=i(698392),l=i(568388),s=i(165876);let d=(e,t)=>{let i=e.refContentMap[t];if(!(!i||(0,o.default)(i.refContents)))return i},c=e=>{let t=(0,n.useChatSlice)("refContentStore",t=>d(t,e),a.default),i=(0,n.useChatSlice)("attachmentUploadStore",e=>e.preprocessTaskMap,a.default);return(0,r.useMemo)(()=>{if(!t||(0,o.default)(t.refContents))return;let e=t.refContents.filter(e=>{if("attachment"!==e.type)return!0;for(let t in i)if(i[t].key===e.fileKey)return i[t].reviewState!==l.ReviewState.ReviewState_NotCompliant;return!0});return{...t,refContents:e}},[t,i])},u=e=>{let t=c(e);return(0,r.useMemo)(()=>({...t,refContents:(null==t?void 0:t.refContents)?(0,s.filterEnableRefContents)(t.refContents):void 0}),[t])},p=e=>!!(0,n.getChatSlice)("attachmentUploadStore").preprocessTaskMap[e]},73438:function(e,t,i){var r;i.d(t,{PRESET_PROMPT_STARLING_KEY:function(){return a},PRESET_PROMPT_TYPE:function(){return n},PresetPrompt:function(){return o}});let o=((r={})[r.SummarizeSingle=1]="SummarizeSingle",r[r.SummarizeMultiple=2]="SummarizeMultiple",r[r.SummarizeWebsite=3]="SummarizeWebsite",r[r.HighlightSingle=4]="HighlightSingle",r[r.HighlightMultiple=5]="HighlightMultiple",r[r.HighlightWebsite=6]="HighlightWebsite",r[r.GenerateMindMap=7]="GenerateMindMap",r[r.CreateByDoc=8]="CreateByDoc",r[r.CreateByPPT=9]="CreateByPPT",r[r.MakeQuiz=10]="MakeQuiz",r[r.CreateByWebsite=11]="CreateByWebsite",r[r.ExplainImage=12]="ExplainImage",r[r.SummarizeImage=13]="SummarizeImage",r[r.ExtractTextFromImage=14]="ExtractTextFromImage",r[r.IntroFolder=15]="IntroFolder",r[r.UsageFolder=16]="UsageFolder",r[r.IntroRepo=17]="IntroRepo",r[r.IntroFile=18]="IntroFile",r[r.UsageFile=19]="UsageFile",r[r.SummarizeData=20]="SummarizeData",r[r.GenerateCharts=21]="GenerateCharts",r[r.AnalyzeQueryData=22]="AnalyzeQueryData",r[r.GeneratePodcast=23]="GeneratePodcast",r[r.GenerateWhiteboardCode=24]="GenerateWhiteboardCode",r),a={[o.SummarizeSingle]:"skill_read_file_shortcut2",[o.SummarizeMultiple]:"skill_read_file_shortcut5",[o.SummarizeWebsite]:"skill_read_file_shortcut7",[o.HighlightSingle]:"skill_read_file_shortcut1",[o.HighlightMultiple]:"skill_read_file_explainDoc",[o.HighlightWebsite]:"skill_read_file_shortcut8",[o.GenerateMindMap]:"skill_read_file_shortcut6",[o.CreateByDoc]:"skill_read_file_refineDoc",[o.CreateByPPT]:"skill_read_file_pptScript",[o.MakeQuiz]:"skill_read_file_shortcut3",[o.CreateByWebsite]:"skill_read_file_writeFromWebpage",[o.ExplainImage]:"skill_read_image_shortcut1",[o.SummarizeImage]:"skill_read_pic_prompt1",[o.ExtractTextFromImage]:"skill_read_pic_prompt2",[o.IntroFolder]:"cici_web_ai_coding_default_query_intro_folder",[o.UsageFolder]:"cici_web_ai_coding_default_query_usage_folder",[o.IntroRepo]:"cici_web_ai_coding_default_query_intro_repo",[o.IntroFile]:"cici_web_ai_coding_default_query_intro_file",[o.UsageFile]:"cici_web_ai_coding_default_query_usage_file",[o.SummarizeData]:"skill_dataAnalysis_prompt1",[o.GenerateCharts]:"skill_dataAnalysis_prompt2",[o.GeneratePodcast]:"podcast_chat_option_generate",[o.AnalyzeQueryData]:"web_ai_coding_default_query_data_analysis",[o.GenerateWhiteboardCode]:"coding_website_build_drawboard_query"},n={[o.HighlightSingle]:"highlight",[o.SummarizeSingle]:"summarize",[o.MakeQuiz]:"make_a_quiz",[o.GenerateMindMap]:"generate_mind_map",[o.SummarizeImage]:"image_summary",[o.ExtractTextFromImage]:"image_read_text",[o.ExplainImage]:"image_vlm_summary",[o.SummarizeData]:"data_analysis_summary",[o.GenerateCharts]:"data_analysis_three_charts",[o.SummarizeWebsite]:"link_summary",[o.HighlightWebsite]:"link_main_content",[o.GeneratePodcast]:"generate_podcast"}},243915:function(e,t,i){i.d(t,{ChatInputContainerUI:function(){return s}});var r=i(713738),o=i(812650),a=i.n(o),n={"chat-input-container":"chat-input-container-FpHqTd","chat-input-container-disabled":"chat-input-container-disabled-up0Obi","chat-input-float":"chat-input-float-k8Smxq"},l=i(345660);let s=(0,r.forwardRef)(function(e,t){let{className:i,hasBoxShadow:r=!0,disabled:o,children:s}=e;return(0,l.jsx)("div",{className:a()(n["chat-input-container"],r&&n["chat-input-float"],i,o&&n["chat-input-container-disabled"]),tabIndex:0,ref:t,children:s})})},334780:function(e,t,i){i.d(t,{CODE_AGENT_MODE_KEY:function(){return r}});let r="code_agent_mode"},437567:function(e,t,i){i.d(t,{initCodingSkillStore:function(){return P},useCodingSkillStore:function(){return w}});var r=i(642220),o=i(580296),a=i(191360),n=i(487300),l=i(792433),s=i(311971),d=i(910214),c=i(524129),u=i(178230),p=i(253359);let f=(e,t)=>({previewedCount:0,incrAllowTryPreviewCount:()=>{e({previewedCount:t().previewedCount+1})},checkAllowTryPreview:()=>t().previewedCount<4});var m=i(519428),_=i(165482),g=i(375881);let v=()=>({blockIdToProcess:{},hasOpenCanvasViewInAsyncStreaming:!1,isProcessDataLoading:!1,blockIdToProcessHasInited:{},blockArtifactMetaMap:{},processBlockMetaMap:{},blockArtifactAutoOpenCanvasMap:{}}),h=(e,t)=>(0,l.default)(v(),{fetchAgentProcessData:async i=>{var r;let{blockId:o,resourceId:a}=i;if(null===(r=t().blockIdToProcessHasInited)||void 0===r?void 0:r[o])return null;try{e((0,s.produce)(e=>{e.isProcessDataLoading=!0}));let{data:t}=await d.samanthaApiService.GetDeepResearchResource({resource_id:a}),{blocks:i=[]}=null!=t?t:{},r=i.map(e=>{var t;return{...e,content_obj:(0,_.parseJSON)(e.content,{}),id:null!==(t=null==e?void 0:e.block_id)&&void 0!==t?t:"",parent_id:e.parent_block_id}});return e((0,s.produce)(e=>{e.blockIdToProcess[o]||(e.blockIdToProcess[o]=[]),e.blockIdToProcess[o]=r,e.isProcessDataLoading=!1,e.blockIdToProcessHasInited[o]=!0})),r}catch(t){return e((0,s.produce)(e=>{e.isProcessDataLoading=!1,e.blockIdToProcessHasInited[o]=!0})),u.logger.persist.warning({eventName:"fetch_DeepResearch_process_data_error"}),null}},updateAgentProcessData(t){let{blockId:i,value:r}=t;e((0,s.produce)(e=>{e.blockIdToProcess[i]||(e.blockIdToProcess[i]=[]),e.blockIdToProcess[i]=r}))},setHasOpenCanvasViewInAsyncStreaming:t=>{e((0,s.produce)(e=>{e.hasOpenCanvasViewInAsyncStreaming=t}))},updateBlockArtifactMeta:t=>{let{blockId:i,codeFileBlockList:r,isStreaming:o,activeCodeFileBlockId:a}=t;e((0,s.produce)(e=>{let{blockArtifactMetaMap:t}=e;t[i]={...t[i],codeFileBlockList:r,isStreaming:o,activeCodeFileBlockId:a}}))},updateCodeFileBlockContent:(t,i,r)=>{e((0,s.produce)(e=>{let{blockArtifactMetaMap:o}=e;if(!t||!o[t])return;let a=o[t].codeFileBlockList.find(e=>{var t;return(null===(t=e.artifactMeta.code)||void 0===t?void 0:t.path)===i});a&&(a.artifactMeta.code.content=r)}))},getBlockArtifactMetaMap:()=>t().blockArtifactMetaMap,setEndBlockArtifactMeta:t=>{e((0,s.produce)(e=>{let{blockArtifactMetaMap:i}=e;if(!i[t])return;i[t].isStreaming=!1;let{codeFileBlockList:r}=i[t],o=r.map(e=>{let t=(0,m.default)(e.artifactMeta);return g.ArtifactStatusUtils.endStreaming([t]),{...e,artifactMeta:t}});i[t]={...i[t],codeFileBlockList:o}}))},updateBlockArtifactAutoOpenCanvas:(t,i)=>{e((0,s.produce)(e=>{e.blockArtifactAutoOpenCanvasMap={...e.blockArtifactAutoOpenCanvasMap,[t]:i}}))},updateProcessBlockMeta:(t,i)=>{e((0,s.produce)(e=>{e.processBlockMetaMap[t]=i}))},clearBlockArtifactRecord:t=>{e((0,s.produce)(e=>{delete e.blockArtifactMetaMap[t]}))}});var C=i(38848),S=i(334780);let y=C.FlowLocalStorage.getItem(S.CODE_AGENT_MODE_KEY),M={editorValue:{data:[]},focused:!1,supportedCodeFileTypes:[],recommendCodeBasePrompts:[],recommendItems:[],recommendOtherPrompts:[],recommendArtifactsItems:[],recommendArtifactsCategoryItems:[],recommendCodePromptsTemplates:[],githubModalVisible:!1,loading:!1,refKey:"",refInfoMap:{},abResults:{},blockArtifactMap:{},retainedEditorValue:void 0,agentMode:y&&[p.CodeAgentMode.ChatMode,p.CodeAgentMode.DevMode].includes(y)?y:p.CodeAgentMode.DevMode,blockIdMapForClarify:{}},b=e=>({...M,updateEditorValue:t=>{e((0,s.produce)(e=>{e.editorValue=t}))},updateCurrentPromptTemplate:(t,i)=>{e((0,s.produce)(e=>{e.currentPromptTemplate=t,e.currentPromptTemplateSource=i}))},updateFocusedState:t=>{e((0,s.produce)(e=>{e.focused=t}))},fetchRecommendList:async()=>{try{e((0,s.produce)(e=>{e.loading=!0,e.recommendArtifactsItems=[],e.recommendArtifactsCategoryItems=[],e.recommendCodeBasePrompts=[],e.recommendOtherPrompts=[]}));let{data:t}=await d.samanthaApiService.SkillPack({skill_type:c.SkillType.CodeAssistant,condition:{code_assistant_condition:{}}});e((0,s.produce)(e=>{var i,r,o,a,n,l;if(t&&(e.loading=!1),(null==t?void 0:null===(i=t.code_assistant)||void 0===i?void 0:i.codebase_items)&&(e.recommendCodeBasePrompts=null==t?void 0:null===(n=t.code_assistant)||void 0===n?void 0:n.codebase_items),(null==t?void 0:null===(r=t.code_assistant)||void 0===r?void 0:r.query_items)&&(e.recommendOtherPrompts=null==t?void 0:null===(l=t.code_assistant)||void 0===l?void 0:l.query_items),null==t?void 0:null===(o=t.code_assistant)||void 0===o?void 0:o.data)try{let i=JSON.parse(t.code_assistant.data);e.recommendCodeBasePrompts=i.codebase_templates.codebase_items,e.recommendItems=i.recommendations.recommendation_items,e.recommendArtifactsCategoryItems=i.artifacts_category_templates.artifacts_category_items,e.recommendOtherPrompts=[]}catch(e){}if(null==t?void 0:null===(a=t.code_assistant)||void 0===a?void 0:a.template)try{let i=JSON.parse(t.code_assistant.template);e.recommendCodePromptsTemplates=i.prompt_list}catch(e){}}))}catch(e){u.logger.persist.warning({eventName:"init_code_recommend_error",error:e})}},toggleGithubModalVisible:function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;e((0,s.produce)(e=>{e.githubModalVisible=t,i&&(e.githubModalEnterMethod=i)}))},updateRefRangeInfo:(t,i)=>{e((0,s.produce)(e=>{e.refKey=t,e.refInfoMap={[t]:{...e.refInfoMap[t],...i}}}))},clearRefRangeInfo:()=>{e((0,s.produce)(e=>{e.refInfoMap={[e.refKey]:{...e.refInfoMap[e.refKey],rangeStart:void 0,rangeEnd:void 0}}}))},updateAbResults:t=>{e((0,s.produce)(e=>{e.abResults={...e.abResults,...t}}))},updateBlockArtifact:t=>{let{type:i,blockId:r,value:o}=t;e((0,s.produce)(e=>{let{blockArtifactMap:t}=e;t||(t={}),i===p.UpdateBlockArtifactType.Status?t[r]={...t[r],status:o}:t[r]={...t[r],data:o}}))},setRetainedData:t=>{e((0,s.produce)(e=>{(null==t?void 0:t.retainedEditorValue)&&(e.retainedEditorValue=null==t?void 0:t.retainedEditorValue)}))},updateAgentMode:t=>{e((0,s.produce)(e=>{e.agentMode=t})),n.default.setMode(t)},addBlockIdMapForClarify:(t,i)=>{e((0,s.produce)(e=>{e.blockIdMapForClarify[t]=i}))}}),A=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return(0,l.default)(b(...t),f(...t),h(...t))},k=e=>{try{return{previewedCount:e.previewedCount,retainedEditorValue:e.retainedEditorValue}}catch(e){return u.logger.persist.error({message:"[@Coding-skill-store] persist state limit error",error:e instanceof Error?e:Error(String(e))}),{}}},I=e=>{let{prefix:t,isEnableDebug:i,reduxDevToolsSnapshot:n,merge:l,partialize:s,storage:d}=e,c=(0,a.createPersistOptions)({name:"coding-skill-store",prefix:t||"default",version:1.5,storage:d,partialize:null!=s?s:k,merge:l}),u=(0,r.persist)((0,r.subscribeWithSelector)(A),c);return i&&n?(0,o.create)()((0,r.devtools)(u,{name:`${t}-chat-input-store`})):(0,o.create)()(u)},w=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];let{_useCodingSkillStore:r}=w.prototype;if(r)return r(...t);throw Error("useCodingSkillStore is not initialized")};function P(e){let{_useCodingSkillStore:t}=w.prototype||{};if(!t){let t=I({...e});Object.setPrototypeOf(w.prototype,t),Object.defineProperties(w,{...Object.getOwnPropertyDescriptors(t)}),w.prototype._useCodingSkillStore=t}n.default.initialize()}},253359:function(e,t,i){var r,o,a;i.d(t,{CodeAgentMode:function(){return s},HomePageItemType:function(){return n},UpdateBlockArtifactType:function(){return l}});let n=((r={})[r.None=0]="None",r[r.CodeGenerate=1]="CodeGenerate",r[r.CodeDebug=2]="CodeDebug",r[r.CodeKnowledge=3]="CodeKnowledge",r[r.CodeBase=4]="CodeBase",r[r.CodeArtifacts=5]="CodeArtifacts",r[r.DocLink=7]="DocLink",r),l=((o={}).Status="status",o.Artifact="artifact",o.ArtifactMeta="artifact_meta",o.ArtifactCodeFile="artifact_code_file",o),s=((a={}).DevMode="dev_mode",a.ChatMode="chat_mode",a.InstructionOpt="instruction_opt",a)},416330:function(e,t,i){var r,o;i.d(t,{CodeArtifactStatus:function(){return n},EUploadType:function(){return a}});let a=((r={}).FILE="FILE",r.DIR="DIR",r.REPO="REPO",r.DATA_ANALYSIS="DATA_ANALYSIS",r.IMAGE="IMAGE",r),n=((o={})[o.Start=1]="Start",o[o.Finish=2]="Finish",o[o.Updated=3]="Updated",o[o.Rollbacked=4]="Rollbacked",o)},487300:function(e,t,i){var r=i(371312),o=i(38848),a=i(253359),n=i(334780);function l(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class s{get(e){return a.CodeAgentMode.ChatMode}set(e,t){}initialize(e){arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.CodeAgentMode.ChatMode}}class d{get(e){return o.FlowSessionStorage.getItem(e)||o.FlowLocalStorage.getItem(e)}set(e,t){o.FlowLocalStorage.setItem(e,t),o.FlowSessionStorage.setItem(e,t)}initialize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.CodeAgentMode.DevMode,i=o.FlowSessionStorage.getItem(e),r=o.FlowLocalStorage.getItem(e);if(!i){let i=r||t;o.FlowSessionStorage.setItem(e,i),r||o.FlowLocalStorage.setItem(e,i)}}}let c=()=>(0,r.isCodeIndependentSite)()?new d:new s,u=new class{getDefaultMode(){return(0,r.isCodeIndependentSite)()?a.CodeAgentMode.DevMode:a.CodeAgentMode.ChatMode}isValidMode(e){return[a.CodeAgentMode.ChatMode,a.CodeAgentMode.DevMode].includes(e)}setMode(e){this.isValidMode(e)&&this.strategy.set(this.key,e)}getCurrentMode(){let e=this.strategy.get(this.key);return this.isValidMode(e)?e:null}initialize(){let e=this.getDefaultMode();this.strategy.initialize(this.key,e)}constructor(){l(this,"strategy",void 0),l(this,"key",n.CODE_AGENT_MODE_KEY),this.strategy=c()}};t.default=u},375881:function(e,t,i){i.d(t,{ArtifactStatusUtils:function(){return p},formatArtifactItem:function(){return c},getCodeArtifactListDataByMessage:function(){return u},isArtifactsHitRejectReviewStatus:function(){return f}});var r=i(674157),o=i(629006),a=i(725705),n=i(781313),l=i(112774),s=i(178230),d=i(416330);let c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{isFinished:i,isSourceShare:r,isLocal:o}=t,{offset:a,title:n="",intention:l,identifier:s,artifact_id:c,artifact_key:u,artifact_type:p,version:f,create_time:m,resource_id:_,resource_type:g,resource_version:v,status:h,code:C,is_entry:S}=null!=e?e:{};return{title:n,code:C,language:null==C?void 0:C.language,version:f,status:h,isStreaming:h===d.CodeArtifactStatus.Start&&!i,isSourceShare:r,isLocal:o,offset:a,intention:l,identifier:s,isEntry:S,artifactId:c,artifactKey:u,createTime:m,resourceId:_,resourceType:g,resourceVersion:v,artifactType:p}},u=e=>{var t,i,l,d,u,p,f;let m=[];(null==e?void 0:null===(t=e.content_obj)||void 0===t?void 0:t.artifact_meta)&&(m=Array.isArray(null==e?void 0:null===(d=e.content_obj)||void 0===d?void 0:d.artifact_meta)?null==e?void 0:null===(u=e.content_obj)||void 0===u?void 0:u.artifact_meta:[null==e?void 0:null===(p=e.content_obj)||void 0===p?void 0:p.artifact_meta]),(null==e?void 0:null===(i=e.ext)||void 0===i?void 0:i.samantha_artifact_meta_list)&&(m=JSON.parse(null==e?void 0:null===(f=e.ext)||void 0===f?void 0:f.samantha_artifact_meta_list));let _=(0,r.isMessageFinished)(e),g=(0,o.isSharedMessage)(e),v=(0,a.isLocalMessage)(e)||!!((null==e?void 0:e.conversation_id)&&(0,n.isLocalConversation)(e.conversation_id));return Array.isArray(m)?null==m?void 0:null===(l=m.map)||void 0===l?void 0:l.call(m,e=>c(e,{isFinished:_,isSourceShare:g,isLocal:v})):(s.logger.persist.error({eventName:"artifactMetaList is not array",error:Error(JSON.stringify(e))}),[])},p={startStreaming(e){let t=e.find(e=>{var t;return(null===(t=e.code)||void 0===t?void 0:t.node_id)==="root"});t&&(t.isStreaming=!0)},beforeCreateArtifactMeta(e){e.forEach(e=>{var t;(null===(t=e.code)||void 0===t?void 0:t.node_id)!=="root"&&(e.isStreaming=!1)})},endStreaming(e){e.forEach(e=>{e.isStreaming=!1,e.isFetched=!0})}};function f(e){return e.some(e=>(null==e?void 0:e.review_status)===l.CodeNodeContentReviewStatus.Reject)}}}]);